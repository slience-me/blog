---
layout: post
title: 数学建模｜数学建模常见的一些方法【01层次分析法】
categories: [数学建模]
description: 数学建模常见的一些方法【01层次分析法】
keywords: 编程语言, 数学建模
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---

# 数学建模常见的一些方法
## 1. 层次分析法(The analytic hierarchy process, 简称AHP)
- 建模比赛中最基础的模型之一，其主要用于解决评价类问题（例如：选择哪种方案最好、哪位运动员或者员工表现的更优秀）
- 通过相关的权重，算出分数，获取最优解
![Alt Text](/images/posts/7c8448d5abfd40f9b364434a4292ec30.png)
### 1.1 直接问权重的弊端

> 在确定影响某因素的诸因子在该因素中所占的比重时，遇到的主要困难是这些比重常常不易定量化。此外，当影响某因素的因子较多时，直接考虑各因子对该因素有多大程度的影响时，常常会因考虑不周全、顾此失彼而使决策者提出与他实际认为的重要性程度不相一致的数据，甚至有可能提出一组隐含矛盾的数据。<p align="right">——选自司守奎[kuí]老师的《数学建模算法与应用》</p>

**层次分析法**
1. 分析系统中各因素之间的关系，建立系统的递阶层次结构.
2. 对于同一层次的各元素关于上一层次中某一准则的重要性进行两两比较，构造两两比较矩阵（判断矩阵）
3. 由判断矩阵计算被比较元素对于该准则的相对权重，并进行一致性检验（检验通过权重才能用）.
4. 根据权重矩阵计算得分，并进行排序。
![Alt Text](/images/posts/ac9a347105604aa789a6238c37cf3056.png)
---
### 1.2 一致性检验的步骤
求出最大特征根λ
![Alt Text](/images/posts/5a68ec3a193e46b19e5b86992830fd0e.png)
计算矩阵A的特征值D和特征向量V的函数是`eig(A)`
```python
clc  
n = size(A,1)
[V,D] = eig(A)    %V是特征向量, D是由特征值构成的对角矩阵（除了对角线元素外，其余位置元素全为0）
Max_eig = max(max(D)) %也可以写成max(D(:))

CI = (Max_eig - n) / (n-1);
RI=[0 0 0.52 0.89 1.12 1.26 1.36 1.41 1.46 1.49 1.52 1.54 1.56 1.58 1.59];  %注意，这里的RI最多支持 n = 15
CR=CI/RI(n);
disp('一致性指标CI=');disp(CI);
disp('一致性比例CR=');disp(CR);
if CR<0.10
    disp('因为CR < 0.10，所以该判断矩阵A的一致性可以接受!');
else
    disp('注意：CR >= 0.10，因此该判断矩阵A需要进行修改!');
end
```

```python
V =
   0.4058 + 0.0000i   0.0914 - 0.2754i   0.0914 + 0.2754i   0.7071 + 0.0000i  -0.2298 + 0.0000i
   0.4058 + 0.0000i   0.0914 - 0.2754i   0.0914 + 0.2754i  -0.7071 + 0.0000i  -0.2298 + 0.0000i
   0.1299 + 0.0000i   0.0268 + 0.1349i   0.0268 - 0.1349i   0.0000 + 0.0000i  -0.3457 + 0.0000i
   0.7872 + 0.0000i  -0.8930 + 0.0000i  -0.8930 + 0.0000i  -0.0000 + 0.0000i   0.6897 + 0.0000i
   0.1847 + 0.0000i   0.1131 + 0.0490i   0.1131 - 0.0490i  -0.0000 + 0.0000i   0.5470 + 0.0000i

D =
   5.2924 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i  -0.0843 + 1.2326i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0843 - 1.2326i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.1238 + 0.0000i
```
**如果CR > 0.1 如何修正？**
- 往一致矩阵上调整一致矩阵各行成倍数关系

### 1.3 三种方法计算权重
#### 算术平均法 
```python
% 第一步：将判断矩阵按照列归一化（每一个元素除以其所在列的和）
Sum_A = sum(A)
[n,n] = size(A)  % 也可以写成n = size(A,1)

% 因为我们的判断矩阵A是一个方阵，所以这里的r和c相同，我们可以就用同一个字母n表示
SUM_A = repmat(Sum_A,n,1)   %repeat matrix的缩写

% 另外一种替代的方法如下：
    SUM_A = [];
    for i = 1:n   %循环哦，这一行后面不能加冒号（和Python不同），这里表示循环n次
        SUM_A = [SUM_A; Sum_A]
    end
    
clc;A
SUM_A
Stand_A = A ./ SUM_A
% 这里我们直接将两个矩阵对应的元素相除即可

% 第二步：将归一化的各列相加(按行求和)
sum(Stand_A,2)

% 第三步：将相加后得到的向量中每个元素除以n即可得到权重向量
disp('算术平均法求权重的结果为：');
disp(sum(Stand_A,2) / n)
% 首先对标准化后的矩阵按照行求和，得到一个列向量
% 然后再将这个列向量的每个元素同时除以n即可（注意这里也可以用./哦）
```

#### 几何平均法

```python
% 第一步：将A的元素按照行相乘得到一个新的列向量
clc;A
Prduct_A = prod(A,2)

% prod函数和sum函数类似，一个用于乘，一个用于加  dim = 2 维度是行

% 第二步：将新的向量的每个分量开n次方
Prduct_n_A = Prduct_A .^ (1/n)
% 这里对每个元素进行乘方操作，因此要加.号哦。  ^符号表示乘方哦  这里是开n次方，所以我们等价求1/n次方

% 第三步：对该列向量进行归一化即可得到权重向量
% 将这个列向量中的每一个元素除以这一个向量的和即可
disp('几何平均法求权重的结果为：');
disp(Prduct_n_A ./ sum(Prduct_n_A))
```

#### 特征值法

```python
% 第一步：求出矩阵A的最大特征值以及其对应的特征向量
clc
[V,D] = eig(A)    %V是特征向量, D是由特征值构成的对角矩阵（除了对角线元素外，其余位置元素全为0）
Max_eig = max(max(D)) %也可以写成max(D(:))
% 那么怎么找到最大特征值所在的位置了？ 需要用到find函数，它可以用来返回向量或者矩阵中不为0的元素的位置索引。
% 那么问题来了，我们要得到最大特征值的位置，就需要将包含所有特征值的这个对角矩阵D中，不等于最大特征值的位置全变为0
% 这时候可以用到矩阵与常数的大小判断运算

D == Max_eig
[r,c] = find(D == Max_eig , 1)
% 找到D中第一个与最大特征值相等的元素的位置，记录它的行和列。

% 第二步：对求出的特征向量进行归一化即可得到我们的权重
V(:,c)
disp('特征值法求权重的结果为：');
disp( V(:,c) ./ sum(V(:,c)) )
% 我们先根据上面找到的最大特征值的列数c找到对应的特征向量，然后再进行标准化。
```

注：一致矩阵不需要进行一致性检验，只有非一致矩阵的判断矩阵才需要进行一致性检验；在论文写作中，应该先进行一致性检验，通过检验后再计算权重

---
### 1.4 层次分析法的一些局限性
- 评价的决策层不能太多，太多的话n会很大，判断矩阵和一致矩阵差异可能会很大。
![Alt Text](/images/posts/f2af9593f2244624b4e1a2b8520c80e9.png)

[参考链接](https://www.youtube.com/watch?v=G3ESRIDUC5w&list=PLvce_oy4ggsHzrmgBz8vwQqRmezDOzo1N)
