<!DOCTYPE html> <html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> <title>æœºå™¨å­¦ä¹ ï½œPyTorchä¹‹å¼ é‡çš„ç›¸å…³æ“ä½œå¤§å…¨ &mdash; Slience_meçš„åšå®¢</title> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/primer-css/css/primer.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/collection.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/repo-card.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/sections/repo-list.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/boxed-group.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/globals/common.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/globals/responsive.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/posts/index.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/octicons/octicons/octicons.css"> <link rel="stylesheet" href=" https://cdn.jsdelivr.net/npm/@docsearch/css@3 "/> <link rel="stylesheet" href="https://mazhuang.org/rouge-themes/dist/github.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/share.js/dist/css/share.min.css"> <link rel="canonical" href="https://blog.slienceme.cn/2023/09/14/PyTorch%E4%B9%8B%E5%BC%A0%E9%87%8F%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E5%A4%A7%E5%85%A8/"> <link rel="alternate" type="application/atom+xml" title="Slience_meçš„åšå®¢" href="https://blog.slienceme.cn/feed.xml"> <link rel="shortcut icon" href="https://blog.slienceme.cn/favicon.ico"> <meta property="og:title" content="æœºå™¨å­¦ä¹ ï½œPyTorchä¹‹å¼ é‡çš„ç›¸å…³æ“ä½œå¤§å…¨"> <meta name="keywords" content="æœºå™¨å­¦ä¹ "> <meta name="og:keywords" content="æœºå™¨å­¦ä¹ "> <meta name="description" content=""> <meta name="og:description" content=""> <meta property="og:url" content="https://blog.slienceme.cn/2023/09/14/PyTorch%E4%B9%8B%E5%BC%A0%E9%87%8F%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E5%A4%A7%E5%85%A8/"> <meta property="og:site_name" content="Slience_meçš„åšå®¢"> <meta property="og:type" content="article"> <meta property="og:locale" content="zh_CN" /> <meta property="article:published_time" content="2023-09-14"> <meta name="google-site-verification" content="2feHjT1GNs1Yi2JQfOtdYx7d048naG_-cMwZaDAopIA" /> <script src="https://blog.slienceme.cn/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://blog.slienceme.cn/assets/js/main.js"></script> </head> <body class="" data-mz=""> <header class="site-header"> <div class="container"> <h1><a href="https://blog.slienceme.cn/" title="Slience_meçš„åšå®¢"><span class="octicon octicon-mark-github"></span> Slience_meçš„åšå®¢</a></h1> <button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <nav class="site-header-nav" role="navigation"> <a href="https://blog.slienceme.cn/" class="site-header-nav-item" target="" title="é¦–é¡µ">é¦–é¡µ</a> <a href="https://blog.slienceme.cn/categories/" class="site-header-nav-item" target="" title="åˆ†ç±»">åˆ†ç±»</a> <a href="https://blog.slienceme.cn/archives/" class="mobile-hidden site-header-nav-item" target="" title="å½’æ¡£">å½’æ¡£</a> <a href="https://blog.slienceme.cn/open-source/" class="mobile-hidden site-header-nav-item" target="" title="å¼€æº">å¼€æº</a> <a href="https://blog.slienceme.cn/fragments/" class="site-header-nav-item" target="" title="ç‰‡æ®µ">ç‰‡æ®µ</a> <a href="https://blog.slienceme.cn/wiki/" class="site-header-nav-item" target="" title="ç»´åŸº">ç»´åŸº</a> <a href="https://blog.slienceme.cn/links/" class="mobile-hidden site-header-nav-item" target="" title="é“¾æ¥">é“¾æ¥</a> <a href="https://blog.slienceme.cn/about/" class="site-header-nav-item" target="" title="å…³äº">å…³äº</a> <a class="mobile-hidden" href="https://blog.slienceme.cn/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a> </nav> </div> </header> <section class="collection-head small geopattern" data-pattern-id="æœºå™¨å­¦ä¹ ï½œPyTorchä¹‹å¼ é‡"> <div class="container"> <div class="columns"> <div class="column three-fourths"> <div class="collection-title"> <h1 class="collection-header">æœºå™¨å­¦ä¹ ï½œPyTorchä¹‹å¼ é‡çš„ç›¸å…³æ“ä½œå¤§å…¨</h1> <div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2023/09/14 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://blog.slienceme.cn/categories/#æœºå™¨å­¦ä¹ " title="æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> å…± 11212 å­—ï¼Œçº¦ 33 åˆ†é’Ÿ </span> </div> </div> </div> <div class="column one-fourth mobile-hidden"> <div class="collection-title"> </div> </div> </div> </div> </section> <section class="container content"> <div class="columns"> <div class="column three-fourths" > <article class="article-content markdown-body"> <p><img src="https://blog.slienceme.cn/images/posts/logo_slienceme3.png" alt="img" /></p> <p>æœ¬æ–‡ä½œè€…ï¼š <a href="https://slienceme.cn/">slience_me</a></p> <hr /> <h1 id="torch">Torch</h1> <h2 id="1-å¼ é‡çš„åˆ›å»º">1. å¼ é‡çš„åˆ›å»º</h2> <h3 id="11-ç›´æ¥åˆ›å»º">1.1 ç›´æ¥åˆ›å»º</h3> <h4 id="111-torchtensor">1.1.1 <code class="language-plaintext highlighter-rouge">torch.tensor</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä»dataåˆ›å»ºtensor</li> <li><strong>data</strong>: æ•°æ®ï¼Œå¯ä»¥æ˜¯listï¼Œnumpy</li> <li><strong>dtype</strong>: æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä¸dataçš„ä¸€è‡´</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œcuda/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> <li><strong>pin_memory</strong>: æ˜¯å¦å­˜äºé”é¡µå†…å­˜</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]])</span>
<span class="s">'''
tensor([[0.2, 0.2],
		[1.2, 2.3],
		[3.2, 1.3]])
'''</span>
</code></pre></div></div> <h4 id="112-torchfrom_numpyndarray">1.1.2 <code class="language-plaintext highlighter-rouge">torch.from_numpy(ndarray)</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">ndarray</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä»numpyåˆ›å»ºtensor</li> <li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šä»torch.from_numpyåˆ›å»ºçš„tensoräºåŸndarrayå…±äº«å†…å­˜ï¼Œå½“ä¿®æ”¹å…¶ä¸­ä¸€ä¸ªæ•°æ®ï¼Œå¦ä¸€ä¸ªä¹Ÿå°†ä¼šè¢«æ”¹åŠ¨ã€‚</li> </ul> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</code></pre></div> </div> <h3 id="12-ä¾æ®æ•°å€¼åˆ›å»º">1.2 ä¾æ®æ•°å€¼åˆ›å»º</h3> <h4 id="121-torchzeros">1.2.1 <code class="language-plaintext highlighter-rouge">torch.zeros</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div> </div> </blockquote> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾sizeåˆ›å»ºå…¨0å¼ é‡</li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> <li><strong>out</strong>: è¾“å‡ºçš„å¼ é‡</li> <li><strong>layout</strong>: å†…å­˜ä¸­å¸ƒå±€å½¢å¼ï¼Œæœ‰strided, sparse_cooç­‰</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 2è¡Œ3åˆ—
</span><span class="s">'''
tensor([[0, 0, 0],
		[0, 0, 0]])
'''</span>
</code></pre></div></div> <h4 id="122-torchzeros_like">1.2.2 <code class="language-plaintext highlighter-rouge">torch.zeros_like</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾inputå½¢çŠ¶åˆ›å»ºå…¨0å¼ é‡</li> <li><strong>input</strong>: åˆ›å»ºä¸inputåŒå½¢çŠ¶çš„å…¨0å¼ é‡</li> <li><strong>dtype</strong>: æ•°æ®ç±»å‹</li> <li><strong>layout</strong>: å†…å­˜ä¸­å¸ƒå±€å½¢å¼</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="s">'''
tensor([[0, 0],
		[0, 0],
		[0, 0]])
'''</span>
</code></pre></div></div> <h4 id="123-torchones">1.2.3 <code class="language-plaintext highlighter-rouge">torch.ones</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾sizeåˆ›å»ºå…¨1å¼ é‡</li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> <li><strong>out</strong>: è¾“å‡ºçš„å¼ é‡</li> <li><strong>layout</strong>: å†…å­˜ä¸­å¸ƒå±€å½¢å¼ï¼Œæœ‰strided, sparse_cooç­‰</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 2è¡Œ3åˆ—
</span><span class="s">'''
tensor([[1, 1, 1],
		[1, 1, 1]])
'''</span>
</code></pre></div></div> <h4 id="124-torchones_like">1.2.4 <code class="language-plaintext highlighter-rouge">torch.ones_like</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾inputå½¢çŠ¶åˆ›å»ºå…¨1å¼ é‡</li> <li><strong>input</strong>: åˆ›å»ºä¸inputåŒå½¢çŠ¶çš„å…¨0å¼ é‡</li> <li><strong>dtype</strong>: æ•°æ®ç±»å‹</li> <li><strong>layout</strong>: å†…å­˜ä¸­å±€å½¢å¼</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="s">'''
tensor([[1, 1, 1],
		[1, 1, 1]])
'''</span>
</code></pre></div></div> <h4 id="125-torchfull">1.2.5 <code class="language-plaintext highlighter-rouge">torch.full</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">full</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾sizeåˆ›å»ºå€¼å…¨ä¸ºfill_valueçš„å¼ é‡</li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> <li><strong>fill_value</strong>: å¼ é‡çš„å€¼</li> <li><strong>out</strong>: è¾“å‡ºçš„å¼ é‡</li> <li><strong>dtype</strong>: æ•°æ®ç±»å‹</li> <li><strong>layout</strong>: å†…å­˜ä¸­å¸ƒå±€å½¢å¼ï¼Œæœ‰strided, sparse_cooç­‰</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">1.23</span><span class="p">)</span>

<span class="s">'''
tensor([[1.23, 1.23],
		[1.23, 1.23],
		[1.23, 1.23]])
'''</span>
</code></pre></div></div> <h4 id="126-torchfull_like">1.2.6 <code class="language-plaintext highlighter-rouge">torch.full_like</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">full_like</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾inputå½¢çŠ¶åˆ›å»ºæŒ‡å®šæ•°æ®çš„å¼ é‡</li> <li><strong>dtype</strong>: æ•°æ®ç±»å‹</li> <li><strong>layout</strong>: å†…å­˜ä¸­å¸ƒå±€å½¢å¼ï¼Œæœ‰strided, sparse_cooç­‰</li> <li><strong>device</strong>: æ‰€åœ¨è®¾å¤‡ï¼Œgpu/cpu</li> <li><strong>requires_grad</strong>: æ˜¯å¦éœ€è¦æ¢¯åº¦</li> </ul> </blockquote> <h4 id="127-torcharange">1.2.7 <code class="language-plaintext highlighter-rouge">torch.arange</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="p">.</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»º<code class="language-plaintext highlighter-rouge">ç­‰å·®</code>çš„1ç»´å¼ é‡</li> <li><strong>start</strong>: æ•°åˆ—èµ·å§‹å€¼</li> <li><strong>end</strong>: æ•°åˆ—â€œç»“æŸå€¼â€</li> <li><strong>step</strong>: æ•°åˆ—å…¬å·®ï¼Œé»˜è®¤ä¸º1</li> <li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šæ•°å€¼åŒºé—´ä¸º <code class="language-plaintext highlighter-rouge">[ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡,ğ‘’ğ‘›ğ‘‘)</code> !!!!!</li> </ul> </blockquote> <p>æ ·ä¾‹;</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="s">'''
tensor([0, 1, 2])
'''</span>
</code></pre></div></div> <h4 id="128-torchlinspace">1.2.8 <code class="language-plaintext highlighter-rouge">torch.linspace</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»º<code class="language-plaintext highlighter-rouge">å‡åˆ†</code>çš„1ç»´å¼ é‡</li> <li><strong>start</strong>: æ•°åˆ—èµ·å§‹å€¼</li> <li><strong>end</strong>: æ•°åˆ—â€œç»“æŸå€¼â€</li> <li><strong>step</strong>: æ•°åˆ—é•¿åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="s">'''
tensor([-5.,   0.,   5.])
'''</span>
</code></pre></div></div> <h4 id="129-torchlogspace">1.2.9 <code class="language-plaintext highlighter-rouge">torch.logspace</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»º<code class="language-plaintext highlighter-rouge">å¯¹æ•°å‡åˆ†</code>çš„1ç»´å¼ é‡</li> <li><strong>start</strong>: æ•°åˆ—èµ·å§‹å€¼</li> <li><strong>end</strong>: æ•°åˆ—â€œç»“æŸå€¼â€</li> <li><strong>step</strong>: æ•°åˆ—é•¿åº¦</li> <li><strong>base</strong>: å¯¹æ•°å‡½æ•°çš„åº•ï¼Œé»˜è®¤ä¸º10</li> <li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šé•¿åº¦ä¸º<code class="language-plaintext highlighter-rouge">steps</code>ï¼Œåº•ä¸º<code class="language-plaintext highlighter-rouge">base</code></li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="s">'''
tensor([ 1.2589,  2.5119,  5.0119, 10.0000])
'''</span>
</code></pre></div></div> <h4 id="1210-torcheye">1.2.10 <code class="language-plaintext highlighter-rouge">torch.eye</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåˆ›å»º<code class="language-plaintext highlighter-rouge">å•ä½å¯¹è§’çŸ©é˜µ</code>ï¼ˆ2ç»´å¼ é‡ï¼‰</li> <li><strong>n</strong>: çŸ©é˜µè¡Œæ•°</li> <li><strong>m</strong>: çŸ©é˜µåˆ—æ•°</li> <li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šé»˜è®¤ä¸º<code class="language-plaintext highlighter-rouge">æ–¹é˜µ</code></li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="s">'''
tensor([[1., 0., 0.],
        [0., 1., 0.],
        [0., 0., 1.]])
'''</span>
</code></pre></div></div> <h3 id="13-ä¾æ¦‚ç‡åˆ†å¸ƒåˆ›å»ºå¼ é‡">1.3 ä¾æ¦‚ç‡åˆ†å¸ƒåˆ›å»ºå¼ é‡</h3> <h4 id="131-torchnormal">1.3.1 <code class="language-plaintext highlighter-rouge">torch.normal</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆ<code class="language-plaintext highlighter-rouge">æ­£æ€åˆ†å¸ƒï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰</code></li> <li><strong>mean</strong>: å‡å€¼</li> <li><strong>std</strong>: æ ‡å‡†å·®</li> <li><strong>å››ç§æ¨¡å¼ï¼š</strong>ï¼š <ul> <li>meanä¸º<code class="language-plaintext highlighter-rouge">æ ‡é‡</code>ï¼Œstdä¸º<code class="language-plaintext highlighter-rouge">æ ‡é‡</code></li> <li>meanä¸º<code class="language-plaintext highlighter-rouge">æ ‡é‡</code>ï¼Œstdä¸º<code class="language-plaintext highlighter-rouge">å¼ é‡</code></li> <li>meanä¸º<code class="language-plaintext highlighter-rouge">å¼ é‡</code>ï¼Œstdä¸º<code class="language-plaintext highlighter-rouge">æ ‡é‡</code></li> <li>meanä¸º<code class="language-plaintext highlighter-rouge">å¼ é‡</code>ï¼Œstdä¸º<code class="language-plaintext highlighter-rouge">å¼ é‡</code></li> </ul> </li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 1. meanä¸ºæ ‡é‡ï¼Œstdä¸ºæ ‡é‡
</span><span class="n">mean1</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">std1</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">normal1</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean1</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'meanä¸ºæ ‡é‡ï¼Œstdä¸ºæ ‡é‡:  </span><span class="si">{</span><span class="n">normal1</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="c1"># 2. meanä¸ºæ ‡é‡ï¼Œstdä¸ºå¼ é‡
</span><span class="n">mean2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">std2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">normal2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean2</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'meanä¸ºæ ‡é‡ï¼Œstdä¸ºå¼ é‡:  </span><span class="si">{</span><span class="n">normal2</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="c1"># 3. meanä¸ºå¼ é‡ï¼Œstdä¸ºæ ‡é‡
</span><span class="n">mean3</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">std3</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">normal3</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean3</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'meanä¸ºå¼ é‡ï¼Œstdä¸ºæ ‡é‡:  </span><span class="si">{</span><span class="n">normal3</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="c1"># 4. meanä¸ºå¼ é‡ï¼Œstdä¸ºå¼ é‡
</span><span class="n">mean4</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">11.</span><span class="p">)</span>
<span class="n">std4</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">normal4</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean4</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'meanä¸ºå¼ é‡ï¼Œstdä¸ºå¼ é‡:  </span><span class="si">{</span><span class="n">normal4</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="s">'''
meanä¸ºæ ‡é‡ï¼Œstdä¸ºæ ‡é‡:  
	tensor([0.8404])
meanä¸ºæ ‡é‡ï¼Œstdä¸ºå¼ é‡:  
	tensor([ 1.9674,  0.3015,  1.4441,  1.1592, -0.3160,  0.8436,  1.1548,  1.1149, 0.8569,  0.8924])
meanä¸ºå¼ é‡ï¼Œstdä¸ºæ ‡é‡:  
	tensor([-1.1098,  0.0993,  0.7905,  1.5703, -0.2797, -0.5459, -0.7058, -1.1746, 0.1725,  1.2089])
meanä¸ºå¼ é‡ï¼Œstdä¸ºå¼ é‡:  
	tensor([-0.1302,  1.2099,  1.6807,  2.5063,  5.4447,  6.4120,  6.9074,  8.2245, 8.9090, 10.0049])
'''</span>
</code></pre></div></div> <h4 id="132-torchnormal">1.3.2 <code class="language-plaintext highlighter-rouge">torch.normal</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆä¸€å®šå¤§å°çš„ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">æ­£æ€åˆ†å¸ƒï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰</code></li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="s">'''
tensor([[3.6354, 3.2656, 3.2746]])
'''</span>
</code></pre></div></div> <h4 id="133-torchrandn">1.3.3 <code class="language-plaintext highlighter-rouge">torch.randn</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆ<code class="language-plaintext highlighter-rouge">æ ‡å‡†æ­£æ€åˆ†å¸ƒ</code></li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="s">'''
tensor([[0.2405, 1.3955],
        [1.3470, 2.4382],
        [0.2028, 2.4505]])
'''</span>
</code></pre></div></div> <h4 id="134-torchrand">1.3.4 <code class="language-plaintext highlighter-rouge">torch.rand</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåœ¨åŒºé—´ <code class="language-plaintext highlighter-rouge">[0,1)</code> ä¸Šï¼Œç”Ÿæˆ<code class="language-plaintext highlighter-rouge">å‡åŒ€åˆ†å¸ƒ</code></li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="s">'''
tensor([[3.6354, 3.2656, 3.2746]])
'''</span>
</code></pre></div></div> <h4 id="135-torchrandint">1.3.5 <code class="language-plaintext highlighter-rouge">torch.randint</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåŒºé—´ <code class="language-plaintext highlighter-rouge">[ğ‘™ğ‘œğ‘¤,â„ğ‘–ğ‘”â„)</code> ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">æ•´æ•°å‡åŒ€åˆ†å¸ƒ</code></li> <li><strong>size</strong>: å¼ é‡çš„å½¢çŠ¶ï¼Œå¦‚(3, 3)ã€(3, 224, 224)</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="s">'''
tensor([[8, 6],
        [1, 3]])
'''</span>
</code></pre></div></div> <h4 id="136-torchrandperm">1.3.6 <code class="language-plaintext highlighter-rouge">torch.randperm</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randperm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">strided</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šç”Ÿæˆä»<code class="language-plaintext highlighter-rouge">0åˆ°n-1çš„éšæœºæ’åˆ—</code></li> <li><strong>n</strong>: å¼ é‡çš„é•¿åº¦</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randperm</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="s">'''
tensor([2, 0, 4, 5, 1, 3])
'''</span>
</code></pre></div></div> <h4 id="137-torchbernoulli">1.3.7 <code class="language-plaintext highlighter-rouge">torch.bernoulli</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">generator</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä»¥<code class="language-plaintext highlighter-rouge">input</code>ä¸ºæ¦‚ç‡ï¼Œç”Ÿæˆ<code class="language-plaintext highlighter-rouge">ä¼¯åŠªåˆ©åˆ†å¸ƒï¼ˆ0-1åˆ†å¸ƒï¼Œä¸¤ç‚¹åˆ†å¸ƒï¼‰</code></li> <li><strong>input</strong>: æ¦‚ç‡å€¼</li> </ul> </blockquote> <p>æ ·ä¾‹ï¼š</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">uniform_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># ç”Ÿæˆ2Ã—2çš„æ¦‚ç‡çŸ©é˜µ
</span><span class="n">torch</span><span class="p">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="s">'''
tensor([[0., 1.],
        [1., 0.]])
'''</span>
</code></pre></div></div> <h2 id="2-å¼ é‡çš„æ“ä½œ">2. å¼ é‡çš„æ“ä½œ</h2> <h3 id="21-å¼ é‡æ‹¼æ¥ä¸åˆ‡åˆ†">2.1 å¼ é‡æ‹¼æ¥ä¸åˆ‡åˆ†</h3> <h4 id="211-torchcat">2.1.1 <code class="language-plaintext highlighter-rouge">torch.cat</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">(</span><span class="n">tensors</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šå°†å¼ é‡<code class="language-plaintext highlighter-rouge">æŒ‰ç»´åº¦dim</code>è¿›è¡Œæ‹¼æ¥</li> <li><strong>tensors</strong>: å¼ é‡åºåˆ—seq</li> <li><strong>dim</strong>: è¦æ‹¼æ¥çš„ç»´åº¦ <code class="language-plaintext highlighter-rouge">dim=0æŒ‰è¡Œæ‹¼æ¥ dim=1æŒ‰åˆ—æ‹¼æ¥ dim=næŒ‰ç»´åº¦æ‹¼æ¥</code></li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">a</span><span class="p">.</span><span class="n">shape</span>
<span class="s">'''
torch.Size([2, 3])
torch.Size([2, 9])
'''</span>
</code></pre></div></div> <h4 id="212-torchstack">2.1.2 <code class="language-plaintext highlighter-rouge">torch.stack</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">(</span><span class="n">tensors</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šå¯¹åºåˆ—æ•°æ®å†…éƒ¨çš„å¼ é‡è¿›è¡Œ<code class="language-plaintext highlighter-rouge">æ‰©ç»´æ‹¼æ¥</code>ï¼ŒæŒ‡å®šç»´åº¦ç”±ç¨‹åºå‘˜é€‰æ‹©ã€å¤§å°æ˜¯ç”Ÿæˆåæ•°æ®çš„ç»´åº¦åŒºé—´ã€‚</li> <li><strong>tensors</strong>: å¼ é‡åºåˆ—seq</li> <li><strong>dim</strong>: æŒ‡å®šæ‰©å¼ çš„ç»´åº¦ <code class="language-plaintext highlighter-rouge">dim=0æŒ‰è¡Œæ‰©å¼  dim=1æŒ‰åˆ—æ‰©å¼  dim=næŒ‰ç»´åº¦æ‰©å¼ </code> æ‹¼æ¥åçš„tensorå½¢çŠ¶ï¼Œä¼šæ ¹æ®ä¸åŒçš„dimå‘ç”Ÿå˜åŒ–ã€‚ <img src="https://blog.slienceme.cn/images/posts/839df557bbd5421ca8029a2617fa9287.png" alt="Alt Text" /> å‚è€ƒï¼š<a href="https://blog.csdn.net/sweet_tea_/article/details/128551245">pytorchæ‹¼æ¥å‡½æ•°ï¼štorch.stack()å’Œtorch.cat()è¯¦è§£</a></li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">T1</span><span class="p">:</span>
 <span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">T2</span><span class="p">:</span>
 <span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">]])</span>
<span class="o">----------------------------------------------</span>
<span class="n">R0</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">((</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="s">'''
 tensor([[[1,  2,  3],
          [4,  5,  6],
          [7,  8,  9]],
         [[10, 20, 30],
          [40, 50, 60],
          [70, 80, 90]]])
torch.Size([2, 3, 3])
----------------------------------------------
'''</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">((</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="s">'''
 tensor([[[1,  2,  3],[10, 20, 30]],
         [[4,  5,  6],[40, 50, 60]],
         [[7,  8,  9],[70, 80, 90]]])
 torch.Size([3, 2, 3])
'''</span>
<span class="o">----------------------------------------------</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">((</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="s">'''
 tensor([[[1, 10],[2, 20],[3, 30]],
         [[4, 40],[5, 50],[6, 60]],
         [[7, 70],[8, 80],[9, 90]]])
 torch.Size([3, 3, 2])
'''</span>

<span class="n">R3</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">((</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="s">'''
IndexError: Dimension out of range (expected to be in range of [-3, 2], but got 3)
'''</span>

</code></pre></div></div> <h4 id="213-torchchunk">2.1.3 <code class="language-plaintext highlighter-rouge">torch.chunk</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">chunk</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">chunks</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šå°†å¼ é‡æŒ‰ç»´åº¦<code class="language-plaintext highlighter-rouge">dim</code>è¿›è¡Œå¹³å‡åˆ‡åˆ†</li> <li><strong>è¿”å›å€¼</strong>: å¼ é‡åˆ—è¡¨</li> <li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šè‹¥ä¸èƒ½æ•´é™¤ï¼Œæœ€åä¸€ä»½å¼ é‡å°äºå…¶ä»–å¼ é‡</li> <li><strong>input</strong>: è¦åˆ‡åˆ†çš„<code class="language-plaintext highlighter-rouge">å¼ é‡</code></li> <li><strong>chunks</strong>: è¦åˆ‡åˆ†çš„<code class="language-plaintext highlighter-rouge">ä»½æ•°</code></li> <li><strong>dim</strong>: è¦åˆ‡åˆ†çš„<code class="language-plaintext highlighter-rouge">ç»´åº¦</code> 0æŒ‰ç…§åˆ—åˆ‡åˆ† 1æŒ‰ç…§è¡Œåˆ‡åˆ†</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="s">'''
tensor([[0, 1],
        [2, 3],
        [4, 5],
        [6, 7],
        [8, 9]])
(tensor([[0, 1],
         [2, 3],
         [4, 5]]),
 tensor([[6, 7],
         [8, 9]]))
'''</span>
<span class="o">---------------------------------------</span>
<span class="n">torch</span><span class="p">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="s">'''
(tensor([[0],
         [2],
         [4],
         [6],
         [8]]),
 tensor([[1],
         [3],
         [5],
         [7],
         [9]]))
'''</span>
</code></pre></div></div> <h4 id="214-torchsplit">2.1.4 <code class="language-plaintext highlighter-rouge">torch.split</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">split_size_or_sections</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šå°†å¼ é‡æŒ‰ç»´åº¦<code class="language-plaintext highlighter-rouge">dim</code>è¿›è¡Œåˆ‡åˆ†</li> <li><strong>è¿”å›å€¼</strong>: å¼ é‡åˆ—è¡¨</li> <li><strong>tensor</strong>: è¦åˆ‡åˆ†çš„<code class="language-plaintext highlighter-rouge">å¼ é‡</code></li> <li><strong>split_size_or_sections</strong>: ä¸º<code class="language-plaintext highlighter-rouge">int</code>æ—¶ï¼Œè¡¨ç¤ºæ¯ä¸€ä»½çš„é•¿åº¦ï¼›ä¸º<code class="language-plaintext highlighter-rouge">list</code>æ—¶ï¼ŒæŒ‰listå…ƒç´ åˆ‡åˆ†</li> <li><strong>dim</strong>: è¦åˆ‡åˆ†çš„<code class="language-plaintext highlighter-rouge">ç»´åº¦</code> 0æŒ‰ç…§åˆ—åˆ‡åˆ† 1æŒ‰ç…§è¡Œåˆ‡åˆ†</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="s">''' 
tensor([[0, 1],
        [2, 3],
        [4, 5],
        [6, 7],
        [8, 9]])
(tensor([[0, 1],
         [2, 3]]),
 tensor([[4, 5],
         [6, 7]]),
 tensor([[8, 9]]))
'''</span>
<span class="n">torch</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="s">'''
(tensor([[0, 1],
         [2, 3],
         [4, 5]]),
 tensor([[6, 7]]),
 tensor([[8, 9]]))
'''</span>
</code></pre></div></div> <h3 id="22-å¼ é‡ç´¢å¼•">2.2 å¼ é‡ç´¢å¼•</h3> <h4 id="221-torchindex_select">2.2.1 <code class="language-plaintext highlighter-rouge">torch.index_select</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">index_select</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šåœ¨ç»´åº¦<code class="language-plaintext highlighter-rouge">dim</code>ä¸Šï¼ŒæŒ‰indexç´¢å¼•æ•°æ®</li> <li><strong>è¿”å›å€¼</strong>: ä¾indexç´¢å¼•æ•°æ®æ‹¼æ¥çš„å¼ é‡</li> <li><strong>input</strong>: è¦ç´¢å¼•çš„å¼ é‡</li> <li><strong>dim</strong>: è¦ç´¢å¼•çš„<code class="language-plaintext highlighter-rouge">ç»´åº¦</code> 0æŒ‰ç…§åˆ—åˆ‡åˆ† 1æŒ‰ç…§è¡Œåˆ‡åˆ†</li> <li><strong>index</strong>: è¦ç´¢å¼•æ•°æ®çš„åºå·</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">torch</span><span class="p">.</span><span class="n">index_select</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
<span class="s">'''
x: tensor([[-0.1468,  0.7861,  0.9468, -1.1143],
           [ 1.6908, -0.8948, -0.3556,  1.2324],
           [ 0.1382, -1.6822,  0.3177,  0.1328]])
indices: tensor([0, 2])
tensor([[-0.1468,  0.7861,  0.9468, -1.1143],
        [ 0.1382, -1.6822,  0.3177,  0.1328]])
'''</span>
</code></pre></div></div> <h4 id="222-torchmasked_select">2.2.2 <code class="language-plaintext highlighter-rouge">torch.masked_select</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">masked_select</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šæŒ‰maskä¸­çš„Trueè¿›è¡Œç´¢å¼•</li> <li><strong>è¿”å›å€¼</strong>: ä¸€ç»´å¼ é‡</li> <li><strong>input</strong>: è¦ç´¢å¼•çš„å¼ é‡</li> <li><strong>mask</strong>: ä¸inputåŒå½¢çŠ¶çš„å¸ƒå°”ç±»å‹å¼ é‡</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'x:'</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">ge</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'mask:'</span><span class="p">,</span><span class="n">mask</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">masked_select</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
<span class="s">'''
x: tensor([[ 0.1373,  0.2405,  1.3955,  1.3470],
           [ 2.4382,  0.2028,  2.4505,  2.0256],
           [ 1.7792, -0.9179, -0.4578, -0.7245]])
mask: tensor([[False, False,  True,  True],
              [ True, False,  True,  True],
              [ True, False, False, False]])
tensor([1.3955, 1.3470, 2.4382, 2.4505, 2.0256, 1.7792])
'''</span>
</code></pre></div></div> <h3 id="23-å¼ é‡å˜æ¢">2.3 å¼ é‡å˜æ¢</h3> <h4 id="231-torchreshape">2.3.1 <code class="language-plaintext highlighter-rouge">torch.reshape</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼š<code class="language-plaintext highlighter-rouge">å˜æ¢å¼ é‡å½¢çŠ¶</code></li> <li><strong>æ³¨æ„äº‹é¡¹</strong>: å½“å¼ é‡åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­æ—¶ï¼Œæ–°å¼ é‡ä¸inputå…±äº«æ•°æ®å†…å­˜</li> <li><strong>input</strong>: è¦å˜æ¢çš„å¼ é‡</li> <li><strong>shape</strong>: æ–°å¼ é‡çš„å½¢çŠ¶</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="s">'''
tensor([0., 1., 2., 3.])
tensor([[0., 1.],
        [2., 3.]])
'''</span>
</code></pre></div></div> <h4 id="232-torchtranspose">2.3.2 <code class="language-plaintext highlighter-rouge">torch.transpose</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dim0</span><span class="p">,</span> <span class="n">dim1</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼š<code class="language-plaintext highlighter-rouge">äº¤æ¢å¼ é‡</code>çš„ä¸¤ä¸ª<code class="language-plaintext highlighter-rouge">ç»´åº¦</code></li> <li><strong>input</strong>: è¦äº¤æ¢çš„å¼ é‡</li> <li><strong>dim0</strong>: è¦äº¤æ¢çš„ç»´åº¦</li> <li><strong>dim1</strong>: è¦äº¤æ¢çš„ç»´åº¦</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="s">'''
x:
tensor([[ 1.2799, -0.9941,  1.8150],
        [-0.6028,  1.6148,  1.9302]])
torch.Size([2, 3])
tensor([[ 1.2799, -0.6028],
        [-0.9941,  1.6148],
        [ 1.8150,  1.9302]])
torch.Size([3, 2])
'''</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="s">'''
tensor([[[ 0.8885, -1.4867, -0.8898,  0.9005],
         [ 0.2615, -0.1494,  1.1523, -1.1309],
         [ 1.4025, -0.4167,  0.1655, -0.7157]],

        [[ 1.2425, -1.3332,  0.2961, -0.0937],
         [-0.7556, -0.1198,  0.9545,  0.1492],
         [ 1.6222,  0.1947, -1.5953,  0.5859]]])
torch.Size([2, 3, 4])
tensor([[[ 0.8885,  1.2425],
         [ 0.2615, -0.7556],
         [ 1.4025,  1.6222]],

        [[-1.4867, -1.3332],
         [-0.1494, -0.1198],
         [-0.4167,  0.1947]],

        [[-0.8898,  0.2961],
         [ 1.1523,  0.9545],
         [ 0.1655, -1.5953]],

        [[ 0.9005, -0.0937],
         [-1.1309,  0.1492],
         [-0.7157,  0.5859]]])
torch.Size([4, 3, 2])
'''</span>
</code></pre></div></div> <h4 id="233-torcht">2.3.3 <code class="language-plaintext highlighter-rouge">torch.t</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼š2ç»´å¼ é‡è½¬ç½®ï¼Œå¯¹çŸ©é˜µè€Œè¨€ï¼Œç­‰ä»·äºtorch.transpose(input, 0, 1)</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">torch</span><span class="p">.</span><span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="s">'''
tensor([[ 0.5740, -0.0798],
        [ 0.9674, -0.7761]])
tensor([[ 0.5740,  0.9674],
        [-0.0798, -0.7761]])
'''</span>
</code></pre></div></div> <h4 id="234-torchsqueeze">2.3.4 <code class="language-plaintext highlighter-rouge">torch.squeeze</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">squeeze</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šå‹ç¼©é•¿åº¦ä¸º1çš„ç»´åº¦ï¼ˆè½´ï¼‰ <code class="language-plaintext highlighter-rouge">ç»´åº¦å‹ç¼©</code></li> <li><strong>dim</strong>: è‹¥ä¸ºNoneï¼Œç§»é™¤æ‰€æœ‰é•¿åº¦ä¸º1çš„è½´ï¼›è‹¥æŒ‡å®šç»´åº¦ï¼Œå½“ä¸”ä»…å½“è¯¥è½´é•¿åº¦ä¸º1æ—¶ï¼Œå¯ä»¥è¢«ç§»é™¤</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="s">'''
tensor([[[[[0., 0.]],

          [[0., 0.]]]],



        [[[[0., 0.]],

          [[0., 0.]]]]])
torch.Size([2, 1, 2, 1, 2])
tensor([[[0., 0.],
         [0., 0.]],

        [[0., 0.],
         [0., 0.]]])
torch.Size([2, 2, 2])
'''</span>
</code></pre></div></div> <h4 id="235-torchunsqueeze">2.3.5 <code class="language-plaintext highlighter-rouge">torch.unsqueeze</code></h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <ul> <li><strong>åŠŸèƒ½</strong>ï¼šä¾æ®dim<code class="language-plaintext highlighter-rouge">æ‰©å±•ç»´åº¦</code></li> <li><strong>dim</strong>: æ‰©å±•çš„ç»´åº¦ 0è¡Œæ‰©å±• 1åˆ—æ‰©å±• -1æœ€åä¸€ä¸ªç»´åº¦æ‰©å±•</li> </ul> </blockquote> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t0</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span>
<span class="s">'''
x:
	torch.Size([3])
t0:
	tensor([[1, 2, 3]])
	torch.Size([1, 3])
t1: 
	tensor([[1],
	        [2],
	        [3]])
	torch.Size([3, 1])
t2:
	tensor([[1],
	        [2],
	        [3]]))
	torch.Size([3, 1])
'''</span>
</code></pre></div></div> <h2 id="çº¿æ€§å›å½’æ¨¡å‹">çº¿æ€§å›å½’æ¨¡å‹</h2> <ul> <li>çº¿æ€§å›å½’æ˜¯åˆ†æä¸€ä¸ªå˜é‡ä¸å¦å¤–ä¸€ï¼ˆå¤šï¼‰ä¸ªå˜é‡ä¹‹é—´å…³ç³»çš„æ–¹æ³•ã€‚ <ul> <li>å› å˜é‡æ˜¯$y$ï¼Œè‡ªå˜é‡æ˜¯$x$ï¼Œå…³ç³»çº¿æ€§ï¼š$y=w\times x + b$ï¼Œä»»åŠ¡æ˜¯æ±‚è§£ $w$ï¼Œ$b$ã€‚</li> </ul> </li> <li>æˆ‘ä»¬çš„æ±‚è§£æ­¥éª¤æ˜¯ï¼š</li> <li>ç¡®å®šæ¨¡å‹ï¼š$Model \to y = w \times x + b$</li> <li>é€‰æ‹©æŸå¤±å‡½æ•°ï¼šè¿™é‡Œç”¨$MSE:\frac{1}{m}\sum_{i=1}^m(y_i-\hat y_i)^2$</li> <li>æ±‚è§£æ¢¯åº¦å¹¶æ›´æ–°$w$ï¼Œ$b$ï¼š \(\begin{array}{lcl} w &amp;=&amp; w - lr \times w.grad \\ b &amp;=&amp; b - lr \times w.grad \end{array}\)</li> <li>ä¸‹é¢æˆ‘ä»¬å¼€å§‹å†™ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼š</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># é¦–å…ˆæˆ‘ä»¬å¾—æœ‰è®­ç»ƒæ ·æœ¬Xï¼ŒYï¼Œ è¿™é‡Œæˆ‘ä»¬éšæœºç”Ÿæˆ
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># æ„å»ºçº¿æ€§å›å½’å‡½æ•°çš„å‚æ•°
</span><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># è¿™ä¿©éƒ½éœ€è¦æ±‚æ¢¯åº¦
</span>
<span class="c1"># è®¾ç½®å­¦ä¹ ç‡lrä¸º0.1
</span><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># å‰å‘ä¼ æ’­
</span>    <span class="n">wx</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">wx</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
 
    <span class="c1"># è®¡ç®—loss  å‡æ–¹è¯¯å·®
</span>    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y_pred</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
 
    <span class="c1"># åå‘ä¼ æ’­
</span>    <span class="n">loss</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
 
    <span class="c1"># æ›´æ–°å‚æ•°
</span>    <span class="n">b</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">sub_</span><span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>    <span class="c1"># è¿™ç§_çš„åŠ æ³•æ“ä½œæ—¶ä»è‡ªèº«å‡ï¼Œç›¸å½“äº-=
</span>    <span class="n">w</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">sub_</span><span class="p">(</span><span class="n">lr</span> <span class="o">*</span> <span class="n">w</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>

    <span class="c1"># æ¢¯åº¦æ¸…é›¶
</span>    <span class="n">w</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">zero_</span><span class="p">()</span>
    <span class="n">b</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">zero_</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div> <blockquote> <p>éƒ¨åˆ†å­¦ä¹ å†…å®¹æ¥è‡ªï¼š å¤©æ± å®éªŒå®¤</p> </blockquote> <div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"> <h3>æ–‡æ¡£ä¿¡æ¯</h3> <ul> <li>æœ¬æ–‡ä½œè€…ï¼š<a href="https://blog.slienceme.cn" target="_blank">slience_me</a></li> <li>æœ¬æ–‡é“¾æ¥ï¼š<a href="https://blog.slienceme.cn/2023/09/14/PyTorch%E4%B9%8B%E5%BC%A0%E9%87%8F%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E5%A4%A7%E5%85%A8/" target="_blank">https://blog.slienceme.cn/2023/09/14/PyTorch%E4%B9%8B%E5%BC%A0%E9%87%8F%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E5%A4%A7%E5%85%A8/</a></li> <li>ç‰ˆæƒå£°æ˜ï¼šè‡ªç”±è½¬è½½-éå•†ç”¨-éè¡ç”Ÿ-ä¿æŒç½²åï¼ˆ<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">åˆ›æ„å…±äº«3.0è®¸å¯è¯</a>ï¼‰</li> </ul> </div> </article> <div class="share"> <div class="share-component" data-disabled='qq,facebook'></div> </div> <div class="comment"> <script src="https://giscus.app/client.js" data-repo="slience-me/blog-comments" data-repo-id="R_kgDOKr27jA" data-category="Announcements" data-category-id="DIC_kwDOKr27jM4CnWMe" data-mapping="title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async> </script> </div> </div> <div class="column one-fourth"> <h3>Search</h3> <div id="site_search"> <div id="docsearch"> <input style="width:96%" type="text" id="search_box" placeholder="Search"> </div> </div> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script> <script type="text/javascript"> docsearch({ appId: "8W5T6R2WWG", apiKey: "e56e511c7c9f85e2c97e2817664aafb2", indexName: "doc", container: "#docsearch" }); </script> <h3 class="post-directory-title mobile-hidden">Table of Contents</h3> <div id="post-directory-module" class="mobile-hidden"> <section class="post-directory"> <dl></dl> </section> </div> <script src="https://blog.slienceme.cn/assets/js/jquery.toc.js"></script> </div> </div> </section> <footer class="container"> <div class="site-footer" role="contentinfo"> <div class="copyright left mobile-block"> <img src="/images/logo/logo.png" class="w-full" style="height: 10px;width: 10px;" alt="logo" />;"> <a href="https://beian.mps.gov.cn/#/query/webSearch?code=13102202000626" rel="noreferrer" target="_blank">å†€å…¬ç½‘å®‰å¤‡13102202000626</a> | <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank" rel="noreferrer">æ´¥ICPå¤‡2024026565å·-1</a> Copyright Â© 2019-present slience_me&emsp; <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a> </div> <ul class="site-footer-links right mobile-hidden"> <li> <a href="javascript:window.scrollTo(0,0)" >TOP</a> </li> </ul> <br/> <script defer src="https://vercount.one/js"></script> <div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> æœ¬ç«™è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡ </span> <span id="busuanzi_container_site_uv" style="display:none"> / æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº </span> <span id="busuanzi_container_page_pv" style="display:none"> / æœ¬é¡µè®¿é—®é‡<span id="busuanzi_value_page_pv"></span>æ¬¡ / ç»Ÿè®¡å§‹äº2024-12-01 </span> </div> </div> </footer> <div class="tools-wrapper"> <a class="gotop" href="#" title="å›åˆ°é¡¶éƒ¨"><span class="octicon octicon-arrow-up"></span></a> </div> <script src="https://blog.slienceme.cn/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="https://blog.slienceme.cn/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script> </body> </html>
