<!DOCTYPE html> <html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> <title>数据挖掘｜关于近期人民日报文章的词频分析 &mdash; Slience_me的博客</title> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/primer-css/css/primer.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/collection.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/repo-card.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/sections/repo-list.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/components/boxed-group.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/globals/common.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/globals/responsive.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/css/posts/index.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/octicons/octicons/octicons.css"> <link rel="stylesheet" href=" https://cdn.jsdelivr.net/npm/@docsearch/css@3 "/> <link rel="stylesheet" href="https://mazhuang.org/rouge-themes/dist/github.css"> <link rel="stylesheet" href="https://blog.slienceme.cn/assets/vendor/share.js/dist/css/share.min.css"> <link rel="canonical" href="https://blog.slienceme.cn/2023/12/05/%E5%85%B3%E4%BA%8E%E8%BF%91%E6%9C%9F%E4%BA%BA%E6%B0%91%E6%97%A5%E6%8A%A5%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90/"> <link rel="alternate" type="application/atom+xml" title="Slience_me的博客" href="https://blog.slienceme.cn/feed.xml"> <link rel="shortcut icon" href="https://blog.slienceme.cn/favicon.ico"> <meta property="og:title" content="数据挖掘｜关于近期人民日报文章的词频分析"> <meta name="keywords" content="数据挖掘, 词频分析"> <meta name="og:keywords" content="数据挖掘, 词频分析"> <meta name="description" content=""> <meta name="og:description" content=""> <meta property="og:url" content="https://blog.slienceme.cn/2023/12/05/%E5%85%B3%E4%BA%8E%E8%BF%91%E6%9C%9F%E4%BA%BA%E6%B0%91%E6%97%A5%E6%8A%A5%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90/"> <meta property="og:site_name" content="Slience_me的博客"> <meta property="og:type" content="article"> <meta property="og:locale" content="zh_CN" /> <meta property="article:published_time" content="2023-12-05"> <meta name="google-site-verification" content="2feHjT1GNs1Yi2JQfOtdYx7d048naG_-cMwZaDAopIA" /> <script src="https://blog.slienceme.cn/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://blog.slienceme.cn/assets/js/main.js"></script> </head> <body class="" data-mz=""> <header class="site-header"> <div class="container"> <h1><a href="https://blog.slienceme.cn/" title="Slience_me的博客"><span class="octicon octicon-mark-github"></span> Slience_me的博客</a></h1> <button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <nav class="site-header-nav" role="navigation"> <a href="https://blog.slienceme.cn/" class="site-header-nav-item" target="" title="首页">首页</a> <a href="https://blog.slienceme.cn/categories/" class="site-header-nav-item" target="" title="分类">分类</a> <a href="https://blog.slienceme.cn/archives/" class="mobile-hidden site-header-nav-item" target="" title="归档">归档</a> <a href="https://blog.slienceme.cn/open-source/" class="mobile-hidden site-header-nav-item" target="" title="开源">开源</a> <a href="https://blog.slienceme.cn/fragments/" class="site-header-nav-item" target="" title="片段">片段</a> <a href="https://blog.slienceme.cn/wiki/" class="site-header-nav-item" target="" title="维基">维基</a> <a href="https://blog.slienceme.cn/links/" class="mobile-hidden site-header-nav-item" target="" title="链接">链接</a> <a href="https://blog.slienceme.cn/about/" class="site-header-nav-item" target="" title="关于">关于</a> <a class="mobile-hidden" href="https://blog.slienceme.cn/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a> </nav> </div> </header> <section class="collection-head small geopattern" data-pattern-id="数据挖掘｜关于近期人民日报文章"> <div class="container"> <div class="columns"> <div class="column three-fourths"> <div class="collection-title"> <h1 class="collection-header">数据挖掘｜关于近期人民日报文章的词频分析</h1> <div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2023/12/05 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://blog.slienceme.cn/categories/#数据挖掘" title="数据挖掘">数据挖掘</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 28979 字，约 83 分钟 </span> </div> </div> </div> <div class="column one-fourth mobile-hidden"> <div class="collection-title"> </div> </div> </div> </div> </section> <section class="container content"> <div class="columns"> <div class="column three-fourths" > <article class="article-content markdown-body"> <p><img src="https://blog.slienceme.cn/images/posts/logo_slienceme3.png" alt="img" /></p> <p>本文作者： <a href="https://slienceme.cn/">slience_me</a></p> <hr /> <p>codeby: slience_me</p> <p><strong>项目地址:</strong> <a href="https://github.com/slience-me/data_mining_wordcloud">https://github.com/slience-me/data_mining_wordcloud</a></p> <p><strong>myCsdnBlog:</strong> <a href="https://blog.csdn.net/slience_me">https://blog.csdn.net/slience_me</a></p> <p><strong>myblog:</strong> <a href="https://slienceme.cn">https://slienceme.cn</a></p> <p><strong>myGitHub:</strong> <a href="https://github.com/slience-me">https://github.com/slience-me</a></p> <p>注：本项目为数据挖掘作业任务，仅为作学习使用</p> <p>数据获取过程严格遵循规定 <img src="https://blog.slienceme.cn/images/posts/image-20231205163710225.png" alt="image-20231205163710225" /></p> <blockquote> <p>这段文本是一个 robots.txt 文件的内容，用于指导网络爬虫（爬虫程序）在访问特定网站时应该遵循的规则。让我为你翻译一下：</p> <ul> <li>User-agent: <em>（用户代理：</em>）</li> <li>意味着适用于所有的网络爬虫。</li> <li>Disallow: （不允许访问的路径）</li> <li>在这里是空白的，表示没有特定路径是不允许访问的。也就是说，爬虫在此网站上没有被限制访问特定页面。</li> <li>Crawl-delay: 120（爬行延迟：120）</li> <li>表示网络爬虫应该在请求页面之间保持至少 120 秒的延迟，以减轻对服务器的负担。这有助于确保不会对服务器产生过多的请求负荷。</li> <li>Sitemap: http://www.people.cn/sitemap_index.xml（站点地图）</li> <li>这是站点地图的 URL，提供了有关网站中可用页面的信息。网络爬虫可以使用这个站点地图来更有效地索引网站的内容。 总的来说，这个 robots.txt 文件允许所有的网络爬虫访问这个网站的所有页面，但要求它们之间至少保持 120 秒的爬行延迟，以降低对服务器的压力。站点地图的 URL 也提供了关于网站内容的索引信息。</li> </ul> </blockquote> <h1 id="一人民日报文章内容分析独立分析">一、人民日报文章内容分析(独立分析)</h1> <h2 id="1数据获取">1.数据获取</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">bs4</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">fetch_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="s">"""
        功能：访问 url 的网页，获取网页内容并返回
    :param url: 目标网页的 url
    :return: 目标网页的 html 内容
    """</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'accept'</span><span class="p">:</span> <span class="s">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'</span><span class="p">,</span>
        <span class="s">'user-agent'</span><span class="p">:</span> <span class="s">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36'</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">r</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="n">r</span><span class="p">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">apparent_encoding</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">get_page_list</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
    <span class="s">"""
        功能：获取当天报纸的各版面的链接列表
    :param year: 年 改变年月日拼接成需要爬取的url
    :param month: 月
    :param day: 日
    :return: 返回当天报纸的各版面的链接列表
    """</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s">'http://paper.people.com.cn/rmrb/html/'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s">'-'</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'/nbs.D110000renmrb_01.htm'</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">fetch_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">bs_obj</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="s">'pageList'</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">temp</span><span class="p">:</span>
        <span class="n">page_list</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">ul</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'right_title-name'</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">page_list</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'swiper-container'</span><span class="p">}).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span>
                                                                                     <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'swiper-slide'</span><span class="p">})</span>
    <span class="n">link_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">page_list</span><span class="p">:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">page</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="s">"href"</span><span class="p">]</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">'http://paper.people.com.cn/rmrb/html/'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s">'-'</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">link</span>
        <span class="n">link_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">link_list</span>


<span class="k">def</span> <span class="nf">get_title_list</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">pageUrl</span><span class="p">):</span>
    <span class="s">"""
        功能：获取报纸某一版面的文章链接列表
    :param year: 年
    :param month: 月
    :param day: 日
    :param pageUrl: 该版面的链接
    :return:
    """</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">fetch_url</span><span class="p">(</span><span class="n">pageUrl</span><span class="p">)</span>
    <span class="n">bs_obj</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="s">'titleList'</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">temp</span><span class="p">:</span>
        <span class="n">title_list</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">ul</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'li'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">title_list</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'ul'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="s">'news-list'</span><span class="p">}).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'li'</span><span class="p">)</span>
    <span class="n">link_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">title_list</span><span class="p">:</span>
        <span class="n">temp_list</span> <span class="o">=</span> <span class="n">title</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temp_list</span><span class="p">:</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">"href"</span><span class="p">]</span>
            <span class="k">if</span> <span class="s">'nw.D110000renmrb'</span> <span class="ow">in</span> <span class="n">link</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s">'http://paper.people.com.cn/rmrb/html/'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s">'-'</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">link</span>
                <span class="n">link_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">link_list</span>


<span class="k">def</span> <span class="nf">get_content</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="s">"""
        功能：解析 HTML 网页，获取新闻的文章内容
    :param html: html 网页内容
    :return: 标题+内容
    """</span>
    <span class="n">bs_obj</span> <span class="o">=</span> <span class="n">bs4</span><span class="p">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>

    <span class="c1"># 获取文章 标题
</span>    <span class="n">title</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">text</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="o">+</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">h1</span><span class="p">.</span><span class="n">text</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="o">+</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">h2</span><span class="p">.</span><span class="n">text</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
    <span class="c1"># print(title)
</span>
    <span class="c1"># 获取文章 内容
</span>    <span class="n">p_list</span> <span class="o">=</span> <span class="n">bs_obj</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="s">'ozoom'</span><span class="p">}).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'p'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_list</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">+=</span> <span class="n">p</span><span class="p">.</span><span class="n">text</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
    <span class="c1"># print(content)
</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="n">content</span>
    <span class="k">return</span> <span class="n">resp</span>


<span class="k">def</span> <span class="nf">save_file</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="s">"""
        功能：将文章内容 content 保存到本地文件中
    :param content: 要保存的内容
    :param path: 路径
    :param filename: 文件名
    :return:
    """</span>
    <span class="c1"># 如果没有该文件夹，则自动生成
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="c1"># print('爬取到文章，正在下载中...')
</span>
    <span class="c1"># 保存文件
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">filename</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="c1"># print('爬取到文章，正在下载中...')
</span>    <span class="c1"># print('文章已写入：' + path)
</span>

<span class="k">def</span> <span class="nf">download_rmrb</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">destdir</span><span class="p">):</span>
    <span class="s">"""
        功能：爬取《人民日报》网站某年,某月,某日的新闻内容，并保存在指定目录下
    :param year: 年
    :param month: 月
    :param day: 日
    :param destdir: 文件保存的根目录
    :return:
    """</span>
    <span class="n">page_list</span> <span class="o">=</span> <span class="n">get_page_list</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">page_list</span><span class="p">:</span>
        <span class="n">title_list</span> <span class="o">=</span> <span class="n">get_title_list</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">title_list</span><span class="p">:</span>
            <span class="c1"># 获取新闻文章内容
</span>            <span class="n">html</span> <span class="o">=</span> <span class="n">fetch_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">get_content</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
            <span class="c1"># 生成保存的文件路径及文件名
</span>            <span class="n">temp</span> <span class="o">=</span> <span class="n">url</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'_'</span><span class="p">)[</span><span class="mi">2</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'-'</span><span class="p">)</span>
            <span class="n">page_no</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">title_no</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">else</span> <span class="s">'0'</span> <span class="o">+</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">destdir</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'/'</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'-'</span> <span class="o">+</span> <span class="n">page_no</span> <span class="o">+</span> <span class="s">'-'</span> <span class="o">+</span> <span class="n">title_no</span> <span class="o">+</span> <span class="s">'.txt'</span>

            <span class="c1"># 保存文件
</span>            <span class="n">save_file</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
            <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>  <span class="c1"># 休眠120s
</span>

<span class="k">def</span> <span class="nf">gen_dates</span><span class="p">(</span><span class="n">b_date</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">b_date</span> <span class="o">+</span> <span class="n">day</span> <span class="o">*</span> <span class="n">i</span>


<span class="k">def</span> <span class="nf">get_date_list</span><span class="p">(</span><span class="n">beginDate</span><span class="p">,</span> <span class="n">endDate</span><span class="p">):</span>
    <span class="s">"""
        获取日期列表
    :param beginDate: 开始日期
    :param endDate: 结束日期
    :return:
    """</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">beginDate</span><span class="p">,</span> <span class="s">"%Y%m%d"</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">endDate</span><span class="p">,</span> <span class="s">"%Y%m%d"</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">gen_dates</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">).</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="c1"># return: 返回开始日期和结束日期之间的日期列表
</span>    <span class="k">return</span> <span class="n">data</span>

    <span class="c1"># 主函数：程序入口
</span>

<span class="k">def</span> <span class="nf">get_news</span><span class="p">(</span><span class="n">local_data</span><span class="p">):</span>
    <span class="c1"># 输入起止日期，爬取之间的新闻
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'---文章爬取系统---'</span><span class="p">)</span>
    <span class="n">begin_date</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'请输入开始日期(格式如20231101):'</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'请输入结束日期(格式如20231101):'</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_date_list</span><span class="p">(</span><span class="n">begin_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">year</span><span class="p">)</span>
        <span class="n">month</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">month</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span><span class="p">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">else</span> <span class="s">'0'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
        <span class="n">day</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">day</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span><span class="p">.</span><span class="n">day</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">else</span> <span class="s">'0'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">day</span><span class="p">)</span>
        <span class="c1"># 爬取后文章t统一存到这个文件夹,没有会自动创建
</span>        <span class="n">destdir</span> <span class="o">=</span> <span class="s">"../data"</span>

        <span class="c1"># 判断日期是否在local_data中，如果在则continue
</span>        <span class="n">date</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="n">day</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">local_data</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'爬取文章时间为：'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'的文章已经存在!'</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'---开始爬取文章，日期为'</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="s">'---'</span><span class="p">)</span>
        <span class="n">download_rmrb</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">destdir</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"爬取文章完成！"</span><span class="p">)</span>
</code></pre></div></div> <h2 id="2数据处理">2.数据处理</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">jieba</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">zhon.hanzi</span> <span class="kn">import</span> <span class="n">punctuation</span> <span class="k">as</span> <span class="n">puncZH</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">punctuation</span> <span class="k">as</span> <span class="n">puncEN</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># 全局配置
</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf-8'</span>
<span class="n">global_path</span> <span class="o">=</span> <span class="s">'../data/'</span>
<span class="n">font_path</span> <span class="o">=</span> <span class="s">'../Fonts/方正正中黑简体.ttf'</span> 
<span class="n">width</span><span class="o">=</span><span class="mi">9000</span>
<span class="n">height</span><span class="o">=</span><span class="mi">6000</span>
<span class="n">punctuation_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">puncZH</span> <span class="o">+</span> <span class="n">puncEN</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_news_path</span><span class="p">():</span>
    <span class="s">"""
        获取路径下的全部文章内容
    :return: 全部文章的路径
    """</span>
    <span class="n">news_path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="s">'../data'</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">news_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'/'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"func get_news_path() is called：现有新闻总数为: "</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">news_path</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">news_path</span>


<span class="k">def</span> <span class="nf">remove_punctuation</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        去除标点符号    
    :param s: 传入的字符串
    :return: 去除标点符号后的字符串
    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[%s]+"</span> <span class="o">%</span> <span class="n">puncZH</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[%s]+"</span> <span class="o">%</span> <span class="n">puncEN</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[\d\n\t\r]+"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">has_punctuation</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        判断字符串中是否存在标点符号        
    :param s: 传入的字符串
    :return: bool标识
    """</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">punctuation_set</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_words</span><span class="p">(</span><span class="n">news</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        获取某路径下某个文章内的全部词语
    :param news: 
    :return: 
    """</span>
    <span class="n">split_news</span> <span class="o">=</span> <span class="n">jieba</span><span class="p">.</span><span class="n">lcut</span><span class="p">(</span><span class="n">news</span><span class="p">)</span>  <span class="c1"># 采用精确模式进行分词
</span>    <span class="n">removed_split_news</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">split_news</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">has_punctuation</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">removed_split_news</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">removed_split_news</span>


<span class="k">def</span> <span class="nf">get_words_count</span><span class="p">(</span><span class="n">news_path</span><span class="p">):</span>
    <span class="s">"""
        获取全部文章的全部词语
    :param news_path: 
    :return: 
    """</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">news_path</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="n">news</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">words</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_words</span><span class="p">(</span><span class="n">news</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_words_count() is called：词语数量: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">words</span>


<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>


<span class="k">def</span> <span class="nf">get_unique_words_count</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
    <span class="s">"""
        统计某个词语的词频信息
    :param words: 词语列表
    :return: 词语词频的字典
    """</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>  <span class="c1"># 使用collections.Counter来更简洁地统计词频
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：去重词语的个数：'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">word_count</span>


<span class="k">def</span> <span class="nf">get_stop_words</span><span class="p">():</span>
    <span class="s">"""
        获取停用词
    :return: 
    """</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="s">'../stopwords-master'</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'txt'</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
                        <span class="n">stopwords</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
                <span class="k">except</span> <span class="nb">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"UnicodeDecodeError: </span><span class="si">{</span><span class="n">dirname</span><span class="p">,</span><span class="n">filename</span><span class="si">}{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="c1"># 在这里处理异常，如忽略或记录错误
</span>    
    <span class="n">common_stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s">'年'</span><span class="p">,</span> <span class="s">'月'</span><span class="p">,</span> <span class="s">'日'</span><span class="p">,</span> <span class="s">'上'</span><span class="p">,</span> <span class="s">'中'</span><span class="p">,</span> <span class="s">'本报'</span><span class="p">,</span> <span class="s">'的'</span><span class="p">,</span> <span class="s">'和'</span><span class="p">,</span> <span class="s">'在'</span><span class="p">,</span> <span class="s">'为'</span><span class="p">,</span> <span class="s">'了'</span><span class="p">,</span> <span class="s">'</span><span class="se">\xa0</span><span class="s">'</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="s">'■'</span><span class="p">,</span> <span class="s">'是'</span><span class="p">}</span>
    <span class="n">stopwords</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">common_stopwords</span><span class="p">)</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stopwords</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：统计停用词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stopwords</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">stopwords</span>


<span class="k">def</span> <span class="nf">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count</span><span class="p">):</span>
    <span class="s">"""
        从全部词语中移除停用词
    :param word_count: 
    :return: 
    """</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_stop_words</span><span class="p">())</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">count</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：不带停用词的唯一单词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count</span><span class="p">))</span>
    <span class="n">word_count_no_single</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">count</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：去除单个字的唯一单词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count_no_single</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">word_count_no_single</span>


<span class="k">def</span> <span class="nf">timer_process</span><span class="p">():</span>
    <span class="s">"""
        计时器，用于计时生成词云图所用时间
    :return: 
    """</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"词云图生成时间计时，当前已经用时: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">)</span><span class="si">}</span><span class="s"> 秒"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">draw_wordcloud</span><span class="p">(</span><span class="n">word_count</span><span class="p">):</span>
    <span class="s">"""
        生成词云图并保存
    :param word_count: 词频字典
    :param font_path: 字体路径
    :param width: 图片宽度
    :param height: 图片高度
    """</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"开始初始化WordCloud init"</span><span class="p">)</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">font_path</span><span class="o">=</span><span class="n">font_path</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span>
                   <span class="n">max_words</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                   <span class="n">color_func</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"初始化完成! 开始生成WordCloud图片!预计503秒"</span><span class="p">)</span>
    <span class="n">timer</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="p">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">timer_process</span><span class="p">)</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">wc</span><span class="p">.</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">word_count</span><span class="p">)</span>
    <span class="c1"># 主进程执行完毕后，关闭计时进程
</span>    <span class="n">timer</span><span class="p">.</span><span class="n">terminate</span><span class="p">()</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"生成图片完成! 开始保存图片!"</span><span class="p">)</span>
    <span class="n">wc</span><span class="p">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">"People's Daily WordCloud Zh_1.png"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">"./People's Daily WordCloud Zh_1.png"</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"off"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"代码块执行时间：</span><span class="si">{</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="si">}</span><span class="s"> 秒"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_current_data_list</span><span class="p">():</span>
    <span class="s">"""
        获取当前现有文章
    :param global_path: 
    :return: 
    """</span>
    <span class="n">local_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">global_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">global_path</span> <span class="o">==</span> <span class="n">dirname</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># 跳过根路径
</span>        <span class="n">local_data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dirname</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">global_path</span><span class="p">,</span> <span class="s">''</span><span class="p">)))</span>
    <span class="n">local_data</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'当前已经有的数据有:'</span><span class="p">,</span> <span class="n">local_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">local_data</span>


<span class="k">def</span> <span class="nf">get_new_data</span><span class="p">():</span>
    <span class="s">"""
        判断用户是否要添加新数据
    :return: 
    """</span>
    <span class="n">local_data</span> <span class="o">=</span> <span class="n">get_current_data_list</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"新增文章数据吗? (Y/N): "</span><span class="p">).</span><span class="n">strip</span><span class="p">().</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s">'Y'</span><span class="p">:</span>
            <span class="n">get_news</span><span class="p">(</span><span class="n">local_data</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="s">'N'</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'不添加新数据!'</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'请输入Y或N!'</span><span class="p">)</span>

</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get_new_data</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>当前已经有的数据有: [20230901, 20230902, 20230903, 20230904, 20230905, 20230906, 20230907, 20230908, 20230909, 20230910, 20230911, 20230912, 20230913, 20230914, 20230915, 20230916, 20230917, 20230918, 20230919, 20230920, 20230921, 20230922, 20230923, 20230924, 20230925, 20230926, 20230927, 20230928, 20230929, 20231001, 20231002, 20231003, 20231004, 20231005, 20231006, 20231007, 20231008, 20231009, 20231010, 20231011, 20231012, 20231013, 20231014, 20231015, 20231016, 20231017, 20231018, 20231019, 20231020, 20231021, 20231022, 20231023, 20231024, 20231025, 20231026, 20231027, 20231028, 20231029, 20231101, 20231102, 20231103, 20231104]
不添加新数据!
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">news_path</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func get_news_path() is called：现有新闻总数为:  4495
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">words</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func get_words_count() is called：词语数量:  2717908
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">word_count</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func get_unique_words_count() is called：去重词语的个数： 93063
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">word_count</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  91900
func get_unique_words_count() is called：去除单个字的唯一单词总数:  88986
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">draw_wordcloud</span><span class="p">(</span><span class="n">word_count</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>开始初始化WordCloud init
初始化完成! 开始生成WordCloud图片!预计503秒
生成图片完成! 开始保存图片!
</code></pre></div></div> <p><img src="https://blog.slienceme.cn/images/posts/output_10_1.png" alt="output_10_1" /></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">word_ds</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_count</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">word_ds</span><span class="o">=</span><span class="n">word_ds</span><span class="p">.</span><span class="n">T</span>
<span class="n">word_ds</span><span class="p">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'count'</span><span class="p">]</span>
<span class="n">word_ds</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">'count'</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># from pylab import mpl
# mpl.rcParams['font.sans-serif'] = ['simhei'] # 指定默认字体
# mpl.rcParams['axes.unicode_minus'] = False # 解决保存图像是负号'-'显示为方块的问题
</span><span class="n">word_ds</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">'人民日报关键词词频统计'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'关键词名称'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'词频统计'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'数量'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="https://blog.slienceme.cn/images/posts/output_12_0.png" alt="output_12_0" /></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 针对不同的领域进行分析
</span><span class="n">category</span> <span class="o">=</span> <span class="p">[</span><span class="s">'政治与国际关系'</span><span class="p">,</span> <span class="s">'经济与金融'</span><span class="p">,</span> <span class="s">'文化与教育'</span><span class="p">,</span> <span class="s">'社会与人民生活'</span><span class="p">,</span> <span class="s">'科技与创新'</span><span class="p">,</span> <span class="s">'军事与国防'</span><span class="p">,</span> <span class="s">'环境与可持续发展'</span><span class="p">,</span> <span class="s">'国内地区报道'</span><span class="p">,</span> <span class="s">'国际报道'</span><span class="p">]</span>
<span class="n">category_keywords_politics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'政治与国际关系'</span><span class="p">,</span> <span class="s">'政治'</span><span class="p">,</span><span class="s">'党和政府'</span><span class="p">,</span> <span class="s">'国内政策'</span><span class="p">,</span> <span class="s">'国际外交'</span><span class="p">,</span> <span class="s">'国际合作'</span><span class="p">,</span> <span class="s">'政府工作'</span><span class="p">,</span> <span class="s">'政治改革'</span><span class="p">,</span> <span class="s">'政治动态'</span><span class="p">,</span> <span class="s">'政权'</span><span class="p">,</span> <span class="s">'外交政策'</span><span class="p">,</span> <span class="s">'政府机构'</span><span class="p">,</span> <span class="s">'党派政治'</span><span class="p">,</span> <span class="s">'领导人'</span><span class="p">,</span> <span class="s">'政治体制'</span><span class="p">,</span> <span class="s">'政治制度'</span><span class="p">,</span> <span class="s">'政治经济'</span><span class="p">,</span> <span class="s">'政治发展'</span><span class="p">,</span> <span class="s">'政治体制'</span><span class="p">,</span> <span class="s">'外交'</span><span class="p">,</span> <span class="s">'外交政策'</span><span class="p">,</span> <span class="s">'外交动态'</span><span class="p">,</span> <span class="s">'外交事务'</span><span class="p">,</span> <span class="s">'外交动态'</span><span class="p">,</span> <span class="s">'外交事务'</span><span class="p">,</span> <span class="s">'习近平'</span><span class="p">]</span>
<span class="n">category_keywords_economy</span> <span class="o">=</span> <span class="p">[</span><span class="s">'经济与金融'</span><span class="p">,</span> <span class="s">'经济'</span><span class="p">,</span> <span class="s">'金融'</span><span class="p">,</span> <span class="s">'经济发展'</span><span class="p">,</span> <span class="s">'贸易'</span><span class="p">,</span> <span class="s">'发展'</span><span class="p">,</span> <span class="s">'建设'</span><span class="p">,</span> <span class="s">'金融市场'</span><span class="p">,</span> <span class="s">'宏观经济政策'</span><span class="p">,</span> <span class="s">'产业发展'</span><span class="p">,</span> <span class="s">'经济改革'</span><span class="p">,</span> <span class="s">'经济动态'</span><span class="p">,</span> <span class="s">'经济增长'</span><span class="p">,</span> <span class="s">'经济政策'</span><span class="p">,</span> <span class="s">'经济动态'</span><span class="p">,</span> <span class="s">'经济体制'</span><span class="p">,</span> <span class="s">'经济体制'</span><span class="p">,</span> <span class="s">'经济领域'</span><span class="p">,</span> <span class="s">'经济政策'</span><span class="p">,</span> <span class="s">'经济改革'</span><span class="p">]</span>
<span class="n">category_keywords_culture</span> <span class="o">=</span> <span class="p">[</span><span class="s">'文化与教育'</span><span class="p">,</span> <span class="s">'文化活动'</span><span class="p">,</span> <span class="s">'艺术'</span><span class="p">,</span> <span class="s">'文化传承'</span><span class="p">,</span> <span class="s">'教育政策'</span><span class="p">,</span> <span class="s">'教育改革'</span><span class="p">,</span> <span class="s">'文化领域'</span><span class="p">,</span> <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'教育体制'</span><span class="p">,</span>  <span class="s">'文化教育'</span><span class="p">,</span> <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'文化传承'</span><span class="p">,</span> <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'文化'</span><span class="p">,</span> <span class="s">'教育'</span><span class="p">,</span> <span class="s">'传统文化'</span><span class="p">,</span> <span class="s">'中华文化'</span><span class="p">,</span> <span class="s">'传承'</span><span class="p">,</span> <span class="s">'历史'</span><span class="p">,</span> <span class="s">'学习'</span><span class="p">,</span> <span class="s">'诗词'</span><span class="p">,</span> <span class="s">'弘扬'</span><span class="p">,</span> <span class="s">'故宫'</span><span class="p">,</span> <span class="s">'书法'</span><span class="p">,</span> <span class="s">'博物馆'</span><span class="p">,</span> <span class="s">'国学'</span><span class="p">]</span>
<span class="n">category_keywords_society</span> <span class="o">=</span> <span class="p">[</span><span class="s">'社会与人民生活'</span><span class="p">,</span> <span class="s">'社会'</span><span class="p">,</span> <span class="s">'人民'</span><span class="p">,</span> <span class="s">'生活'</span><span class="p">,</span> <span class="s">'社会问题'</span><span class="p">,</span> <span class="s">'医疗卫生'</span><span class="p">,</span> <span class="s">'社会保障'</span><span class="p">,</span> <span class="s">'人民生活水平'</span><span class="p">,</span> <span class="s">'社会动态'</span><span class="p">,</span> <span class="s">'社会改革'</span><span class="p">,</span> <span class="s">'社会发展'</span><span class="p">,</span> <span class="s">'社会福利'</span><span class="p">]</span>
<span class="n">category_keywords_science</span> <span class="o">=</span> <span class="p">[</span><span class="s">'科技与创新'</span><span class="p">,</span> <span class="s">'科技'</span><span class="p">,</span> <span class="s">'创新'</span><span class="p">,</span> <span class="s">'科研发展'</span><span class="p">,</span> <span class="s">'科技政策'</span><span class="p">,</span> <span class="s">'创新技术'</span><span class="p">,</span> <span class="s">'信息技术'</span><span class="p">,</span> <span class="s">'科学研究'</span><span class="p">,</span> <span class="s">'科技领域'</span><span class="p">,</span> <span class="s">'科技创新'</span><span class="p">,</span> <span class="s">'技术发展'</span><span class="p">]</span>
<span class="n">category_keywords_military</span> <span class="o">=</span> <span class="p">[</span><span class="s">'军事与国防'</span><span class="p">,</span><span class="s">'国防'</span><span class="p">,</span> <span class="s">'军事'</span><span class="p">,</span> <span class="s">'军事动态'</span><span class="p">,</span> <span class="s">'军事政策'</span><span class="p">,</span> <span class="s">'军事技术'</span><span class="p">,</span> <span class="s">'军队'</span><span class="p">,</span> <span class="s">'国防建设'</span><span class="p">,</span> <span class="s">'军事演习'</span><span class="p">,</span> <span class="s">'军事合作'</span><span class="p">,</span> <span class="s">'官兵'</span><span class="p">,</span> <span class="s">'部队'</span><span class="p">,</span> <span class="s">'战士'</span><span class="p">,</span> <span class="s">'连队'</span><span class="p">,</span> <span class="s">'战友'</span><span class="p">,</span>  <span class="s">'战场'</span><span class="p">,</span> <span class="s">'装备'</span><span class="p">,</span> <span class="s">'军人'</span><span class="p">,</span> <span class="s">'强军'</span><span class="p">,</span> <span class="s">'海军'</span><span class="p">,</span> <span class="s">'飞行员'</span><span class="p">,</span> <span class="s">'官兵'</span><span class="p">,</span> <span class="s">'空军'</span><span class="p">,</span> <span class="s">'陆军'</span><span class="p">,</span> <span class="s">'导弹'</span><span class="p">,</span> <span class="s">'武警'</span><span class="p">]</span>
<span class="n">category_keywords_environment</span> <span class="o">=</span> <span class="p">[</span><span class="s">'环境与可持续发展'</span><span class="p">,</span> <span class="s">'环境'</span><span class="p">,</span> <span class="s">'可持续'</span><span class="p">,</span> <span class="s">'可持续发展'</span><span class="p">,</span> <span class="s">'环保政策'</span><span class="p">,</span> <span class="s">'可持续发展'</span><span class="p">,</span> <span class="s">'环境保护'</span><span class="p">,</span> <span class="s">'气候变化'</span><span class="p">,</span> <span class="s">'环境污染'</span><span class="p">,</span> <span class="s">'生态保护'</span><span class="p">,</span> <span class="s">'环境政策'</span><span class="p">,</span> <span class="s">'可持续资源利用'</span><span class="p">]</span>
<span class="n">category_keywords_domestic</span> <span class="o">=</span> <span class="p">[</span><span class="s">'国内地区报道'</span><span class="p">,</span> <span class="s">'国内'</span><span class="p">,</span> <span class="s">'地区'</span><span class="p">,</span> <span class="s">'地方政府工作'</span><span class="p">,</span> <span class="s">'地方动态'</span><span class="p">,</span> <span class="s">'地方经济'</span><span class="p">,</span> <span class="s">'地方政策'</span><span class="p">,</span> <span class="s">'地方社会'</span><span class="p">,</span> <span class="s">'地方文化'</span><span class="p">,</span> <span class="s">'地方发展'</span><span class="p">,</span> <span class="s">'地方改革'</span><span class="p">]</span>
<span class="n">category_keywords_internation</span> <span class="o">=</span> <span class="p">[</span><span class="s">'国际报道'</span><span class="p">,</span> <span class="s">'国际'</span><span class="p">,</span> <span class="s">'世界'</span><span class="p">,</span> <span class="s">'国际新闻'</span><span class="p">,</span> <span class="s">'国际事务'</span><span class="p">,</span> <span class="s">'国际合作'</span><span class="p">,</span> <span class="s">'国际外交'</span><span class="p">,</span> <span class="s">'国际关系'</span><span class="p">,</span> <span class="s">'国际经济'</span><span class="p">,</span> <span class="s">'国际政治'</span><span class="p">,</span> <span class="s">'国际动态'</span><span class="p">]</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">word_count</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'中共中央政治局': 217,
 '会议': 1322,
 '审议': 252,
 '干部': 1982,
 '对祖': 1,
 '认同': 146,
 '水平': 1432,
 '治会': 1,
 '可信赖': 5,
 '温暖': 220,
 '深入开展': 155,
 '契机': 269,
 '贴心人': 12,
 ...}
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 创建一个字典，用于存储每个领域的词频统计
</span><span class="n">category_word_counts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># 遍历每个领域的关键词列表
</span><span class="k">for</span> <span class="n">category_keywords</span> <span class="ow">in</span> <span class="p">[</span><span class="n">category_keywords_politics</span><span class="p">,</span> <span class="n">category_keywords_economy</span><span class="p">,</span><span class="n">category_keywords_culture</span><span class="p">,</span><span class="n">category_keywords_society</span><span class="p">,</span><span class="n">category_keywords_science</span><span class="p">,</span><span class="n">category_keywords_military</span><span class="p">,</span><span class="n">category_keywords_environment</span><span class="p">,</span><span class="n">category_keywords_domestic</span><span class="p">,</span><span class="n">category_keywords_internation</span><span class="p">]:</span>
    <span class="c1"># 初始化该领域的词频统计
</span>    <span class="n">category_word_count</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># 遍历关键词列表，统计词频
</span>    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">category_keywords</span><span class="p">:</span>
        <span class="c1"># 如果关键词存在于word_count中，将其词频添加到该领域的词频统计中
</span>        <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">:</span>
            <span class="n">category_word_count</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span> <span class="o">=</span> <span class="n">word_count</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span>
    
    <span class="c1"># 将该领域的词频统计添加到category_word_counts字典中
</span>    <span class="n">category_word_counts</span><span class="p">[</span><span class="n">category_keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">category_word_count</span>

<span class="n">category_word_counts_sum</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># 打印每个领域的词频统计
</span><span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">word_count_</span> <span class="ow">in</span> <span class="n">category_word_counts</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s">词频统计：'</span><span class="p">)</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count_</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">sum</span><span class="o">+=</span><span class="n">count</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="n">category_word_counts_sum</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span>
    <span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">category_word_counts_sum</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>政治与国际关系词频统计：
政治: 1407
党和政府: 49
政权: 26
外交政策: 39
领导人: 418
政治体制: 8
政治经济: 20
外交: 280
外交事务: 9
习近平: 7589

经济与金融词频统计：
经济: 6395
金融: 1640
贸易: 1558
发展: 24279
建设: 10094
金融市场: 29
经济体制: 55

文化与教育词频统计：
艺术: 734
教育体制: 4
文化教育: 25
文化: 8010
教育: 3988
中华文化: 346
传承: 1167
历史: 3034
学习: 1809
诗词: 160
弘扬: 784
故宫: 11
书法: 20
博物馆: 465
国学: 5

社会与人民生活词频统计：
社会: 3087
人民: 4061
生活: 1825
医疗卫生: 130
社会保障: 161
社会福利: 4

科技与创新词频统计：
科技: 3480
创新: 6649
信息技术: 145
科学研究: 75
科技领域: 20

军事与国防词频统计：
国防: 173
军事: 104
军队: 130
国防建设: 7
官兵: 107
部队: 170
战士: 33
连队: 20
战友: 32
战场: 34
装备: 476
军人: 41
强军: 110
海军: 43
飞行员: 21
空军: 18
陆军: 14
导弹: 7
武警: 8

环境与可持续发展词频统计：
环境: 1932
环境保护: 377
气候变化: 480
环境污染: 85

国内地区报道词频统计：
国内: 913
地区: 2638

国际报道词频统计：
国际: 6317
世界: 4653
国际事务: 69

{'政治与国际关系': 9845, '经济与金融': 44050, '文化与教育': 20562, '社会与人民生活': 9268, '科技与创新': 10369, '军事与国防': 1548, '环境与可持续发展': 2874, '国内地区报道': 3551, '国际报道': 11039}
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 提取领域和词频数据
# 创建柱状图
</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">category_word_counts_sum</span><span class="p">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">category_word_counts_sum</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'词频统计'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'不同领域的词频统计'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">invert_yaxis</span><span class="p">()</span>  <span class="c1"># 逆序显示
</span>
<span class="c1"># 显示图表
</span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="https://blog.slienceme.cn/images/posts/output_16_0.png" alt="output_16_0" /></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_word_count</span><span class="p">(</span><span class="n">word_count</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">word_count</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">word_count</span><span class="p">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'领域'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'词频'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 打印每个领域的词频统计
</span><span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">word_count_</span> <span class="ow">in</span> <span class="n">category_word_counts</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plot_word_count</span><span class="p">(</span><span class="n">word_count_</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span>
</code></pre></div></div> <h1 id="二针对各个月份的数据进行对比分析">二、针对各个月份的数据进行对比分析</h1> <h2 id="人民日报文章月度内容分析">人民日报文章月度内容分析</h2> <h3 id="1月度关键词对比分析">1.月度关键词对比分析</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">jieba</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">zhon.hanzi</span> <span class="kn">import</span> <span class="n">punctuation</span> <span class="k">as</span> <span class="n">puncZH</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">punctuation</span> <span class="k">as</span> <span class="n">puncEN</span>
<span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># 全局配置
</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf-8'</span>
<span class="n">global_path</span> <span class="o">=</span> <span class="s">'datas_contrast/'</span>
<span class="n">font_path</span> <span class="o">=</span> <span class="s">'Fonts/方正正中黑简体.ttf'</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">9000</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">6000</span>
<span class="n">punctuation_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">puncZH</span> <span class="o">+</span> <span class="n">puncEN</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_news_path</span><span class="p">(</span><span class="n">year_month</span><span class="p">):</span>
    <span class="s">"""
      获取路径下的全部文章内容
    :param year_month: 年月
    :return: 全部文章的路径 
    """</span>
    <span class="n">news_path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">global_path</span> <span class="o">+</span> <span class="n">year_month</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">news_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">'</span><span class="p">,</span> <span class="s">'/'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"func get_news_path() is called：文件夹{}中现有新闻总数为: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">year_month</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">news_path</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">news_path</span>


<span class="k">def</span> <span class="nf">remove_punctuation</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        去除标点符号    
    :param s: 传入的字符串
    :return: 去除标点符号后的字符串
    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[%s]+"</span> <span class="o">%</span> <span class="n">puncZH</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[%s]+"</span> <span class="o">%</span> <span class="n">puncEN</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s">"[\d\n\t\r]+"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">has_punctuation</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        判断字符串中是否存在标点符号        
    :param s: 传入的字符串
    :return: bool标识
    """</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">punctuation_set</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_words</span><span class="p">(</span><span class="n">news</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s">"""
        获取某路径下某个文章内的全部词语
    :param news: 
    :return: 
    """</span>
    <span class="n">split_news</span> <span class="o">=</span> <span class="n">jieba</span><span class="p">.</span><span class="n">lcut</span><span class="p">(</span><span class="n">news</span><span class="p">)</span>  <span class="c1"># 采用精确模式进行分词
</span>    <span class="n">removed_split_news</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">split_news</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">has_punctuation</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">removed_split_news</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">removed_split_news</span>


<span class="k">def</span> <span class="nf">get_words_count</span><span class="p">(</span><span class="n">news_path</span><span class="p">):</span>
    <span class="s">"""
        获取全部文章的全部词语
    :param news_path: 
    :return: 
    """</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">news_path</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="n">news</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">words</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_words</span><span class="p">(</span><span class="n">news</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_words_count() is called：词语数量: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">words</span>


<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>


<span class="k">def</span> <span class="nf">get_unique_words_count</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
    <span class="s">"""
        统计某个词语的词频信息
    :param words: 词语列表
    :return: 词语词频的字典
    """</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>  <span class="c1"># 使用collections.Counter来更简洁地统计词频
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：去重词语的个数：'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">word_count</span>


<span class="k">def</span> <span class="nf">get_stop_words</span><span class="p">():</span>
    <span class="s">"""
        获取停用词
    :return: 
    """</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="s">'stopwords-master'</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'txt'</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
                        <span class="n">stopwords</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
                <span class="k">except</span> <span class="nb">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"UnicodeDecodeError: </span><span class="si">{</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="si">}{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="c1"># 在这里处理异常，如忽略或记录错误
</span>
    <span class="n">common_stopwords</span> <span class="o">=</span> <span class="p">{</span><span class="s">'年'</span><span class="p">,</span> <span class="s">'月'</span><span class="p">,</span> <span class="s">'日'</span><span class="p">,</span> <span class="s">'上'</span><span class="p">,</span> <span class="s">'中'</span><span class="p">,</span> <span class="s">'本报'</span><span class="p">,</span> <span class="s">'的'</span><span class="p">,</span> <span class="s">'和'</span><span class="p">,</span> <span class="s">'在'</span><span class="p">,</span> <span class="s">'为'</span><span class="p">,</span> <span class="s">'了'</span><span class="p">,</span> <span class="s">'</span><span class="se">\xa0</span><span class="s">'</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="s">'■'</span><span class="p">,</span>
                        <span class="s">'是'</span><span class="p">}</span>
    <span class="n">stopwords</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">common_stopwords</span><span class="p">)</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">stopwords</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：统计停用词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">stopwords</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">stopwords</span>


<span class="k">def</span> <span class="nf">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count</span><span class="p">):</span>
    <span class="s">"""
        从全部词语中移除停用词
    :param word_count: 
    :return: 
    """</span>
    <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_stop_words</span><span class="p">())</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">count</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：不带停用词的唯一单词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count</span><span class="p">))</span>
    <span class="n">word_count_no_single</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">count</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'func get_unique_words_count() is called：去除单个字的唯一单词总数: '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_count_no_single</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">word_count_no_single</span>


<span class="k">def</span> <span class="nf">timer_process</span><span class="p">():</span>
    <span class="s">"""
        计时器，用于计时生成词云图所用时间
    :return: 
    """</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"词云图生成时间计时，当前已经用时: </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">)</span><span class="si">}</span><span class="s"> 秒"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'</span><span class="se">\r</span><span class="s">'</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">draw_wordcloud</span><span class="p">(</span><span class="n">word_count</span><span class="p">):</span>
    <span class="s">"""
        生成词云图并保存
    :param word_count: 词频字典
    :param font_path: 字体路径
    :param width: 图片宽度
    :param height: 图片高度
    """</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"开始初始化WordCloud init"</span><span class="p">)</span>
    <span class="n">wc</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">font_path</span><span class="o">=</span><span class="n">font_path</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">background_color</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span>
                   <span class="n">max_words</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                   <span class="n">color_func</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"初始化完成! 开始生成WordCloud图片!预计400秒"</span><span class="p">)</span>
    <span class="n">timer</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="p">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">timer_process</span><span class="p">)</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">wc</span><span class="p">.</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">word_count</span><span class="p">)</span>
    <span class="c1"># 主进程执行完毕后，关闭计时进程
</span>    <span class="n">timer</span><span class="p">.</span><span class="n">terminate</span><span class="p">()</span>
    <span class="n">timer</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"生成图片完成! 开始保存图片!"</span><span class="p">)</span>
    <span class="n">wc</span><span class="p">.</span><span class="n">to_file</span><span class="p">(</span><span class="s">"People's Daily WordCloud Zh_1.png"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">imread</span><span class="p">(</span><span class="s">"./People's Daily WordCloud Zh_1.png"</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"off"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"代码块执行时间：</span><span class="si">{</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="si">}</span><span class="s"> 秒"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_current_data_list</span><span class="p">():</span>
    <span class="s">"""
        获取当前现有文章
    :param global_path: 
    :return: 
    """</span>
    <span class="n">local_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="n">global_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">global_path</span> <span class="o">==</span> <span class="n">dirname</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># 跳过根路径
</span>        <span class="n">local_data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dirname</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">global_path</span><span class="p">,</span> <span class="s">''</span><span class="p">)))</span>
    <span class="n">local_data</span><span class="p">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'当前已经有的数据有:'</span><span class="p">,</span> <span class="n">local_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">local_data</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="c1"># 针对不同的领域进行分析
</span><span class="n">category</span> <span class="o">=</span> <span class="p">[</span><span class="s">'政治与国际关系'</span><span class="p">,</span> <span class="s">'经济与金融'</span><span class="p">,</span> <span class="s">'文化与教育'</span><span class="p">,</span> <span class="s">'社会与人民生活'</span><span class="p">,</span> <span class="s">'科技与创新'</span><span class="p">,</span> <span class="s">'军事与国防'</span><span class="p">,</span>
            <span class="s">'环境与可持续发展'</span><span class="p">,</span> <span class="s">'国内地区报道'</span><span class="p">,</span> <span class="s">'国际报道'</span><span class="p">]</span>
<span class="n">category_keywords_politics</span> <span class="o">=</span> <span class="p">[</span><span class="s">'政治与国际关系'</span><span class="p">,</span> <span class="s">'政治'</span><span class="p">,</span> <span class="s">'党和政府'</span><span class="p">,</span> <span class="s">'国内政策'</span><span class="p">,</span> <span class="s">'国际外交'</span><span class="p">,</span> <span class="s">'国际合作'</span><span class="p">,</span> <span class="s">'政府工作'</span><span class="p">,</span>
                              <span class="s">'政治改革'</span><span class="p">,</span> <span class="s">'政治动态'</span><span class="p">,</span> <span class="s">'政权'</span><span class="p">,</span> <span class="s">'外交政策'</span><span class="p">,</span> <span class="s">'政府机构'</span><span class="p">,</span> <span class="s">'党派政治'</span><span class="p">,</span> <span class="s">'领导人'</span><span class="p">,</span> <span class="s">'政治体制'</span><span class="p">,</span>
                              <span class="s">'政治制度'</span><span class="p">,</span> <span class="s">'政治经济'</span><span class="p">,</span> <span class="s">'政治发展'</span><span class="p">,</span> <span class="s">'政治体制'</span><span class="p">,</span> <span class="s">'外交'</span><span class="p">,</span> <span class="s">'外交政策'</span><span class="p">,</span> <span class="s">'外交动态'</span><span class="p">,</span>
                              <span class="s">'外交事务'</span><span class="p">,</span> <span class="s">'外交动态'</span><span class="p">,</span> <span class="s">'外交事务'</span><span class="p">,</span> <span class="s">'习近平'</span><span class="p">]</span>
<span class="n">category_keywords_economy</span> <span class="o">=</span> <span class="p">[</span><span class="s">'经济与金融'</span><span class="p">,</span> <span class="s">'经济'</span><span class="p">,</span> <span class="s">'金融'</span><span class="p">,</span> <span class="s">'经济发展'</span><span class="p">,</span> <span class="s">'贸易'</span><span class="p">,</span> <span class="s">'发展'</span><span class="p">,</span> <span class="s">'建设'</span><span class="p">,</span> <span class="s">'金融市场'</span><span class="p">,</span>
                             <span class="s">'宏观经济政策'</span><span class="p">,</span> <span class="s">'产业发展'</span><span class="p">,</span> <span class="s">'经济改革'</span><span class="p">,</span> <span class="s">'经济动态'</span><span class="p">,</span> <span class="s">'经济增长'</span><span class="p">,</span> <span class="s">'经济政策'</span><span class="p">,</span> <span class="s">'经济动态'</span><span class="p">,</span>
                             <span class="s">'经济体制'</span><span class="p">,</span> <span class="s">'经济体制'</span><span class="p">,</span> <span class="s">'经济领域'</span><span class="p">,</span> <span class="s">'经济政策'</span><span class="p">,</span> <span class="s">'经济改革'</span><span class="p">]</span>
<span class="n">category_keywords_culture</span> <span class="o">=</span> <span class="p">[</span><span class="s">'文化与教育'</span><span class="p">,</span> <span class="s">'文化活动'</span><span class="p">,</span> <span class="s">'艺术'</span><span class="p">,</span> <span class="s">'文化传承'</span><span class="p">,</span> <span class="s">'教育政策'</span><span class="p">,</span> <span class="s">'教育改革'</span><span class="p">,</span> <span class="s">'文化领域'</span><span class="p">,</span>
                             <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'教育体制'</span><span class="p">,</span> <span class="s">'文化教育'</span><span class="p">,</span> <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'文化传承'</span><span class="p">,</span> <span class="s">'文化发展'</span><span class="p">,</span> <span class="s">'文化'</span><span class="p">,</span> <span class="s">'教育'</span><span class="p">,</span>
                             <span class="s">'传统文化'</span><span class="p">,</span> <span class="s">'中华文化'</span><span class="p">,</span> <span class="s">'传承'</span><span class="p">,</span> <span class="s">'历史'</span><span class="p">,</span> <span class="s">'学习'</span><span class="p">,</span> <span class="s">'诗词'</span><span class="p">,</span> <span class="s">'弘扬'</span><span class="p">,</span> <span class="s">'故宫'</span><span class="p">,</span> <span class="s">'书法'</span><span class="p">,</span> <span class="s">'博物馆'</span><span class="p">,</span>
                             <span class="s">'国学'</span><span class="p">]</span>
<span class="n">category_keywords_society</span> <span class="o">=</span> <span class="p">[</span><span class="s">'社会与人民生活'</span><span class="p">,</span> <span class="s">'社会'</span><span class="p">,</span> <span class="s">'人民'</span><span class="p">,</span> <span class="s">'生活'</span><span class="p">,</span> <span class="s">'社会问题'</span><span class="p">,</span> <span class="s">'医疗卫生'</span><span class="p">,</span> <span class="s">'社会保障'</span><span class="p">,</span>
                             <span class="s">'人民生活水平'</span><span class="p">,</span> <span class="s">'社会动态'</span><span class="p">,</span> <span class="s">'社会改革'</span><span class="p">,</span> <span class="s">'社会发展'</span><span class="p">,</span> <span class="s">'社会福利'</span><span class="p">]</span>
<span class="n">category_keywords_science</span> <span class="o">=</span> <span class="p">[</span><span class="s">'科技与创新'</span><span class="p">,</span> <span class="s">'科技'</span><span class="p">,</span> <span class="s">'创新'</span><span class="p">,</span> <span class="s">'科研发展'</span><span class="p">,</span> <span class="s">'科技政策'</span><span class="p">,</span> <span class="s">'创新技术'</span><span class="p">,</span> <span class="s">'信息技术'</span><span class="p">,</span> <span class="s">'科学研究'</span><span class="p">,</span>
                             <span class="s">'科技领域'</span><span class="p">,</span> <span class="s">'科技创新'</span><span class="p">,</span> <span class="s">'技术发展'</span><span class="p">]</span>
<span class="n">category_keywords_military</span> <span class="o">=</span> <span class="p">[</span><span class="s">'军事与国防'</span><span class="p">,</span> <span class="s">'国防'</span><span class="p">,</span> <span class="s">'军事'</span><span class="p">,</span> <span class="s">'军事动态'</span><span class="p">,</span> <span class="s">'军事政策'</span><span class="p">,</span> <span class="s">'军事技术'</span><span class="p">,</span> <span class="s">'军队'</span><span class="p">,</span> <span class="s">'国防建设'</span><span class="p">,</span>
                              <span class="s">'军事演习'</span><span class="p">,</span> <span class="s">'军事合作'</span><span class="p">,</span> <span class="s">'官兵'</span><span class="p">,</span> <span class="s">'部队'</span><span class="p">,</span> <span class="s">'战士'</span><span class="p">,</span> <span class="s">'连队'</span><span class="p">,</span> <span class="s">'战友'</span><span class="p">,</span> <span class="s">'战场'</span><span class="p">,</span> <span class="s">'装备'</span><span class="p">,</span> <span class="s">'军人'</span><span class="p">,</span>
                              <span class="s">'强军'</span><span class="p">,</span> <span class="s">'海军'</span><span class="p">,</span> <span class="s">'飞行员'</span><span class="p">,</span> <span class="s">'官兵'</span><span class="p">,</span> <span class="s">'空军'</span><span class="p">,</span> <span class="s">'陆军'</span><span class="p">,</span> <span class="s">'导弹'</span><span class="p">,</span> <span class="s">'武警'</span><span class="p">]</span>
<span class="n">category_keywords_environment</span> <span class="o">=</span> <span class="p">[</span><span class="s">'环境与可持续发展'</span><span class="p">,</span> <span class="s">'环境'</span><span class="p">,</span> <span class="s">'可持续'</span><span class="p">,</span> <span class="s">'可持续发展'</span><span class="p">,</span> <span class="s">'环保政策'</span><span class="p">,</span> <span class="s">'可持续发展'</span><span class="p">,</span>
                                 <span class="s">'环境保护'</span><span class="p">,</span> <span class="s">'气候变化'</span><span class="p">,</span> <span class="s">'环境污染'</span><span class="p">,</span> <span class="s">'生态保护'</span><span class="p">,</span> <span class="s">'环境政策'</span><span class="p">,</span> <span class="s">'可持续资源利用'</span><span class="p">]</span>
<span class="n">category_keywords_domestic</span> <span class="o">=</span> <span class="p">[</span><span class="s">'国内地区报道'</span><span class="p">,</span> <span class="s">'国内'</span><span class="p">,</span> <span class="s">'地区'</span><span class="p">,</span> <span class="s">'地方政府工作'</span><span class="p">,</span> <span class="s">'地方动态'</span><span class="p">,</span> <span class="s">'地方经济'</span><span class="p">,</span> <span class="s">'地方政策'</span><span class="p">,</span>
                              <span class="s">'地方社会'</span><span class="p">,</span> <span class="s">'地方文化'</span><span class="p">,</span> <span class="s">'地方发展'</span><span class="p">,</span> <span class="s">'地方改革'</span><span class="p">]</span>
<span class="n">category_keywords_internation</span> <span class="o">=</span> <span class="p">[</span><span class="s">'国际报道'</span><span class="p">,</span> <span class="s">'国际'</span><span class="p">,</span> <span class="s">'世界'</span><span class="p">,</span> <span class="s">'国际新闻'</span><span class="p">,</span> <span class="s">'国际事务'</span><span class="p">,</span> <span class="s">'国际合作'</span><span class="p">,</span> <span class="s">'国际外交'</span><span class="p">,</span> <span class="s">'国际关系'</span><span class="p">,</span>
                                 <span class="s">'国际经济'</span><span class="p">,</span> <span class="s">'国际政治'</span><span class="p">,</span> <span class="s">'国际动态'</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">mpl</span>

<span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'font.sans-serif'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'simhei'</span><span class="p">]</span>  <span class="c1"># 指定默认字体
</span><span class="n">mpl</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.unicode_minus'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c1"># 解决保存图像是负号'-'显示为方块的问题
</span>

<span class="k">def</span> <span class="nf">draw_word_frequency_distribution</span><span class="p">(</span><span class="n">word_count</span><span class="p">):</span>
    <span class="s">"""
        画词频分布图
    :param word_count: 词频分布
    :return: 
    """</span>
    <span class="n">word_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">word_count</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">word_ds</span> <span class="o">=</span> <span class="n">word_ds</span><span class="p">.</span><span class="n">T</span>
    <span class="n">word_ds</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'count'</span><span class="p">]</span>
    <span class="n">word_ds</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">'count'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="c1"># print(word_ds.head(20))
</span>    <span class="n">word_ds</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'人民日报关键词词频统计'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'关键词名称'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'词频统计'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'数量'</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">draw_word_frequency_changes</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">keys</span><span class="p">()).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a3</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a4</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a5</span><span class="p">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_keys</span><span class="p">)</span>

    <span class="c1"># 取前15个关键词
</span>    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="s">'07'</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">a1</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="s">'08'</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">a2</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="s">'09'</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">a3</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="s">'10'</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">a4</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">month</span> <span class="o">=</span> <span class="s">'11'</span>
        <span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">a5</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">15</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'flag error'</span><span class="p">)</span>

    <span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">a1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a1</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="n">a2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a2</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">]</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="p">[</span><span class="n">a3</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a3</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">]</span>
    <span class="n">y4</span> <span class="o">=</span> <span class="p">[</span><span class="n">a4</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a4</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">]</span>
    <span class="n">y5</span> <span class="o">=</span> <span class="p">[</span><span class="n">a5</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a5</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">]</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.15</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_keys</span><span class="p">))</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a1'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="n">bar_width</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y2</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a2'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a3'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y4</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a4'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y5</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a5'</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'关键词'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'词频'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'前15条关键字词频变化(以2023年</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s">月的关键字为准)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sorted_keys</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'202307'</span><span class="p">,</span> <span class="s">'202308'</span><span class="p">,</span> <span class="s">'202309'</span><span class="p">,</span> <span class="s">'202310'</span><span class="p">,</span> <span class="s">'202311'</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_word_frequency_statistics_for_each_field_changes</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">):</span>
    <span class="n">all_keys</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">a1</span><span class="p">.</span><span class="n">keys</span><span class="p">()).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a2</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a3</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a4</span><span class="p">.</span><span class="n">keys</span><span class="p">())).</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">a5</span><span class="p">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_keys</span><span class="p">)</span>

    <span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">a1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a1</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="n">a2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a2</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="p">[</span><span class="n">a3</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a3</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">y4</span> <span class="o">=</span> <span class="p">[</span><span class="n">a4</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a4</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">y5</span> <span class="o">=</span> <span class="p">[</span><span class="n">a5</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">a5</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.15</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a1'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">-</span> <span class="n">bar_width</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y2</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a2'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a3'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y4</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a4'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">y5</span><span class="p">,</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'a5'</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'不同领域的名称'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'各个领域所占词频'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'不同时期不同领域关键字词频变化'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'202307'</span><span class="p">,</span> <span class="s">'202308'</span><span class="p">,</span> <span class="s">'202309'</span><span class="p">,</span> <span class="s">'202310'</span><span class="p">,</span> <span class="s">'202311'</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_word_frequency_statistics_for_each_field</span><span class="p">(</span><span class="n">word_count</span><span class="p">,</span> <span class="n">year_month</span><span class="p">):</span>
    <span class="c1"># 创建一个字典，用于存储每个领域的词频统计
</span>    <span class="n">category_word_counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># 遍历每个领域的关键词列表
</span>    <span class="k">for</span> <span class="n">category_keywords</span> <span class="ow">in</span> <span class="p">[</span><span class="n">category_keywords_politics</span><span class="p">,</span> <span class="n">category_keywords_economy</span><span class="p">,</span> <span class="n">category_keywords_culture</span><span class="p">,</span>
                              <span class="n">category_keywords_society</span><span class="p">,</span> <span class="n">category_keywords_science</span><span class="p">,</span> <span class="n">category_keywords_military</span><span class="p">,</span>
                              <span class="n">category_keywords_environment</span><span class="p">,</span> <span class="n">category_keywords_domestic</span><span class="p">,</span> <span class="n">category_keywords_internation</span><span class="p">]:</span>
        <span class="c1"># 初始化该领域的词频统计
</span>        <span class="n">category_word_count</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 遍历关键词列表，统计词频
</span>        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">category_keywords</span><span class="p">:</span>
            <span class="c1"># 如果关键词存在于word_count中，将其词频添加到该领域的词频统计中
</span>            <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">word_count</span><span class="p">:</span>
                <span class="n">category_word_count</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span> <span class="o">=</span> <span class="n">word_count</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span>

        <span class="c1"># 将该领域的词频统计添加到category_word_counts字典中
</span>        <span class="n">category_word_counts</span><span class="p">[</span><span class="n">category_keywords</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">category_word_count</span>

    <span class="n">category_word_counts_sum</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># 打印每个领域的词频统计
</span>    <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">word_count_</span> <span class="ow">in</span> <span class="n">category_word_counts</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># print(f'{category}词频统计：')
</span>        <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">word_count_</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">sum</span> <span class="o">+=</span> <span class="n">count</span>
            <span class="c1"># print(f'{keyword}: {count}')
</span>        <span class="n">category_word_counts_sum</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span>
        <span class="k">print</span><span class="p">()</span>
    <span class="c1"># print(category_word_counts_sum)
</span>    <span class="c1"># 提取领域和词频数据
</span>    <span class="c1"># 创建柱状图
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">category_word_counts_sum</span><span class="p">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">category_word_counts_sum</span><span class="p">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">year_month</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s">'年'</span> <span class="o">+</span> <span class="n">year_month</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="o">+</span> <span class="s">'月'</span> <span class="o">+</span> <span class="s">'词频统计'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">year_month</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s">'年'</span> <span class="o">+</span> <span class="n">year_month</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="o">+</span> <span class="s">'月'</span> <span class="o">+</span> <span class="s">'不同领域的词频统计'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">invert_yaxis</span><span class="p">()</span>  <span class="c1"># 逆序显示
</span>    <span class="c1"># 显示图表
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">get_word_frequency_statistics_for_each_field_single</span><span class="p">(</span><span class="n">category_word_counts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">category_word_counts_sum</span>


<span class="k">def</span> <span class="nf">get_word_frequency_statistics_for_each_field_single</span><span class="p">(</span><span class="n">category_word_counts</span><span class="p">):</span>
    <span class="n">num_categories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">category_word_counts</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>  <span class="c1"># 创建一个3x3的子图网格
</span>    <span class="n">categories</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">category_word_counts</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">num_categories</span><span class="p">:</span>
                <span class="n">category</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">word_count</span> <span class="o">=</span> <span class="n">category_word_counts</span><span class="p">[</span><span class="n">category</span><span class="p">]</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">bar</span><span class="p">(</span><span class="n">word_count</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">word_count</span><span class="p">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s">'skyblue'</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'词语'</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'词频'</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'x'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">].</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># 调整子图之间的间距
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">news_path_202307</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">(</span><span class="s">'202307'</span><span class="p">)</span>
<span class="n">news_path_202308</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">(</span><span class="s">'202308'</span><span class="p">)</span>
<span class="n">news_path_202309</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">(</span><span class="s">'202309'</span><span class="p">)</span>
<span class="n">news_path_202310</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">(</span><span class="s">'202310'</span><span class="p">)</span>
<span class="n">news_path_202311</span> <span class="o">=</span> <span class="n">get_news_path</span><span class="p">(</span><span class="s">'202311'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func get_news_path() is called：文件夹202307中现有新闻总数为: 2573
func get_news_path() is called：文件夹202308中现有新闻总数为: 2585
func get_news_path() is called：文件夹202309中现有新闻总数为: 2335
func get_news_path() is called：文件夹202310中现有新闻总数为: 2055
func get_news_path() is called：文件夹202311中现有新闻总数为: 1078
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202307/"</span><span class="p">)</span>
<span class="n">words_202307</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path_202307</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202308/"</span><span class="p">)</span>
<span class="n">words_202308</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path_202308</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202309/"</span><span class="p">)</span>
<span class="n">words_202309</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path_202309</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202310/"</span><span class="p">)</span>
<span class="n">words_202310</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path_202310</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202311/"</span><span class="p">)</span>
<span class="n">words_202311</span> <span class="o">=</span> <span class="n">get_words_count</span><span class="p">(</span><span class="n">news_path_202311</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>文件夹: ..data_contrast/202307/
func get_words_count() is called：词语数量:  1470033
文件夹: ..data_contrast/202308/
func get_words_count() is called：词语数量:  1503083
文件夹: ..data_contrast/202309/
func get_words_count() is called：词语数量:  1344367
文件夹: ..data_contrast/202310/
func get_words_count() is called：词语数量:  1318942
文件夹: ..data_contrast/202311/
func get_words_count() is called：词语数量:  680024
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202307/"</span><span class="p">)</span>
<span class="n">word_count_202307</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words_202307</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202308/"</span><span class="p">)</span>
<span class="n">word_count_202308</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words_202308</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202309/"</span><span class="p">)</span>
<span class="n">word_count_202309</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words_202309</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202310/"</span><span class="p">)</span>
<span class="n">word_count_202310</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words_202310</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202311/"</span><span class="p">)</span>
<span class="n">word_count_202311</span> <span class="o">=</span> <span class="n">get_unique_words_count</span><span class="p">(</span><span class="n">words_202311</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>文件夹: ..data_contrast/202307/
func get_unique_words_count() is called：去重词语的个数： 72914
文件夹: ..data_contrast/202308/
func get_unique_words_count() is called：去重词语的个数： 74344
文件夹: ..data_contrast/202309/
func get_unique_words_count() is called：去重词语的个数： 66871
文件夹: ..data_contrast/202310/
func get_unique_words_count() is called：去重词语的个数： 61809
文件夹: ..data_contrast/202311/
func get_unique_words_count() is called：去重词语的个数： 44607
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202307/"</span><span class="p">)</span>
<span class="n">word_remove_stopword_count_202307</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count_202307</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202308/"</span><span class="p">)</span>
<span class="n">word_remove_stopword_count_202308</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count_202308</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202309/"</span><span class="p">)</span>
<span class="n">word_remove_stopword_count_202309</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count_202309</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202310/"</span><span class="p">)</span>
<span class="n">word_remove_stopword_count_202310</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count_202310</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"文件夹: ..data_contrast/202311/"</span><span class="p">)</span>
<span class="n">word_remove_stopword_count_202311</span> <span class="o">=</span> <span class="n">word_count_remove_stopword</span><span class="p">(</span><span class="n">word_count_202311</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>文件夹: ..data_contrast/202307/
func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  71810
func get_unique_words_count() is called：去除单个字的唯一单词总数:  69256
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
文件夹: ..data_contrast/202308/
func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  73238
func get_unique_words_count() is called：去除单个字的唯一单词总数:  70658
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
文件夹: ..data_contrast/202309/
func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  65777
func get_unique_words_count() is called：去除单个字的唯一单词总数:  63386
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
文件夹: ..data_contrast/202310/
func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  60738
func get_unique_words_count() is called：去除单个字的唯一单词总数:  58387
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
文件夹: ..data_contrast/202311/
func get_unique_words_count() is called：统计停用词总数:  2320
func get_unique_words_count() is called：不带停用词的唯一单词总数:  43621
func get_unique_words_count() is called：去除单个字的唯一单词总数:  41732
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'2023年7月文章的词云图像'</span><span class="p">)</span>
<span class="n">draw_wordcloud</span><span class="p">(</span><span class="n">word_remove_stopword_count_202307</span><span class="p">)</span>
</code></pre></div></div> <h4 id="以07月top15的关键字为基准统计5个月的变化">以07月top15的关键字为基准，统计5个月的变化</h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">draw_word_frequency_distribution</span><span class="p">(</span><span class="n">word_remove_stopword_count_202307</span><span class="p">)</span>
<span class="n">draw_word_frequency_changes</span><span class="p">(</span><span class="n">word_remove_stopword_count_202307</span><span class="p">,</span> <span class="n">word_remove_stopword_count_202308</span><span class="p">,</span> <span class="n">word_remove_stopword_count_202309</span><span class="p">,</span> <span class="n">word_remove_stopword_count_202310</span><span class="p">,</span> <span class="n">word_remove_stopword_count_202311</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p><img src="https://blog.slienceme.cn/images/posts/output_14_0.png" alt="output_14_0" /></p> <p><img src="https://blog.slienceme.cn/images/posts/output_14_1.png" alt="output_14_1" /></p> <h3 id="2-各个省份出现频率分析">2. 各个省份出现频率分析</h3> <p><img src="https://blog.slienceme.cn/images/posts/QQ录屏20231201151917.gif" alt="QQ录屏20231201151917" /></p> <p>完整内容请见GitHub仓库 <strong>项目地址:</strong> <a href="https://github.com/slience-me/data_mining_wordcloud">https://github.com/slience-me/data_mining_wordcloud</a></p> <div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"> <h3>文档信息</h3> <ul> <li>本文作者：<a href="https://blog.slienceme.cn" target="_blank">slience_me</a></li> <li>本文链接：<a href="https://blog.slienceme.cn/2023/12/05/%E5%85%B3%E4%BA%8E%E8%BF%91%E6%9C%9F%E4%BA%BA%E6%B0%91%E6%97%A5%E6%8A%A5%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90/" target="_blank">https://blog.slienceme.cn/2023/12/05/%E5%85%B3%E4%BA%8E%E8%BF%91%E6%9C%9F%E4%BA%BA%E6%B0%91%E6%97%A5%E6%8A%A5%E6%96%87%E7%AB%A0%E7%9A%84%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90/</a></li> <li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li> </ul> </div> </article> <div class="share"> <div class="share-component" data-disabled='qq,facebook'></div> </div> <div class="comment"> <script src="https://giscus.app/client.js" data-repo="slience-me/blog-comments" data-repo-id="R_kgDOKr27jA" data-category="Announcements" data-category-id="DIC_kwDOKr27jM4CnWMe" data-mapping="title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async> </script> </div> </div> <div class="column one-fourth"> <h3>Search</h3> <div id="site_search"> <div id="docsearch"> <input style="width:96%" type="text" id="search_box" placeholder="Search"> </div> </div> <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script> <script type="text/javascript"> docsearch({ appId: "8W5T6R2WWG", apiKey: "e56e511c7c9f85e2c97e2817664aafb2", indexName: "doc", container: "#docsearch" }); </script> <h3 class="post-directory-title mobile-hidden">Table of Contents</h3> <div id="post-directory-module" class="mobile-hidden"> <section class="post-directory"> <dl></dl> </section> </div> <script src="https://blog.slienceme.cn/assets/js/jquery.toc.js"></script> </div> </div> </section> <footer class="container"> <div class="site-footer" role="contentinfo"> <div class="copyright left mobile-block"> <div style="display: flex;align-items: center;justify-content: center;"> <img src="/images/logo/logo.png" class="w-full" style="height: 10px;width: 10px;" alt="logo" />;"> <p> <a href="https://beian.mps.gov.cn/" rel="noreferrer" target="_blank">冀公网安备13102202000626</a> | <a href="https://beian.miit.gov.cn/" target="_blank" rel="noreferrer">津ICP备2024026565号-1</a> </p> </div> <p style="display: flex;align-items: center;justify-content: center;"> Copyright © 2019-present slience_me </p> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a> </div> <ul class="site-footer-links right mobile-hidden"> <li> <a href="javascript:window.scrollTo(0,0)" >TOP</a> </li> </ul> <br/> <script defer src="https://vercount.one/js"></script> <div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> 本站访问量<span id="busuanzi_value_site_pv"></span>次 </span> <span id="busuanzi_container_site_uv" style="display:none"> / 本站访客数<span id="busuanzi_value_site_uv"></span>人 </span> <span id="busuanzi_container_page_pv" style="display:none"> / 本页访问量<span id="busuanzi_value_page_pv"></span>次 / 统计始于2024-12-01 </span> </div> </div> </footer> <div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a> </div> <script src="https://blog.slienceme.cn/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="https://blog.slienceme.cn/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script> </body> </html>
