<!DOCTYPE html> <html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> <title>Java｜Response_Cookie&Session_JSP&EL&JSTL &mdash; Slience_me的博客</title> <link rel="stylesheet" href="https://slienceme.cn/assets/vendor/primer-css/css/primer.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/components/collection.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/components/repo-card.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/sections/repo-list.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/components/boxed-group.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/globals/common.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/globals/responsive.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/css/posts/index.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/vendor/octicons/octicons/octicons.css"> <link rel="stylesheet" href="https://mazhuang.org/rouge-themes/dist/github.css"> <link rel="stylesheet" href="https://slienceme.cn/assets/vendor/share.js/dist/css/share.min.css"> <link rel="canonical" href="https://slienceme.cn/2021/02/24/Response_Cookie&Session_JSP&EL&JSTL/"> <link rel="alternate" type="application/atom+xml" title="Slience_me的博客" href="https://slienceme.cn/feed.xml"> <link rel="shortcut icon" href="https://slienceme.cn/favicon.ico"> <meta property="og:title" content="Java｜Response_Cookie&Session_JSP&EL&JSTL"> <meta name="keywords" content="编程语言, Java"> <meta name="og:keywords" content="编程语言, Java"> <meta name="description" content="1. HTTP协议：1.1 请求消息：客户端发送给服务器端的数据 数据格式： 请求行 请求头 请求空行 请求体 "> <meta name="og:description" content="1. HTTP协议：1.1 请求消息：客户端发送给服务器端的数据 数据格式： 请求行 请求头 请求空行 请求体 "> <meta property="og:url" content="https://slienceme.cn/2021/02/24/Response_Cookie&Session_JSP&EL&JSTL/"> <meta property="og:site_name" content="Slience_me的博客"> <meta property="og:type" content="article"> <meta property="og:locale" content="zh_CN" /> <meta property="article:published_time" content="2021-02-24"> <meta name="google-site-verification" content="2feHjT1GNs1Yi2JQfOtdYx7d048naG_-cMwZaDAopIA" /> <script src="https://slienceme.cn/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="https://slienceme.cn/assets/js/main.js"></script> </head> <body class="" data-mz=""> <header class="site-header"> <div class="container"> <h1><a href="https://slienceme.cn/" title="Slience_me的博客"><span class="octicon octicon-mark-github"></span> Slience_me的博客</a></h1> <button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <nav class="site-header-nav" role="navigation"> <a href="https://slienceme.cn/" class="site-header-nav-item" target="" title="首页">首页</a> <a href="https://slienceme.cn/categories/" class="site-header-nav-item" target="" title="分类">分类</a> <a href="https://slienceme.cn/archives/" class="mobile-hidden site-header-nav-item" target="" title="归档">归档</a> <a href="https://slienceme.cn/open-source/" class="mobile-hidden site-header-nav-item" target="" title="开源">开源</a> <a href="https://slienceme.cn/fragments/" class="site-header-nav-item" target="" title="片段">片段</a> <a href="https://slienceme.cn/wiki/" class="site-header-nav-item" target="" title="维基">维基</a> <a href="https://slienceme.cn/links/" class="mobile-hidden site-header-nav-item" target="" title="链接">链接</a> <a href="https://slienceme.cn/about/" class="site-header-nav-item" target="" title="关于">关于</a> <a class="mobile-hidden" href="https://slienceme.cn/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a> </nav> </div> </header> <section class="collection-head small geopattern" data-pattern-id="Java｜Response_C"> <div class="container"> <div class="columns"> <div class="column three-fourths"> <div class="collection-title"> <h1 class="collection-header">Java｜Response_Cookie&Session_JSP&EL&JSTL</h1> <div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2021/02/24 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="https://slienceme.cn/categories/#Java" title="Java">Java</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> 共 34231 字，约 98 分钟 </span> </div> </div> </div> <div class="column one-fourth mobile-hidden"> <div class="collection-title"> </div> </div> </div> </div> </section> <section class="container content"> <div class="columns"> <div class="column three-fourths" > <article class="article-content markdown-body"> <h1 id="1-http协议">1. HTTP协议：</h1> <h2 id="11-请求消息客户端发送给服务器端的数据">1.1 请求消息：客户端发送给服务器端的数据</h2> <ul> <li>数据格式： <ol> <li>请求行</li> <li>请求头</li> <li>请求空行</li> <li>请求体</li> </ol> </li> </ul> <h2 id="12-响应消息服务器端发送给客户端的数据">1.2 响应消息：服务器端发送给客户端的数据</h2> <h3 id="121-数据格式">1.2.1 数据格式：</h3> <h4 id="1211-响应行">1.2.1.1 响应行</h4> <ol> <li>组成：协议/版本 响应状态码 状态码描述</li> <li>响应状态码：服务器告诉客户端浏览器本次请求和响应的一个状态。 <ol> <li>状态码都是<code class="language-plaintext highlighter-rouge">3位数字</code></li> <li>分类： <ol> <li><code class="language-plaintext highlighter-rouge">1xx</code>：服务器就收客户端消息，但没有接受完成，等待一段时间后，发送1xx多状态码</li> <li><code class="language-plaintext highlighter-rouge">2xx</code>：成功。代表：200</li> <li><code class="language-plaintext highlighter-rouge">3xx</code>：重定向。代表：302(重定向)，304(访问缓存)</li> <li> <p><code class="language-plaintext highlighter-rouge">4xx</code>：客户端错误。</p> <p><code class="language-plaintext highlighter-rouge">404</code>（请求路径没有对应的资源） <code class="language-plaintext highlighter-rouge">405</code>：请求方式没有对应的doXxx方法</p> </li> <li><code class="language-plaintext highlighter-rouge">5xx</code>：服务器端错误。代表：500(服务器内部出现异常)</li> </ol> </li> </ol> </li> </ol> <h4 id="1212-响应头">1.2.1.2 响应头：</h4> <ol> <li>格式：头名称： 值</li> <li>常见的响应头： <ol> <li><code class="language-plaintext highlighter-rouge">Content-Type</code>：服务器告诉客户端本次响应体<code class="language-plaintext highlighter-rouge">数据格式</code>以及<code class="language-plaintext highlighter-rouge">编码格式</code></li> <li><code class="language-plaintext highlighter-rouge">Content-disposition</code>：服务器告诉客户端以什么格式打开响应体数据 值： <code class="language-plaintext highlighter-rouge">in-line</code>:默认值,在当前页面内打开 <code class="language-plaintext highlighter-rouge">attachment;filename=xxx</code>：以附件形式打开响应体。文件下载 <h4 id="1213-响应空行">1.2.1.3 响应空行</h4> <h4 id="1214-响应体传输的数据">1.2.1.4 响应体:传输的数据</h4> <ul> <li>响应字符串格式</li> </ul> </li> </ol> </li> </ol> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/html;charset=UTF-8
Content-Length: 101
Date: Wed, 06 Jun 2018 07:08:42 GMT
	
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>$Title$<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  hello , response
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <h1 id="2-response对象">2. Response对象</h1> <h3 id="21功能设置响应消息">2.1功能：设置响应消息</h3> <ol> <li>设置响应行 <ul> <li>格式：<code class="language-plaintext highlighter-rouge">HTTP/1.1 200 ok</code></li> <li>设置状态码：<code class="language-plaintext highlighter-rouge">setStatus(int sc)</code></li> </ul> </li> <li>设置响应头：<code class="language-plaintext highlighter-rouge">setHeader(String name, String value)</code></li> <li>设置响应体： 使用步骤： <ol> <li>获取输出流 字符输出流：<code class="language-plaintext highlighter-rouge">PrintWriter getWriter()</code> 字节输出流：<code class="language-plaintext highlighter-rouge">ServletOutputStream getOutputStream()</code></li> <li>使用输出流，将数据输出到客户端浏览器</li> </ol> </li> </ol> <h3 id="22-案例">2.2 案例：</h3> <h4 id="221-完成重定向">2.2.1. 完成重定向</h4> <ul> <li>重定向：资源跳转的方式</li> </ul> <p>代码实现：</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//1. 设置状态码为302</span>
<span class="n">response</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="mi">302</span><span class="o">);</span>
<span class="c1">//2.设置响应头location</span>
<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"location"</span><span class="o">,</span><span class="s">"/day15/responseDemo2"</span><span class="o">);</span>
<span class="c1">//简单的重定向方法</span>
<span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">"/day15/responseDemo2"</span><span class="o">);</span>
</code></pre></div></div> <ul> <li>重定向的特点:<code class="language-plaintext highlighter-rouge">redirect</code> <ol> <li>地址栏发生变化</li> <li>重定向可以访问其他站点(服务器)的资源</li> <li>重定向是两次请求。不能使用<code class="language-plaintext highlighter-rouge">request</code>对象来共享数据</li> </ol> </li> <li>转发的特点：<code class="language-plaintext highlighter-rouge">forward</code> <ol> <li>转发地址栏路径不变</li> <li>转发只能访问当前服务器下的资源</li> <li>转发是一次请求，可以使用<code class="language-plaintext highlighter-rouge">request</code>对象来共享数据</li> </ol> </li> <li> <p><code class="language-plaintext highlighter-rouge">forward</code> 和 <code class="language-plaintext highlighter-rouge">redirect</code> 区别</p> </li> <li> <p>路径写法：</p> <p>路径分类</p> <ol> <li><code class="language-plaintext highlighter-rouge">相对路径</code>：通过相对路径不可以确定唯一资源 <ul> <li>如：<code class="language-plaintext highlighter-rouge">./index.html</code></li> <li>不以<code class="language-plaintext highlighter-rouge">/</code>开头，以.开头路径</li> <li>规则：找到当前资源和目标资源之间的相对位置关系 <code class="language-plaintext highlighter-rouge">./</code>：当前目录 <code class="language-plaintext highlighter-rouge">../</code>:后退一级目录</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">绝对路径</code>：通过绝对路径可以确定唯一资源 <ul> <li>如：<code class="language-plaintext highlighter-rouge">http://localhost/day15/responseDemo2 /day15/responseDemo2</code></li> <li> <p>以<code class="language-plaintext highlighter-rouge">/</code>开头的路径</p> </li> <li>规则：判断定义的路径是给谁用的？判断请求将来从哪儿发出 <ul> <li>给客户端浏览器使用：<code class="language-plaintext highlighter-rouge">需要加虚拟目录(项目的访问路径)</code> 建议虚拟目录动态获取：<code class="language-plaintext highlighter-rouge">request.getContextPath()</code> <code class="language-plaintext highlighter-rouge">&lt;a&gt; , &lt;form&gt; 重定向...</code></li> <li>给服务器使用：<code class="language-plaintext highlighter-rouge">不需要加虚拟目录</code> <code class="language-plaintext highlighter-rouge">转发路径</code></li> </ul> </li> </ul> </li> </ol> </li> </ul> <h4 id="222-服务器输出字符数据到浏览器">2.2.2 服务器输出字符数据到浏览器</h4> <h5 id="步骤">步骤：</h5> <ol> <li>获取字符输出流</li> <li>输出数据</li> </ol> <h5 id="注意">注意：</h5> <ul> <li>乱码问题： <ol> <li><code class="language-plaintext highlighter-rouge">PrintWriter pw = response.getWriter()</code>;获取的流的默认编码是<code class="language-plaintext highlighter-rouge">ISO-8859-1</code></li> <li>设置该流的<code class="language-plaintext highlighter-rouge">默认编码</code></li> <li>告诉浏览器响应体使用的编码</li> </ol> </li> <li>简单的形式，设置编码，是在获取流之前设置 <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
</code></pre></div> </div> </li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/responseDemo4"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResponseDemo4</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">req</span><span class="o">,</span><span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">// 获取流对象之前，设置六的默认编码，ISO-8859-1 设置为：GBK</span>
<span class="c1">//        resp.setCharacterEncoding("utf-8");</span>

        <span class="c1">// 设置编码 告诉浏览器，服务器发送的消息体数据的彪马。建议浏览器使用该编码</span>
<span class="c1">//        resp.setHeader("content-type","text/html;charset=utf-8");</span>

        <span class="c1">//简单的形式设置编码</span>
        <span class="n">resp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>

        <span class="c1">// 1.获取字符输出流</span>
        <span class="nc">PrintWriter</span> <span class="n">pw</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
        <span class="c1">// 2.输出数据</span>
<span class="c1">//        pw.write("&lt;h1&gt;hello,response&lt;h1&gt;");</span>
        <span class="n">pw</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="s">"你好！"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="223-服务器输出字节数据到浏览器">2.2.3 服务器输出字节数据到浏览器</h4> <p>步骤：</p> <ol> <li>获取字节输出流</li> <li>输出数据</li> </ol> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/responseDemo5"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResponseDemo5</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">req</span><span class="o">,</span><span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="n">resp</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
        <span class="c1">// 1.获取字符输出流</span>
        <span class="nc">ServletOutputStream</span> <span class="n">sos</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
        <span class="c1">// 2.输出数据</span>
        <span class="n">sos</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="s">"你好"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="224-验证码">2.2.4 验证码</h4> <ol> <li>本质：图片</li> <li>目的：防止恶意表单注册</li> </ol> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/checkCodeServlet"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CheckCodeServlet</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">req</span><span class="o">,</span><span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="kt">int</span> <span class="n">wigth</span> <span class="o">=</span> <span class="mi">100</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">50</span><span class="o">;</span>
        <span class="c1">//1.创建一对象，在内存中图片（验证码图片对象）</span>
        <span class="nc">BufferedImage</span> <span class="n">image</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedImage</span><span class="o">(</span><span class="n">wigth</span><span class="o">,</span><span class="n">height</span><span class="o">,</span><span class="nc">BufferedImage</span><span class="o">.</span><span class="na">TYPE_INT_RGB</span><span class="o">);</span>
        <span class="c1">//2.美化图片</span>

        <span class="c1">//2.1 填充背景色</span>
        <span class="nc">Graphics</span> <span class="n">g</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="na">getGraphics</span><span class="o">();</span> <span class="c1">//画笔对象</span>
        <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">PINK</span><span class="o">);</span><span class="c1">//设置画笔颜色</span>
        <span class="n">g</span><span class="o">.</span><span class="na">fillRect</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">wigth</span><span class="o">,</span><span class="n">height</span><span class="o">);</span>

        <span class="c1">//2.2 画边框</span>
        <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">BLUE</span><span class="o">);</span>
        <span class="n">g</span><span class="o">.</span><span class="na">drawRect</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">wigth</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"</span><span class="o">;</span>

        <span class="c1">//生成随机角标</span>
        <span class="nc">Random</span> <span class="n">ran</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">();</span>


        <span class="c1">//2.3 写验证码</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">ran</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
            <span class="c1">//获取字符</span>
            <span class="kt">char</span> <span class="n">ch</span> <span class="o">=</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
            <span class="n">g</span><span class="o">.</span><span class="na">drawString</span><span class="o">(</span><span class="n">ch</span><span class="o">+</span><span class="s">""</span><span class="o">,</span> <span class="n">wigth</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="o">,</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//2.4 画干扰线</span>
        <span class="n">g</span><span class="o">.</span><span class="na">setColor</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">GREEN</span><span class="o">);</span>

        <span class="c1">//随机生成坐标点</span>


        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">ran</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">wigth</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">ran</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">wigth</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ran</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">height</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">ran</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">height</span><span class="o">);</span>
            <span class="n">g</span><span class="o">.</span><span class="na">drawLine</span><span class="o">(</span><span class="n">x1</span><span class="o">,</span><span class="n">y1</span><span class="o">,</span><span class="n">x2</span><span class="o">,</span><span class="n">y2</span><span class="o">);</span>
        <span class="o">}</span>


        <span class="c1">//3.将图片输入到图片展示</span>
        <span class="nc">ImageIO</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">image</span><span class="o">,</span><span class="s">"jpg"</span><span class="o">,</span><span class="n">resp</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Title<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script&gt;</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
        <span class="c1">// 1. 获取图片对象</span>
        <span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">checkCode</span><span class="dl">"</span><span class="p">);</span>
        <span class="c1">//2.绑定单击事件</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
            <span class="c1">//加时间戳</span>
            <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span>
            <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/day15/checkCodeServlet?</span><span class="dl">"</span><span class="o">+</span><span class="nx">date</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// 1. 获取图片对象</span>
        <span class="kd">var</span> <span class="nx">cha</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">change</span><span class="dl">"</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">imga</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">checkCode</span><span class="dl">"</span><span class="p">);</span>
        <span class="c1">//2.绑定单击事件</span>
        <span class="nx">cha</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
            <span class="c1">//加时间戳</span>
            <span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">();</span>
            <span class="nx">imga</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/day15/checkCodeServlet?</span><span class="dl">"</span><span class="o">+</span><span class="nx">date</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">id=</span><span class="s">"checkCode"</span> <span class="na">src=</span><span class="s">"/day15/checkCodeServlet"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">id=</span><span class="s">"change"</span> <span class="na">href=</span><span class="s">"javascript:void(0);"</span> <span class="nt">&gt;</span>看不清换一张<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <h1 id="3-servletcontext对象">3. ServletContext对象：</h1> <h2 id="1-概念">1. 概念：</h2> <ul> <li>代表整个<code class="language-plaintext highlighter-rouge">web</code>应用，可以和程序的容器(服务器)来通信 <h2 id="2-获取">2. 获取：</h2> <ol> <li>通过<code class="language-plaintext highlighter-rouge">request</code>对象获取 <code class="language-plaintext highlighter-rouge">request.getServletContext();</code></li> <li>通过<code class="language-plaintext highlighter-rouge">HttpServlet</code>获取 <code class="language-plaintext highlighter-rouge">this.getServletContext();</code> <h2 id="3-功能">3. 功能：</h2> </li> <li>获取<code class="language-plaintext highlighter-rouge">MIME</code>类型：</li> </ol> <ul> <li><code class="language-plaintext highlighter-rouge">MIME</code>类型:在互联网通信过程中定义的一种文件数据类型 格式： <code class="language-plaintext highlighter-rouge">大类型/小类型 text/html image/jpeg</code></li> <li>获取：<code class="language-plaintext highlighter-rouge">String getMimeType(String file)</code> <ol> <li>域对象：共享数据 1. <code class="language-plaintext highlighter-rouge">setAttribute(String name,Object value)</code> 2. <code class="language-plaintext highlighter-rouge">getAttribute(String name)</code> 3. <code class="language-plaintext highlighter-rouge">removeAttribute(String name)</code> <code class="language-plaintext highlighter-rouge">ServletContext</code>对象范围：所有用户所有请求的数据</li> <li>获取文件的真实(服务器)路径 1. 方法：<code class="language-plaintext highlighter-rouge">String getRealPath(String path)</code></li> </ol> </li> </ul> </li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">b</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/b.txt"</span><span class="o">);</span><span class="c1">//web目录下资源访问</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">b</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">c</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/WEB-INF/c.txt"</span><span class="o">);</span><span class="c1">//WEB-INF目录下的资源访问</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">a</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/WEB-INF/classes/a.txt"</span><span class="o">);</span><span class="c1">//src目录下的资源访问</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/servletcontentdemo1"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServletContentDemo1</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">req</span><span class="o">,</span><span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//1.通过request对象获取</span>
        <span class="nc">ServletContext</span> <span class="n">context1</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
        <span class="c1">//2.通过HttpServlet获取</span>
        <span class="nc">ServletContext</span> <span class="n">context2</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">context1</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">context2</span><span class="o">);</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">context1</span> <span class="o">==</span> <span class="n">context2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/servletcontentdemo2"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServletContentDemo2</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">req</span><span class="o">,</span><span class="n">resp</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="c1">//2.通过HttpServlet获取</span>
        <span class="nc">ServletContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>

        <span class="c1">//3. 定义文件名称</span>
        <span class="nc">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">"a.jpg"</span><span class="o">;</span>

        <span class="c1">//4.获取MIME类型</span>
        <span class="nc">String</span> <span class="n">mimeType</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getMimeType</span><span class="o">(</span><span class="n">filename</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mimeType</span><span class="o">);</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h1 id="4-案例">4. 案例：</h1> <ul> <li>文件下载需求： <ol> <li>页面显示超链接</li> <li>点击超链接后弹出下载提示框</li> <li>完成图片文件下载</li> </ol> </li> <li>分析： <ol> <li>超链接指向的资源如果能够被浏览器解析，则在浏览器中展示，如果不能解析，则弹出下载提示框。不满足需求</li> <li>任何资源都必须弹出下载提示框</li> <li>使用响应头设置资源的打开方式： <ul> <li><code class="language-plaintext highlighter-rouge">content-disposition:attachment;filename=xxx</code></li> </ul> </li> </ol> </li> <li>步骤： <ol> <li>定义页面，编辑超链接<code class="language-plaintext highlighter-rouge">href</code>属性，指向Servlet，传递资源名称<code class="language-plaintext highlighter-rouge">filename</code></li> <li>定义<code class="language-plaintext highlighter-rouge">Servlet</code> <ol> <li>获取文件名称</li> <li>使用字节输入流加载文件进内存</li> <li>指定<code class="language-plaintext highlighter-rouge">response</code>的响应头： <code class="language-plaintext highlighter-rouge">content-disposition:attachment;filename=xxx</code></li> <li>将数据写出到<code class="language-plaintext highlighter-rouge">response</code>输出流</li> </ol> </li> </ol> </li> <li>问题： <ul> <li>中文文件问题 <ul> <li>解决思路： <ol> <li>获取客户端使用的浏览器版本信息</li> <li>根据不同的版本信息，设置<code class="language-plaintext highlighter-rouge">filename</code>的编码方式不同</li> </ol> </li> </ul> </li> </ul> </li> </ul> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Title<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/day15/img/1.jpg"</span><span class="nt">&gt;</span>图片1<span class="nt">&lt;/a&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/day15/img/1.avi"</span><span class="nt">&gt;</span>视频<span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;hr&gt;</span>


    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/day15/downloadServlet?filename=九尾.jpg"</span><span class="nt">&gt;</span>图片1<span class="nt">&lt;/a&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/day15/downloadServlet?filename=1.avi"</span><span class="nt">&gt;</span>视频<span class="nt">&lt;/a&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/downloadServlet"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DownloadServlet</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//1.获取请求参数，文件名称</span>
        <span class="nc">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"filename"</span><span class="o">);</span>
        <span class="c1">//2.使用字节输入流加载文件进内存</span>
        <span class="c1">//2.1找到文件服务器路径</span>
        <span class="nc">ServletContext</span> <span class="n">servletContext</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">realPath</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/img/"</span> <span class="o">+</span> <span class="n">filename</span><span class="o">);</span>
        <span class="c1">//2.2用字节流关联</span>
        <span class="nc">FileInputStream</span> <span class="n">fis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">realPath</span><span class="o">);</span>

        <span class="c1">//3.设置response的响应头</span>
        <span class="c1">//3.1设置响应头类型：content-type</span>
        <span class="nc">String</span> <span class="n">mimeType</span> <span class="o">=</span> <span class="n">servletContext</span><span class="o">.</span><span class="na">getMimeType</span><span class="o">(</span><span class="n">filename</span><span class="o">);</span><span class="c1">//获取文件的mime类型</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"content-type"</span><span class="o">,</span><span class="n">mimeType</span><span class="o">);</span>
        <span class="c1">//3.2设置响应头打开方式:content-disposition</span>

        <span class="c1">//解决中文文件名问题</span>
        <span class="c1">//1.获取user-agent请求头、</span>
        <span class="nc">String</span> <span class="n">agent</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="s">"user-agent"</span><span class="o">);</span>
        <span class="c1">//2.使用工具类方法编码文件名即可</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="nc">DownLoadUtils</span><span class="o">.</span><span class="na">getFileName</span><span class="o">(</span><span class="n">agent</span><span class="o">,</span> <span class="n">filename</span><span class="o">);</span>

        <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"content-disposition"</span><span class="o">,</span><span class="s">"attachment;filename="</span><span class="o">+</span><span class="n">filename</span><span class="o">);</span>
        <span class="c1">//4.将输入流的数据写出到输出流中</span>
        <span class="nc">ServletOutputStream</span> <span class="n">sos</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buff</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">8</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">while</span><span class="o">((</span><span class="n">len</span> <span class="o">=</span> <span class="n">fis</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buff</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">){</span>
            <span class="n">sos</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buff</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="n">len</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">fis</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>


    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <p><strong>注意：</strong> 这个可能不能用，因为，<a href="https://www.cnblogs.com/moonsoft/p/12300001.html">click</a></p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sun.misc.BASE64Encoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLEncoder</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DownLoadUtils</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getFileName</span><span class="o">(</span><span class="nc">String</span> <span class="n">agent</span><span class="o">,</span> <span class="nc">String</span> <span class="n">filename</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">UnsupportedEncodingException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">agent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"MSIE"</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// IE浏览器</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">filename</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">);</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"+"</span><span class="o">,</span> <span class="s">" "</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">agent</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"Firefox"</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// 火狐浏览器</span>
            <span class="nc">BASE64Encoder</span> <span class="n">base64Encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BASE64Encoder</span><span class="o">();</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s">"=?utf-8?B?"</span> <span class="o">+</span> <span class="n">base64Encoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">filename</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">))</span> <span class="o">+</span> <span class="s">"?="</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="c1">// 其它浏览器</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">filename</span><span class="o">,</span> <span class="s">"utf-8"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">filename</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h1>—————————————————————————–</h1> <h1 id="5-cookiesession">5. Cookie&amp;Session</h1> <h2 id="51">5.1</h2> <ul> <li>他们是一种会话技术 <h3 id="什么是会话">什么是会话？</h3> </li> <li>在一次会话过程中包含多次的请求和响应。</li> <li>一次会话就是浏览器第一次给服务器资源发送请求，会话开始建立，直到有一方断开为止 <h3 id="有什么功能">有什么功能？</h3> </li> <li>在一次会话的范围内的多次请求间，共享数据 <h3 id="有什么区别对于他们的方式">有什么区别对于他们的方式？</h3> <ol> <li><code class="language-plaintext highlighter-rouge">Cookie</code>是客户端的会话技术：</li> <li><code class="language-plaintext highlighter-rouge">Session</code>是服务器端的会话技术：</li> </ol> </li> </ul> <h2 id="52-cookie">5.2 Cookie</h2> <ul> <li>客户端的会话技术，cookie将数据信息保存到客户端中</li> </ul> <ol> <li>首先来创建<code class="language-plaintext highlighter-rouge">Cookie</code>对象，然后绑定相关数据 <code class="language-plaintext highlighter-rouge">new Cookie(String name, String value)</code></li> <li>进而发送<code class="language-plaintext highlighter-rouge">Cookie</code>对象 <code class="language-plaintext highlighter-rouge">response.addCookie(Cookie cookie)</code></li> <li>最后获取得<code class="language-plaintext highlighter-rouge">Cookie</code>，然后拿到数据 <code class="language-plaintext highlighter-rouge">Cookie[] request.getCookies()</code></li> </ol> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CookieDemo1"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/CookieDemo1"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieDemo1</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//1. 创建Cookie对象</span>
        <span class="nc">Cookie</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span> <span class="s">"hello"</span><span class="o">);</span>
        <span class="c1">//2. 发送Cookie</span>
        <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CookieDemo2"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/CookieDemo2"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieDemo2</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//3. 获取Cookie</span>
        <span class="nc">Cookie</span><span class="o">[]</span> <span class="n">cs</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getCookies</span><span class="o">();</span>
        <span class="c1">// 获取数据，遍历Cookies</span>
        <span class="k">if</span><span class="o">(</span><span class="n">cs</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Cookie</span> <span class="n">c</span> <span class="o">:</span> <span class="n">cs</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
                <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">+</span><span class="s">":"</span><span class="o">+</span><span class="n">value</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <ul> <li>他是基于响应头<code class="language-plaintext highlighter-rouge">set-cookie</code>和请求头<code class="language-plaintext highlighter-rouge">cookie</code>的前提来实现的</li> </ul> <h3 id="注意-1">注意：</h3> <h4 id="1-可以单次多条cookie">1. 可以单次多条cookie</h4> <ul> <li>同时创建多个<code class="language-plaintext highlighter-rouge">Cookie</code>对象，利用<code class="language-plaintext highlighter-rouge">response</code>调用多次<code class="language-plaintext highlighter-rouge">addCookie</code>方法发送<code class="language-plaintext highlighter-rouge">cookie</code>可达到可以单次多条cookie的目的。</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"CookieDemo3"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"/CookieDemo3"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieDemo3</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//1. 创建Cookie对象</span>
        <span class="nc">Cookie</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span> <span class="s">"hello"</span><span class="o">);</span>
        <span class="nc">Cookie</span> <span class="n">c2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"zhangsan"</span><span class="o">);</span>
        <span class="c1">//2. 发送Cookie</span>
        <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="2-浏览器存储的cookie时间">2. 浏览器存储的cookie时间</h4> <ol> <li>默认<code class="language-plaintext highlighter-rouge">Cookie</code>数据被销毁在浏览器关闭时</li> <li>为了持久化存储cookie数据： <ul> <li><code class="language-plaintext highlighter-rouge">setMaxAge(int seconds)</code></li> </ul> <ol> <li>正数：指定<code class="language-plaintext highlighter-rouge">cookie</code>存活时间，到期失效</li> <li>负数：默认值</li> <li>零：删除<code class="language-plaintext highlighter-rouge">cookie</code>信息 <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/cookieDemo4"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieDemo4</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
 <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
 <span class="c1">//1.创建Cookie对象</span>
 <span class="nc">Cookie</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span><span class="s">"setMaxAge"</span><span class="o">);</span>
 <span class="c1">//2.设置cookie的存活时间</span>
 <span class="c1">//c1.setMaxAge(30);//将cookie持久化到硬盘，30秒后会自动删除cookie文件</span>
 <span class="c1">//c1.setMaxAge(-1);</span>
 <span class="c1">//c1.setMaxAge(300);</span>
 <span class="n">c1</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span><span class="c1">//删除Cookie</span>
 <span class="c1">//3.发送Cookie</span>
 <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
 <span class="o">}</span>
 <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
 <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div> </div> </li> </ol> </li> </ol> <h4 id="3-cookie是否可以存储中文">3. cookie是否可以存储中文</h4> <ul> <li>在<code class="language-plaintext highlighter-rouge">tomcat 8</code>版本之前需要将中文数据转码—一般采用<code class="language-plaintext highlighter-rouge">URL编码(%E3)</code></li> <li>在<code class="language-plaintext highlighter-rouge">tomcat 8</code> 版本之后，支持中文数据。不支持<code class="language-plaintext highlighter-rouge">特殊字符</code>， 可以<code class="language-plaintext highlighter-rouge">URL编码</code>存储，<code class="language-plaintext highlighter-rouge">URL解码</code>解析</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/cookieDemo5"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieDemo5</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//1.创建Cookie对象</span>
        <span class="nc">Cookie</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span><span class="s">"你好"</span><span class="o">);</span>
        <span class="c1">//设置path，让当前服务器下部署的所有项目共享Cookie信息</span>
        <span class="n">c1</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span><span class="s">"/"</span><span class="o">);</span>
        <span class="c1">//3.发送Cookie</span>
        <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="4-cookie共享问题">4. cookie共享问题</h4> <ol> <li> <p>同<code class="language-plaintext highlighter-rouge">tomcat</code>服务器，部署多个web项目默认情况下<code class="language-plaintext highlighter-rouge">cookie</code>不能共享 <code class="language-plaintext highlighter-rouge">setPath(String path)</code>:设置<code class="language-plaintext highlighter-rouge">cookie</code>的获取的范围。 默认情况下，设置当前的<code class="language-plaintext highlighter-rouge">虚拟目录</code> * 如果想要共享，则可以将<code class="language-plaintext highlighter-rouge">path</code>设置为”<code class="language-plaintext highlighter-rouge">/</code>”</p> </li> <li> <p>不同的<code class="language-plaintext highlighter-rouge">tomcat</code>服务器间<code class="language-plaintext highlighter-rouge">cookie</code>如何共享？ <code class="language-plaintext highlighter-rouge">setDomain(String path)</code>: 设置一级域名相同，则多个服务器之间<code class="language-plaintext highlighter-rouge">cookie</code>可以共享 <code class="language-plaintext highlighter-rouge">setDomain(".baidu.com")</code>,那么<code class="language-plaintext highlighter-rouge">tieba.baidu.com</code>和<code class="language-plaintext highlighter-rouge">news.baidu.com</code>中<code class="language-plaintext highlighter-rouge">cookie</code>可以共享</p> </li> </ol> <h4 id="5-主要特点与作用">5. 主要特点与作用</h4> <ol> <li><code class="language-plaintext highlighter-rouge">cookie</code>客户端浏览器中存储数据</li> <li>单个<code class="language-plaintext highlighter-rouge">cookie</code> 的大小限制(4kb)</li> <li>同一个域名下的总<code class="language-plaintext highlighter-rouge">cookie</code>数量限制(20个)</li> </ol> <ul> <li>作用： <ol> <li><code class="language-plaintext highlighter-rouge">cookie</code> 用于存储少量的较为不敏感的数据</li> <li>在不登录的条件下，来完成服务器对客户端的身份识别认证</li> </ol> </li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.cookie</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/cookieTest"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CookieTest</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//设置响应的消息体的数据格式以及编码</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
        <span class="c1">//1.获取所有Cookie</span>
        <span class="nc">Cookie</span><span class="o">[]</span> <span class="n">cookies</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getCookies</span><span class="o">();</span>
        <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span><span class="c1">//没有cookie为lastTime</span>
        <span class="c1">//2.遍历cookie数组</span>
        <span class="k">if</span><span class="o">(</span><span class="n">cookies</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">cookies</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">){</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Cookie</span> <span class="n">cookie</span> <span class="o">:</span> <span class="n">cookies</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//3.获取cookie的名称</span>
                <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">cookie</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
                <span class="c1">//4.判断名称是否是：lastTime</span>
                <span class="k">if</span><span class="o">(</span><span class="s">"lastTime"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">name</span><span class="o">)){</span>
                    <span class="c1">//有该Cookie，不是第一次访问</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span><span class="c1">//有lastTime的cookie</span>
                    <span class="c1">//设置Cookie的value</span>
                    <span class="c1">//获取当前时间的字符串，重新设置Cookie的值，重新发送cookie</span>
                    <span class="nc">Date</span> <span class="n">date</span>  <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
                    <span class="nc">SimpleDateFormat</span> <span class="n">sdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy年MM月dd日 HH:mm:ss"</span><span class="o">);</span>
                    <span class="nc">String</span> <span class="n">str_date</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"编码前："</span><span class="o">+</span><span class="n">str_date</span><span class="o">);</span>
                    <span class="c1">//URL编码</span>
                    <span class="n">str_date</span> <span class="o">=</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">str_date</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"编码后："</span><span class="o">+</span><span class="n">str_date</span><span class="o">);</span>
                    <span class="n">cookie</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">str_date</span><span class="o">);</span>
                    <span class="c1">//设置cookie的存活时间</span>
                    <span class="n">cookie</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">30</span><span class="o">);</span><span class="c1">//一个月</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span>
                    <span class="c1">//响应数据</span>
                    <span class="c1">//获取Cookie的value，时间</span>
                    <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">cookie</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"解码前："</span><span class="o">+</span><span class="n">value</span><span class="o">);</span>
                    <span class="c1">//URL解码：</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nc">URLDecoder</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">value</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">);</span>
                    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"解码后："</span><span class="o">+</span><span class="n">value</span><span class="o">);</span>
                    <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="s">"&lt;h1&gt;欢迎回来，您上次访问时间为:"</span><span class="o">+</span><span class="n">value</span><span class="o">+</span><span class="s">"&lt;/h1&gt;"</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>

                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">cookies</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">cookies</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">flag</span> <span class="o">==</span> <span class="kc">false</span><span class="o">){</span>
            <span class="c1">//没有，第一次访问</span>
            <span class="c1">//设置Cookie的value</span>
            <span class="c1">//获取当前时间的字符串，重新设置Cookie的值，重新发送cookie</span>
            <span class="nc">Date</span> <span class="n">date</span>  <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
            <span class="nc">SimpleDateFormat</span> <span class="n">sdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy年MM月dd日 HH:mm:ss"</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">str_date</span> <span class="o">=</span> <span class="n">sdf</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"编码前："</span><span class="o">+</span><span class="n">str_date</span><span class="o">);</span>
            <span class="c1">//URL编码</span>
            <span class="n">str_date</span> <span class="o">=</span> <span class="nc">URLEncoder</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">str_date</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"编码后："</span><span class="o">+</span><span class="n">str_date</span><span class="o">);</span>

            <span class="nc">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cookie</span><span class="o">(</span><span class="s">"lastTime"</span><span class="o">,</span><span class="n">str_date</span><span class="o">);</span>
            <span class="c1">//设置cookie的存活时间</span>
            <span class="n">cookie</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">30</span><span class="o">);</span><span class="c1">//一个月</span>
            <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span>
            <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="s">"&lt;h1&gt;您好，欢迎您首次访问&lt;/h1&gt;"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div> <h2 id="53-session翻译为主菜">5.3 Session：翻译为（主菜）</h2> <ul> <li>数据将保存在服务器端的对象中。<code class="language-plaintext highlighter-rouge">HttpSession</code></li> </ul> <ol> <li>获取<code class="language-plaintext highlighter-rouge">HttpSession</code>对象： <code class="language-plaintext highlighter-rouge">HttpSession session = request.getSession();</code></li> <li>使用<code class="language-plaintext highlighter-rouge">HttpSession</code>对象： <code class="language-plaintext highlighter-rouge">Object getAttribute(String name)</code><br /> <code class="language-plaintext highlighter-rouge">void setAttribute(String name, Object value)</code> <code class="language-plaintext highlighter-rouge">void removeAttribute(String name)</code></li> </ol> <ul> <li><code class="language-plaintext highlighter-rouge">Session</code>依赖于<code class="language-plaintext highlighter-rouge">Cookie</code>的。 <img src="https://slienceme.cn/images/posts/20210322131449444.png" alt="Alt Text" /></li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.session</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/sessionDemo1"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SessionDemo1</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//使用session共享数据</span>
        <span class="c1">//1.获取session</span>
        <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
        <span class="c1">//2.存储数据</span>
        <span class="n">session</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span><span class="s">"hello session"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.session</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/sessionDemo2"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SessionDemo2</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">//使用session获取数据</span>
        <span class="c1">//1.获取session</span>
        <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
        <span class="c1">//2.获取数据</span>
        <span class="nc">Object</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"msg"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="注意-2">注意：</h3> <h4 id="1-客户端关闭服务器不关闭session不是同一个">1. 客户端关闭服务器不关闭，session不是同一个</h4> <blockquote> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>如果客户端关闭，服务器不关闭，那么两次获取session默认情况不是同一个  但是如果需要相同，则可创建`Cookie`,键为`JSESSIONID`，而且设置最大的存活时间日期，让`cookie`来持久化保存。 ```java Cookie c = new Cookie("JSESSIONID",session.getId()); c.setMaxAge(60*60); response.addCookie(c); ``` ```java package xyz.slienceme.session; @WebServlet("/sessionDemo3") public class SessionDemo3 extends HttpServlet {
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    //1.获取session
    HttpSession session = request.getSession();
    System.out.println(session);
    //期望客户端关闭后，session也能相同
    Cookie c = new Cookie("JSESSIONID",session.getId());
    c.setMaxAge(60*60);
    response.addCookie(c);
}
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    this.doPost(request, response);
} } ``` ![Alt Text](/images/posts/20210322132513871.png)
</code></pre></div> </div> </blockquote> <h4 id="2-客户端不关闭服务器关闭session不同一个">2. 客户端不关闭服务器关闭，session不同一个</h4> <blockquote> <p>如果客户端不关闭，服务器关闭，两次获取的session不是同一个，但是如果要确保数据不丢失损失。 <code class="language-plaintext highlighter-rouge">tomcat</code>自动完成以下工作</p> <ul> <li><code class="language-plaintext highlighter-rouge">session</code>的钝化： <ul> <li>在服务器正常关闭之前，将<code class="language-plaintext highlighter-rouge">session</code>对象序列化到电脑的硬盘上</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">session</code>的活化： <ul> <li>在服务器启动后，将<code class="language-plaintext highlighter-rouge">session文件</code>转化为电脑内存中的<code class="language-plaintext highlighter-rouge">session</code>对象。</li> </ul> </li> </ul> </blockquote> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">xyz.slienceme.session</span><span class="o">;</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/sessionDemo4"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SessionDemo4</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>

        <span class="c1">//1.获取session</span>
        <span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h4 id="3-失效时间">3. 失效时间</h4> <blockquote> <p>session失效时间有：</p> <ol> <li>当服务器关闭时候</li> <li>当<code class="language-plaintext highlighter-rouge">session</code>对象调用<code class="language-plaintext highlighter-rouge">invalidate()</code>方法时 。</li> <li>而且<code class="language-plaintext highlighter-rouge">session</code>默认失效时间 <code class="language-plaintext highlighter-rouge">30分钟</code> 我们可以选择性配置修改 ```xml</li> </ol> </blockquote> <session-config> <session-timeout>你想要的时间</session-timeout> </session-config> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#### 4. 主要特点
&gt;  session有什么特点呢？
&gt;  1. 注意`session` 主要用于存储一次会话的多次请求的数据，而且`存在服务器端`
&gt;  2. 注意`session`可以存储`任意类型`的数据，或者是`任意大小`的数据
#### 5. 差异不同
&gt; 对于`session`与`Cookie`的差异与不同：
&gt; 	1. `session`数据放在服务器端存储，`Cookie`数据在客户端存储
&gt; 	2. `session`无数据大小的限制，`Cookie`有数据大小的限制
&gt; 	3. `session`数据更安全，`Cookie`相对而言不安全


## 案例：验证码
1. 案例需求：
	1. 访问带有验证码的登录页面login.jsp
	2. 用户输入用户名，密码以及验证码。
		* 如果用户名和密码输入有误，跳转登录页面，提示:用户名或密码错误
		* 如果验证码输入有误，跳转登录页面，提示：验证码错误
		* 如果全部输入正确，则跳转到主页success.jsp，显示：用户名,欢迎您


2. 分析：
- 1.login.jsp
```java
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;login&lt;/title&gt;
    &lt;script&gt;
        window.onload = function(){
            document.getElementById("img").onclick = function(){
                this.src="/c/checkCodeServlet?time="+new Date().getTime();
            }
        }
    &lt;/script&gt;
    &lt;style&gt;
        div{
            color: red;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="/c/loginServlet" method="post"&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td&gt;用户名&lt;/td&gt;
                &lt;td&gt;&lt;input type="text" name="username"&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;密码&lt;/td&gt;
                &lt;td&gt;&lt;input type="password" name="password"&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;验证码&lt;/td&gt;
                &lt;td&gt;&lt;input type="text" name="checkCode"&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td colspan="2"&gt;&lt;img id="img" src="/c/checkCodeServlet"&gt;&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td colspan="2"&gt;&lt;input type="submit" value="登录"&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form&gt;
    &lt;div&gt;&lt;%=request.getAttribute("cc_error") == null ? "" : request.getAttribute("cc_error")%&gt;&lt;/div&gt;
    &lt;div&gt;&lt;%=request.getAttribute("login_error") == null ? "" : request.getAttribute("login_error") %&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div> <ol> <li>生成验证码函数 ```java package xyz.slienceme.servlet; import javax.imageio.ImageIO; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import java.awt.*; import java.awt.image.BufferedImage; import java.io.IOException; import java.util.Random;</li> </ol> <p>@WebServlet(“/checkCodeServlet”) public class CheckCodeServlet extends HttpServlet { protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    int width = 100;
    int height = 50;

    //1.创建一对象，在内存中图片(验证码图片对象)
    BufferedImage image = new BufferedImage(width,height,BufferedImage.TYPE_INT_RGB);


    //2.美化图片
    //2.1 填充背景色
    Graphics g = image.getGraphics();//画笔对象
    g.setColor(Color.PINK);//设置画笔颜色
    g.fillRect(0,0,width,height);

    //2.2画边框
    g.setColor(Color.BLUE);
    g.drawRect(0,0,width - 1,height - 1);

    String str = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789";
    //生成随机角标
    Random ran = new Random();
    StringBuilder sb = new StringBuilder();
    for (int i = 1; i &lt;= 4; i++) {
        int index = ran.nextInt(str.length());
        //获取字符
        char ch = str.charAt(index);//随机字符
        sb.append(ch);

        //2.3写验证码
        g.drawString(ch+"",width/5*i,height/2);
    }
    String checkCode_session = sb.toString();
    //将验证码存入session
    request.getSession().setAttribute("checkCode_session",checkCode_session);

    //2.4画干扰线
    g.setColor(Color.GREEN);

    //随机生成坐标点

    for (int i = 0; i &lt; 10; i++) {
        int x1 = ran.nextInt(width);
        int x2 = ran.nextInt(width);

        int y1 = ran.nextInt(height);
        int y2 = ran.nextInt(height);
        g.drawLine(x1,y1,x2,y2);
    }


    //3.将图片输出到页面展示
    ImageIO.write(image,"jpg",response.getOutputStream());


}

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    this.doPost(request,response);
} }
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3. 验证信息
```java
package xyz.slienceme.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

@WebServlet("/loginServlet")
public class LoginServlet extends HttpServlet {
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //1.设置request编码
        request.setCharacterEncoding("utf-8");
        //2.获取参数
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String checkCode = request.getParameter("checkCode");
        //3.先获取生成的验证码
        HttpSession session = request.getSession();
        String checkCode_session = (String) session.getAttribute("checkCode_session");
        //删除session中存储的验证码
        session.removeAttribute("checkCode_session");
        //3.先判断验证码是否正确
        if(checkCode_session!= null &amp;&amp; checkCode_session.equalsIgnoreCase(checkCode)){
            //忽略大小写比较
            //验证码正确
            //判断用户名和密码是否一致
            if("zhangsan".equals(username) &amp;&amp; "123".equals(password)){//需要调用UserDao查询数据库
                //登录成功
                //存储信息，用户信息
                session.setAttribute("user",username);
                //重定向到success.jsp
                response.sendRedirect(request.getContextPath()+"/success.jsp");
            }else{
                //登录失败
                //存储提示信息到request
                request.setAttribute("login_error","用户名或密码错误");
                //转发到登录页面
                request.getRequestDispatcher("/login.jsp").forward(request,response);
            }


        }else{
            //验证码不一致
            //存储提示信息到request
            request.setAttribute("cc_error","验证码错误");
            //转发到登录页面
            request.getRequestDispatcher("/login.jsp").forward(request,response);

        }

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        this.doPost(request, response);
    }
}

</code></pre></div></div> <ol> <li>成功访问 ```java &lt;%@ page contentType=”text/html;charset=UTF-8” language=”java” %&gt;</li> </ol> <html> <head> <title>Title</title> </head> <body> <h1>&lt;%=request.getSession().getAttribute("user")%&gt;,欢迎您</h1> </body> </html> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># -----------------------------------------------------------------------------
# 1. JSP
## 1.1 概念：
* `Java Server Pages`： java服务器端页面
	* 可以理解为：一个特殊的页面，其中既可以指定定义`html`标签，又可以定义`java`代码
	* 用于简化书写


## 1.2 原理
* `JSP`本质上就是一个`Servlet`
![Alt Text](/images/posts/202103211511175.png)

## 1.3 JSP的脚本：JSP定义Java代码的方式
1. `&lt;%  代码 %&gt;`：定义的`java`代码，在`service`方法中。`service`方法中可以定义什么，该脚本中就可以定义什么。
2. `&lt;%! 代码 %&gt;`：定义的`java`代码，在`jsp`转换后的`java`类的成员位置。
3. `&lt;%= 代码 %&gt;`：定义的`java`代码，会输出到页面上。输出语句中可以定义什么，该脚本中就可以定义什么。


## 1.4 JSP的内置对象：
* 在`jsp`页面中不需要获取和创建，可以直接使用的对象
* `jsp`一共有9个内置对象（其中三个）
	* `request`
	* `response`
	* `out`：字符输出流对象。可以将数据输出到页面上。和`response.getWriter()`类似
		* `response.getWriter()`和`out.write()`的区别：
			* 在`tomcat`服务器真正给客户端做出响应之前，会先找`response`缓冲区数据，再找`out`缓冲区数据。
			* `response.getWriter()`数据输出永远在`out.write()`之前
			
```java
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;$Title$&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
      &lt;%
        System.out.println("hello jsp");
        int i = 5;
        String contextPath = request.getContextPath();
        out.print(contextPath);
      %&gt;
      &lt;%!
        int i = 3;
      %&gt;
      &lt;%= "hello" %&gt;
      System.out.println("hello jsp");
      &lt;h1&gt;hi~ jsp!&lt;/h1&gt;
      &lt;% response.getWriter().write("response....."); %&gt;
  &lt;/body&gt;
&lt;/html&gt;

</code></pre></div></div> <h2 id="15-指令">1.5 指令</h2> <h3 id="151-作用">1.5.1 作用：</h3> <ul> <li>用于配置JSP页面，导入资源文件 <h3 id="152-格式">1.5.2 格式：</h3> </li> <li><code class="language-plaintext highlighter-rouge">&lt;%@ 指令名称 属性名1=属性值1 属性名2=属性值2 ... %&gt;</code> <h3 id="153-分类">1.5.3 分类：</h3> <h4 id="1-page-配置jsp页面的">1. <code class="language-plaintext highlighter-rouge">page</code>： 配置<code class="language-plaintext highlighter-rouge">JSP</code>页面的</h4> </li> <li><code class="language-plaintext highlighter-rouge">contentType</code>：等同于<code class="language-plaintext highlighter-rouge">response.setContentType()</code> <ol> <li>设置响应体的<code class="language-plaintext highlighter-rouge">mime</code>类型以及字符集</li> <li>设置当前<code class="language-plaintext highlighter-rouge">jsp</code>页面的编码（只能是高级的IDE才能生效，如果使用低级工具，则需要设置<code class="language-plaintext highlighter-rouge">pageEncoding</code>属性设置当前页面的字符集）</li> </ol> </li> <li><code class="language-plaintext highlighter-rouge">import</code>：导包</li> <li><code class="language-plaintext highlighter-rouge">errorPage</code>：当前页面发生异常后，会自动跳转到指定的错误页面</li> <li><code class="language-plaintext highlighter-rouge">isErrorPage</code>：标识当前也是是否是错误页面。 <ul> <li><code class="language-plaintext highlighter-rouge">true</code>：是，可以使用内置对象<code class="language-plaintext highlighter-rouge">exception</code></li> <li><code class="language-plaintext highlighter-rouge">false</code>：否。默认值。不可以使用内置对象<code class="language-plaintext highlighter-rouge">exception</code></li> </ul> </li> </ul> <h4 id="2-include--页面包含的导入页面的资源文件">2. <code class="language-plaintext highlighter-rouge">include</code> ： 页面包含的。导入页面的资源文件</h4> <ul> <li><code class="language-plaintext highlighter-rouge">&lt;%@include file="top.jsp"%&gt;</code> <h4 id="3-taglib--导入资源">3. <code class="language-plaintext highlighter-rouge">taglib</code> ： 导入资源</h4> </li> <li><code class="language-plaintext highlighter-rouge">&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;</code> <ul> <li><code class="language-plaintext highlighter-rouge">prefix</code>：前缀，自定义的</li> </ul> </li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">java.util.ArrayList</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="n">gbk</span><span class="s">" errorPage="</span><span class="mi">500</span><span class="o">.</span><span class="na">jsp</span><span class="s">" pageEncoding="</span><span class="no">GBK</span><span class="s">" language="</span><span class="n">java</span><span class="s">" buffer="</span><span class="mi">16</span><span class="n">kb</span><span class="s">" %&gt;
&lt;%@ taglib prefix="</span><span class="n">c</span><span class="s">" uri="</span><span class="nl">http:</span><span class="c1">//java.sun.com/jsp/jstl/core" %&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">$Title</span><span class="err">$</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;%</span>
    <span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">%&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <h2 id="16-注释">1.6 注释:</h2> <ol> <li>html注释： <code class="language-plaintext highlighter-rouge">&lt;!-- --&gt;</code>:只能注释html代码片段</li> <li>jsp注释：推荐使用 <code class="language-plaintext highlighter-rouge">&lt;%-- --%&gt;</code>：可以注释所有</li> </ol> <h2 id="17-内置对象">1.7 内置对象</h2> <ul> <li>在jsp页面中不需要创建，直接使用的对象</li> <li>一共有9个：</li> </ul> <table> <thead> <tr> <th>变量名</th> <th>真实类型</th> <th>作用</th> </tr> </thead> <tbody> <tr> <td>pageContext</td> <td>PageContext</td> <td>当前页面共享数据，还可以获取其他八个内置对象</td> </tr> <tr> <td>request</td> <td>HttpServletRequest</td> <td>一次请求访问的多个资源(转发)</td> </tr> <tr> <td>session</td> <td>HttpSession</td> <td>一次会话的多个请求间</td> </tr> <tr> <td>application</td> <td>ServletContext</td> <td>所有用户间共享数据</td> </tr> <tr> <td>response</td> <td>HttpServletResponse</td> <td>响应对象</td> </tr> <tr> <td>page</td> <td>Object</td> <td>当前页面(Servlet)的对象 this</td> </tr> <tr> <td>out</td> <td>JspWriter</td> <td>输出对象，数据输出到页面上</td> </tr> <tr> <td>config</td> <td>ServletConfig</td> <td>Servlet的配置对象</td> </tr> <tr> <td>exception</td> <td>Throwable</td> <td>异常对象</td> </tr> </tbody> </table> <h1 id="2-mvc开发模式">2. MVC：开发模式</h1> <h2 id="21-jsp演变历史">2.1. jsp演变历史</h2> <ol> <li>早期只有<code class="language-plaintext highlighter-rouge">servlet</code>，只能使用<code class="language-plaintext highlighter-rouge">response</code>输出标签数据，非常麻烦</li> <li>后来又<code class="language-plaintext highlighter-rouge">jsp</code>，简化了<code class="language-plaintext highlighter-rouge">Servlet</code>的开发，如果过度使用<code class="language-plaintext highlighter-rouge">jsp</code>，在<code class="language-plaintext highlighter-rouge">jsp</code>中即写大量的<code class="language-plaintext highlighter-rouge">java</code>代码，有写<code class="language-plaintext highlighter-rouge">html</code>表，造成难于维护，难于分工协作</li> <li>再后来，<code class="language-plaintext highlighter-rouge">java</code>的<code class="language-plaintext highlighter-rouge">web</code>开发，借鉴<code class="language-plaintext highlighter-rouge">mvc</code>开发模式，使得程序的设计更加合理性</li> </ol> <h2 id="22-mvc">2.2 MVC</h2> <ul> <li>（django利用了该模式 <a href="https://blog.csdn.net/Slience_me/article/details/109277480">网址</a>）： <img src="https://slienceme.cn/images/posts/20210323172811407.png" alt="Alt Text" /></li> </ul> <ol> <li>M：<code class="language-plaintext highlighter-rouge">Model</code>，模型。<code class="language-plaintext highlighter-rouge">JavaBean</code> <ul> <li>完成具体的业务操作，如：查询数据库，封装对象</li> </ul> </li> <li>V：<code class="language-plaintext highlighter-rouge">View</code>，视图。<code class="language-plaintext highlighter-rouge">JSP</code> <ul> <li>展示数据</li> </ul> </li> <li>C：<code class="language-plaintext highlighter-rouge">Controller</code>，控制器。<code class="language-plaintext highlighter-rouge">Servlet</code> <ul> <li>获取用户的输入</li> <li>调用模型</li> <li>将数据交给视图进行展示 - 优点： <ol> <li>耦合性低，方便维护，可以利于分工协作</li> <li>重用性高 <ul> <li>缺点：</li> </ul> </li> <li>使得项目架构变得复杂，对开发人员要求高</li> </ol> </li> </ul> </li> </ol> <h1 id="3-el表达式">3. EL表达式</h1> <h2 id="31-概念">3.1 概念：</h2> <ul> <li><code class="language-plaintext highlighter-rouge">Expression Language</code> 表达式语言 <h2 id="32-作用">3.2 作用：</h2> </li> <li>替换和简化<code class="language-plaintext highlighter-rouge">jsp</code>页面中<code class="language-plaintext highlighter-rouge">java</code>代码的编写 <h2 id="33-语法">3.3 语法：</h2> </li> <li><code class="language-plaintext highlighter-rouge">${表达式}</code> <h2 id="34-注意">3.4 注意：</h2> </li> <li><code class="language-plaintext highlighter-rouge">jsp</code>默认支持<code class="language-plaintext highlighter-rouge">el</code>表达式的。如果要忽略el表达式 <ol> <li>设置<code class="language-plaintext highlighter-rouge">jsp</code>中<code class="language-plaintext highlighter-rouge">page</code>指令中：<code class="language-plaintext highlighter-rouge">isELIgnored="true"</code> 忽略当前<code class="language-plaintext highlighter-rouge">jsp</code>页面中所有的<code class="language-plaintext highlighter-rouge">el</code>表达式</li> <li><code class="language-plaintext highlighter-rouge">\${表达式}</code> ：忽略当前这个<code class="language-plaintext highlighter-rouge">el</code>表达式</li> </ol> </li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">java.util.List</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">" language="</span><span class="n">java</span><span class="err">"</span>   <span class="o">%&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="nc">Title</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
    <span class="err">$</span><span class="o">{</span><span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">}</span>
    <span class="err">\$</span><span class="o">{</span><span class="mi">3</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">}</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <h2 id="35-使用">3.5 使用：</h2> <h3 id="351-运算">3.5.1 运算：</h3> <h4 id="1-运算符">1. 运算符：</h4> <ol> <li>算数运算符： <code class="language-plaintext highlighter-rouge">+ - * /(div) %(mod)</code></li> <li>比较运算符： <code class="language-plaintext highlighter-rouge">&gt; &lt; &gt;= &lt;= == !=</code></li> <li>逻辑运算符： <code class="language-plaintext highlighter-rouge">&amp;&amp;(and) ||(or) !(not)</code></li> <li>空运算符： <code class="language-plaintext highlighter-rouge">empty</code> <ul> <li>功能：用于判断字符串、集合、数组对象是否为<code class="language-plaintext highlighter-rouge">null</code>或者长度是否为<code class="language-plaintext highlighter-rouge">0</code></li> <li><code class="language-plaintext highlighter-rouge">${empty list}</code>:判断字符串、集合、数组对象是否为<code class="language-plaintext highlighter-rouge">null</code>或者长度为<code class="language-plaintext highlighter-rouge">0</code></li> <li><code class="language-plaintext highlighter-rouge">${not empty str}</code>:表示判断字符串、集合、数组对象是否不为<code class="language-plaintext highlighter-rouge">null</code> 并且 <code class="language-plaintext highlighter-rouge">长度&gt;0</code></li> </ul> </li> </ol> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">java.util.List</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">" language="</span><span class="n">java</span><span class="s">"   %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    ${3 &gt; 4}
    \${3 &gt; 4}
&lt;hr&gt;
    &lt;h3&gt;算数运算符&lt;/h3&gt;
    ${3 + 4}&lt;br&gt;
    ${3 / 4}&lt;br&gt;
    ${3 div 4}&lt;br&gt;
    ${3 % 4}&lt;br&gt;
    ${3 mod 4}&lt;br&gt;
    
    &lt;h3&gt;比较运算符&lt;/h3&gt;
    ${3 == 4}&lt;br&gt;

    &lt;h3&gt;逻辑运算符&lt;/h3&gt;
    ${3 &gt; 4  &amp;&amp; 3 &lt; 4}&lt;br&gt;
    ${3 &gt; 4  and 3 &lt; 4}&lt;br&gt;

    &lt;h4&gt;empty运算符&lt;/h4&gt;
&lt;%
    String str = "";
    request.setAttribute("</span><span class="n">str</span><span class="s">",str);

    List list = new ArrayList();
    request.setAttribute("</span><span class="n">list</span><span class="err">"</span><span class="o">,</span><span class="n">list</span><span class="o">);</span>
<span class="o">%&gt;</span>
    <span class="err">$</span><span class="o">{</span><span class="n">not</span> <span class="n">empty</span> <span class="n">str</span><span class="o">}</span>
    <span class="err">$</span><span class="o">{</span><span class="n">not</span> <span class="n">empty</span> <span class="n">list</span><span class="o">}</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <h4 id="2-获取值">2. 获取值</h4> <ol> <li><code class="language-plaintext highlighter-rouge">el</code>表达式只能从域对象中获取值</li> <li>语法： <ol> <li><code class="language-plaintext highlighter-rouge">${域名称.键名}</code>：从指定域中获取指定键的值 域名称： <ol> <li><code class="language-plaintext highlighter-rouge">pageScope</code> –&gt; <code class="language-plaintext highlighter-rouge">pageContext</code></li> <li><code class="language-plaintext highlighter-rouge">requestScope</code> –&gt; <code class="language-plaintext highlighter-rouge">request</code></li> <li><code class="language-plaintext highlighter-rouge">sessionScope</code> –&gt; <code class="language-plaintext highlighter-rouge">session</code></li> <li><code class="language-plaintext highlighter-rouge">applicationScope</code> –&gt; <code class="language-plaintext highlighter-rouge">application（ServletContext）</code> <ul> <li>举例：在<code class="language-plaintext highlighter-rouge">request</code>域中存储了<code class="language-plaintext highlighter-rouge">name=张三</code></li> <li>获取：<code class="language-plaintext highlighter-rouge">${requestScope.name}</code></li> </ul> </li> </ol> </li> <li><code class="language-plaintext highlighter-rouge">${键名}</code>：表示依次从最小的域中查找是否有该键对应的值，直到找到为止。 ```java &lt;%@ page import=”java.util.List” %&gt; &lt;%@ page import=”java.util.ArrayList” %&gt; &lt;%@ page contentType=”text/html;charset=UTF-8” language=”java” %&gt;</li> </ol> </li> </ol> <html> <head> <title>el获取域中的数据</title> </head> <body> &lt;% //在域中存储数据 session.setAttribute("name","李四"); request.setAttribute("name","张三"); session.setAttribute("age","23"); request.setAttribute("str",""); %&gt; <h3>el获取值</h3> ${requestScope.name} ${sessionScope.age} ${sessionScope.haha} ${name} ${sessionScope.name} </body> </html> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
3. 获取对象、`List`集合、`Map`集合的值
	1. 对象：`${域名称.键名.属性名}`
		 本质上会去调用对象的`getter`方法
	2. `List`集合：`${域名称.键名[索引]}`
	3. `Map`集合：
		* `${域名称.键名.key名称}`
		* `${域名称.键名["key名称"]}`
```java
package xyz.slienceme.domain;
import java.text.SimpleDateFormat;
import java.util.Date;

public class User {

    private String name;
    private int age;
    private Date birthday;

    public User(String name, int age, Date birthday) {
        this.name = name;
        this.age = age;
        this.birthday = birthday;
    }
    public User() {
    }

    /**
     * 逻辑视图
     * @return
     */
    public String getBirStr(){

        if(birthday != null){
            //1.格式化日期对象
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            //2.返回字符串即可
            return sdf.format(birthday);

        }else{
            return "";
        }
    }


    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public Date getBirthday() {
        return birthday;
    }

    public void setBirthday(Date birthday) {
        this.birthday = birthday;
    }
}

</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">xyz.slienceme.domain.User</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.*</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">" language="</span><span class="n">java</span><span class="s">" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;el获取数据&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;%
        User user = new User();
        user.setName("</span><span class="n">张三</span><span class="s">");
        user.setAge(23);
        user.setBirthday(new Date());


        request.setAttribute("</span><span class="n">u</span><span class="s">",user);


        List list = new ArrayList();
        list.add("</span><span class="n">aaa</span><span class="s">");
        list.add("</span><span class="n">bbb</span><span class="s">");
        list.add(user);

        request.setAttribute("</span><span class="n">list</span><span class="s">",list);


        Map map = new HashMap();
        map.put("</span><span class="n">sname</span><span class="s">","</span><span class="n">李四</span><span class="s">");
        map.put("</span><span class="n">gender</span><span class="s">","</span><span class="n">男</span><span class="s">");
        map.put("</span><span class="n">user</span><span class="s">",user);

        request.setAttribute("</span><span class="n">map</span><span class="s">",map);

    %&gt;

&lt;h3&gt;el获取对象中的值&lt;/h3&gt;
${requestScope.u}&lt;br&gt;

&lt;%--
    * 通过的是对象的属性来获取
        * setter或getter方法，去掉set或get，在将剩余部分，首字母变为小写。
        * setName --&gt; Name --&gt; name
--%&gt;

    ${requestScope.u.name}&lt;br&gt;
    ${u.age}&lt;br&gt;
    ${u.birthday}&lt;br&gt;
    ${u.birthday.month}&lt;br&gt;

    ${u.birStr}&lt;br&gt;

    &lt;h3&gt;el获取List值&lt;/h3&gt;
    ${list}&lt;br&gt;
    ${list[0]}&lt;br&gt;
    ${list[1]}&lt;br&gt;
    ${list[10]}&lt;br&gt;

    ${list[2].name}

    &lt;h3&gt;el获取Map值&lt;/h3&gt;
    ${map.gender}&lt;br&gt;
    ${map["</span><span class="n">gender</span><span class="err">"</span><span class="o">]}&lt;</span><span class="n">br</span><span class="o">&gt;</span>
    <span class="err">$</span><span class="o">{</span><span class="n">map</span><span class="o">.</span><span class="na">user</span><span class="o">.</span><span class="na">name</span><span class="o">}</span>

<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>

</code></pre></div></div> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="n">contentType</span><span class="o">=</span><span class="s">"text/html;charset=UTF-8"</span> <span class="n">language</span><span class="o">=</span><span class="s">"java"</span> <span class="o">%&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">el隐式对象</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>

    <span class="err">$</span><span class="o">{</span><span class="n">pageContext</span><span class="o">.</span><span class="na">request</span><span class="o">}&lt;</span><span class="n">br</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">h4</span><span class="o">&gt;</span><span class="n">在jsp页面动态获取虚拟目录</span><span class="o">&lt;/</span><span class="n">h4</span><span class="o">&gt;</span>
    <span class="err">$</span><span class="o">{</span><span class="n">pageContext</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">contextPath</span><span class="o">}</span>
<span class="o">&lt;%</span>
<span class="o">%&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <p><img src="https://slienceme.cn/images/posts/2021032318195842.png" alt="Alt Text" /></p> <h4 id="3-隐式对象">3. 隐式对象：</h4> <ul> <li><code class="language-plaintext highlighter-rouge">el</code>表达式中有11个隐式对象</li> <li><code class="language-plaintext highlighter-rouge">pageContext</code>： <ul> <li>获取<code class="language-plaintext highlighter-rouge">jsp</code>其他八个内置对象 <ul> <li><code class="language-plaintext highlighter-rouge">${pageContext.request.contextPath}</code>：动态获取虚拟目录</li> </ul> </li> </ul> </li> </ul> <h1 id="4-jstl">4. JSTL</h1> <h2 id="41-概念">4.1 概念：</h2> <ul> <li><code class="language-plaintext highlighter-rouge">JavaServer Pages Tag Library</code> JSP标准标签库 <ul> <li>是由Apache组织提供的开源的免费的jsp标签<标签></标签></li> </ul> </li> </ul> <h2 id="42-作用">4.2 作用：</h2> <ul> <li>用于简化和替换jsp页面上的java代码</li> </ul> <h2 id="43-使用步骤">4.3 使用步骤：</h2> <ol> <li>导入<code class="language-plaintext highlighter-rouge">jstl</code>相关<code class="language-plaintext highlighter-rouge">jar</code>包</li> <li>引入标签库：<code class="language-plaintext highlighter-rouge">taglib</code>指令： <code class="language-plaintext highlighter-rouge">&lt;%@ taglib %&gt;</code></li> <li>使用标签</li> </ol> <h2 id="44-常用的jstl标签">4.4 常用的JSTL标签</h2> <ol> <li><code class="language-plaintext highlighter-rouge">if</code>:相当于java代码的if语句 ```java &lt;%@ page import=”java.util.List” %&gt; &lt;%@ page import=”java.util.ArrayList” %&gt; &lt;%@ page contentType=”text/html;charset=UTF-8” language=”java” %&gt; &lt;%@ taglib prefix=”c” uri=”http://java.sun.com/jsp/jstl/core” %&gt;</li> </ol> <html> <head> <title>if标签</title> </head> <body> &lt;%-- c:if标签 1. 属性： * test 必须属性，接受boolean表达式 * 如果表达式为true，则显示if标签体内容，如果为false，则不显示标签体内容 * 一般情况下，test属性值会结合el表达式一起使用 2. 注意：c:if标签没有else情况，想要else情况，则可以在定义一个c:if标签 --%&gt; <c:if test="true"> <h1>我是真...</h1> </c:if> <br /> &lt;% //判断request域中的一个list集合是否为空，如果不为null则显示遍历集合 List list = new ArrayList(); list.add("aaaa"); request.setAttribute("list",list); request.setAttribute("number",4); %&gt; <c:if test="${not empty list}"> 遍历集合... </c:if> <br /> <c:if test="${number % 2 != 0}"> ${number}为奇数 </c:if> <c:if test="${number % 2 == 0}"> ${number}为偶数 </c:if> </body> </html> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>![Alt Text](/images/posts/2021032318523720.png)

 
2. `choose`:相当于`java`代码的`switch`语句

```java
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;choose标签&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;%--
        完成数字编号对应星期几案例
            1.域中存储一数字
            2.使用choose标签取出数字         相当于switch声明
            3.使用when标签做数字判断         相当于case
            4.otherwise标签做其他情况的声明  相当于default
    --%&gt;
    &lt;%
        request.setAttribute("number",51);
    %&gt;
    &lt;c:choose&gt;
        &lt;c:when test="${number == 1}"&gt;星期一&lt;/c:when&gt;
        &lt;c:when test="${number == 2}"&gt;星期二&lt;/c:when&gt;
        &lt;c:when test="${number == 3}"&gt;星期三&lt;/c:when&gt;
        &lt;c:when test="${number == 4}"&gt;星期四&lt;/c:when&gt;
        &lt;c:when test="${number == 5}"&gt;星期五&lt;/c:when&gt;
        &lt;c:when test="${number == 6}"&gt;星期六&lt;/c:when&gt;
        &lt;c:when test="${number == 7}"&gt;星期天&lt;/c:when&gt;
        &lt;c:otherwise&gt;数字输入有误&lt;/c:otherwise&gt;
    &lt;/c:choose&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div> <ol> <li><code class="language-plaintext highlighter-rouge">foreach</code>:相当于<code class="language-plaintext highlighter-rouge">java</code>代码的<code class="language-plaintext highlighter-rouge">for</code>语句</li> </ol> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">java.util.ArrayList</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">" language="</span><span class="n">java</span><span class="s">" %&gt;
&lt;%@taglib prefix="</span><span class="n">c</span><span class="s">" uri="</span><span class="nl">http:</span><span class="c1">//java.sun.com/jsp/jstl/core" %&gt;</span>
<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">foreach标签</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>

<span class="o">&lt;%--</span>
    <span class="nl">foreach:</span><span class="n">相当于java代码的for语句</span>
        <span class="mi">1</span><span class="o">.</span> <span class="n">完成重复的操作</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span> <span class="o">++){</span>

            <span class="o">}</span>
            <span class="o">*</span> <span class="n">属性</span><span class="err">：</span>
                <span class="n">begin</span><span class="err">：</span><span class="n">开始值</span>
                <span class="n">end</span><span class="err">：</span><span class="n">结束值</span>
                <span class="kt">var</span><span class="err">：</span><span class="n">临时变量</span>
                <span class="n">step</span><span class="err">：</span><span class="n">步长</span>
                <span class="nl">varStatus:</span><span class="n">循环状态对象</span>
                    <span class="nl">index:</span><span class="n">容器中元素的索引</span><span class="err">，</span><span class="n">从0开始</span>
                    <span class="nl">count:</span><span class="n">循环次数</span><span class="err">，</span><span class="n">从1开始</span>
        <span class="mi">2</span><span class="o">.</span> <span class="n">遍历容器</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
            <span class="k">for</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span> <span class="o">:</span> <span class="n">list</span><span class="o">){</span>
            <span class="o">}</span>
            <span class="o">*</span> <span class="n">属性</span><span class="err">：</span>
                <span class="nl">items:</span><span class="n">容器对象</span>
                <span class="kt">var</span><span class="o">:</span><span class="n">容器中元素的临时变量</span>
                <span class="nl">varStatus:</span><span class="n">循环状态对象</span>
                    <span class="nl">index:</span><span class="n">容器中元素的索引</span><span class="err">，</span><span class="n">从0开始</span>
                    <span class="nl">count:</span><span class="n">循环次数</span><span class="err">，</span><span class="n">从1开始</span>


<span class="o">--%&gt;</span>
<span class="o">&lt;</span><span class="nl">c:</span><span class="n">forEach</span> <span class="n">begin</span><span class="o">=</span><span class="s">"1"</span> <span class="n">end</span><span class="o">=</span><span class="s">"10"</span> <span class="kt">var</span><span class="o">=</span><span class="s">"i"</span> <span class="n">step</span><span class="o">=</span><span class="s">"2"</span> <span class="n">varStatus</span><span class="o">=</span><span class="s">"s"</span><span class="o">&gt;</span>
    <span class="err">$</span><span class="o">{</span><span class="n">i</span><span class="o">}</span> <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">index</span><span class="o">}&lt;</span><span class="n">h3</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">h4</span><span class="o">&gt;</span> <span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">count</span><span class="o">}</span> <span class="o">&lt;/</span><span class="n">h4</span><span class="o">&gt;&lt;</span><span class="n">br</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="nl">c:</span><span class="n">forEach</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">hr</span><span class="o">&gt;</span>
    <span class="o">&lt;%</span>
        <span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"aaa"</span><span class="o">);</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"bbb"</span><span class="o">);</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"ccc"</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"list"</span><span class="o">,</span><span class="n">list</span><span class="o">);</span>
    <span class="o">%&gt;</span>
    <span class="o">&lt;</span><span class="nl">c:</span><span class="n">forEach</span> <span class="n">items</span><span class="o">=</span><span class="s">"${list}"</span> <span class="kt">var</span><span class="o">=</span><span class="s">"str"</span> <span class="n">varStatus</span><span class="o">=</span><span class="s">"s"</span><span class="o">&gt;</span>
            <span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">index</span><span class="o">}</span> <span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">count</span><span class="o">}</span> <span class="err">$</span><span class="o">{</span><span class="n">str</span><span class="o">}&lt;</span><span class="n">br</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nl">c:</span><span class="n">forEach</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <h2 id="45-练习">4.5 练习：</h2> <ul> <li>需求：在request域中有一个存有User对象的List集合。需要使用jstl+el将list集合数据展示到jsp页面的表格table中</li> </ul> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">page</span> <span class="kn">import</span><span class="err">="</span><span class="nn">xyz.slienceme.domain.User</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">List</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">ArrayList</span><span class="s">" %&gt;
&lt;%@ page import="</span><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Date</span><span class="s">" %&gt;
&lt;%@ page contentType="</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="o">;</span><span class="n">charset</span><span class="o">=</span><span class="no">UTF</span><span class="o">-</span><span class="mi">8</span><span class="s">" language="</span><span class="n">java</span><span class="s">" %&gt;
&lt;%@taglib prefix="</span><span class="n">c</span><span class="s">" uri="</span><span class="nl">http:</span><span class="c1">//java.sun.com/jsp/jstl/core" %&gt;</span>

<span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">test</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;%</span>
    <span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">();</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"张三"</span><span class="o">,</span><span class="mi">23</span><span class="o">,</span><span class="k">new</span> <span class="nc">Date</span><span class="o">()));</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"李四"</span><span class="o">,</span><span class="mi">24</span><span class="o">,</span><span class="k">new</span> <span class="nc">Date</span><span class="o">()));</span>
    <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"王五"</span><span class="o">,</span><span class="mi">25</span><span class="o">,</span><span class="k">new</span> <span class="nc">Date</span><span class="o">()));</span>
    <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"list"</span><span class="o">,</span><span class="n">list</span><span class="o">);</span>
<span class="o">%&gt;</span>
<span class="o">&lt;</span><span class="n">table</span> <span class="n">border</span><span class="o">=</span><span class="s">"1"</span> <span class="n">width</span><span class="o">=</span><span class="s">"500"</span> <span class="n">align</span><span class="o">=</span><span class="s">"center"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">编号</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">姓名</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">年龄</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">th</span><span class="o">&gt;</span><span class="n">生日</span><span class="o">&lt;/</span><span class="n">th</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
    <span class="o">&lt;%--</span><span class="n">数据行</span><span class="o">--%&gt;</span>
    <span class="o">&lt;</span><span class="nl">c:</span><span class="n">forEach</span> <span class="n">items</span><span class="o">=</span><span class="s">"${list}"</span> <span class="kt">var</span><span class="o">=</span><span class="s">"user"</span> <span class="n">varStatus</span><span class="o">=</span><span class="s">"s"</span><span class="o">&gt;</span>

        <span class="o">&lt;</span><span class="nl">c:</span><span class="k">if</span> <span class="n">test</span><span class="o">=</span><span class="s">"${s.count % 2 != 0}"</span><span class="o">&gt;</span>

            <span class="o">&lt;</span><span class="n">tr</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s">"red"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">count</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">name</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">age</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">birStr</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nl">c:</span><span class="k">if</span><span class="o">&gt;</span>

        <span class="o">&lt;</span><span class="nl">c:</span><span class="k">if</span> <span class="n">test</span><span class="o">=</span><span class="s">"${s.count % 2 == 0}"</span><span class="o">&gt;</span>

            <span class="o">&lt;</span><span class="n">tr</span>  <span class="n">bgcolor</span><span class="o">=</span><span class="s">"green"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">s</span><span class="o">.</span><span class="na">count</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">name</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">age</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">$</span><span class="o">{</span><span class="n">user</span><span class="o">.</span><span class="na">birStr</span><span class="o">}&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nl">c:</span><span class="k">if</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nl">c:</span><span class="n">forEach</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</code></pre></div></div> <p><img src="https://slienceme.cn/images/posts/20210323185808823.png" alt="Alt Text" /></p> <h1 id="5--三层架构软件设计架构">5. 三层架构：软件设计架构</h1> <ol> <li>界面层(表示层)：用户看的得界面。用户可以通过界面上的组件和服务器进行交互</li> <li>业务逻辑层：处理业务逻辑的。</li> <li>数据访问层：操作数据存储文件。</li> </ol> <h1 id="案例用户信息列表展示">案例：用户信息列表展示</h1> <h2 id="1-需求用户信息的增删改查操作">1. 需求：用户信息的增删改查操作</h2> <h2 id="2-设计">2. 设计：</h2> <ol> <li>技术选型：<code class="language-plaintext highlighter-rouge">Servlet+JSP+MySQL+JDBCTempleat+Duird+BeanUtilS+tomcat</code></li> <li>数据库设计：</li> </ol> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">create</span> <span class="k">database</span> <span class="n">day17</span><span class="p">;</span> <span class="c1">-- 创建数据库</span>
		<span class="n">use</span> <span class="n">day17</span><span class="p">;</span> 			   <span class="c1">-- 使用数据库</span>
		<span class="k">create</span> <span class="k">table</span> <span class="k">user</span><span class="p">(</span>   <span class="c1">-- 创建表</span>
			<span class="n">id</span> <span class="nb">int</span> <span class="k">primary</span> <span class="k">key</span> <span class="n">auto_increment</span><span class="p">,</span>
			<span class="n">name</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
			<span class="n">gender</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
			<span class="n">age</span> <span class="nb">int</span><span class="p">,</span>
			<span class="n">address</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
			<span class="n">qq</span>	<span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
			<span class="n">email</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
		<span class="p">);</span>
</code></pre></div></div> <h2 id="3-开发">3. 开发：</h2> <ol> <li>环境搭建 <ol> <li>创建数据库环境</li> <li>创建项目，导入需要的jar包</li> </ol> </li> <li>编码 <h2 id="4-测试">4. 测试</h2> <h2 id="5-部署运维">5. 部署运维</h2> </li> </ol> <div style="margin-top:2em;padding:0 1.5em;border:1px solid #d3d3d3;background-color:#deebf7"> <h3>文档信息</h3> <ul> <li>本文作者：<a href="https://slienceme.cn" target="_blank">slience_me</a></li> <li>本文链接：<a href="https://slienceme.cn/2021/02/24/Response_Cookie&Session_JSP&EL&JSTL/" target="_blank">https://slienceme.cn/2021/02/24/Response_Cookie&Session_JSP&EL&JSTL/</a></li> <li>版权声明：自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">创意共享3.0许可证</a>）</li> </ul> </div> </article> <div class="share"> <div class="share-component" data-disabled='qq,facebook'></div> </div> <div class="comment"> <script src="https://giscus.app/client.js" data-repo="slience-me/blog-comments" data-repo-id="MDEwOlJlcG9zaXRvcnk5MzEyNzkxNw==" data-category="Announcements" data-category-id="DIC_kwDOBY0E7c4CRtg9" data-mapping="title" data-strict="1" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async> </script> </div> </div> <div class="column one-fourth"> <h3>Search</h3> <div id="site_search"> <input style="width:96%" type="text" id="search_box" placeholder="Search"> </div> <ul id="search_results" style="font-size:14px;list-style-type:none;padding-top:10px;padding-left:10px;"></ul> <script src="https://slienceme.cn/assets/js/simple-jekyll-search.min.js"></script> <script type="text/javascript"> SimpleJekyllSearch({ searchInput: document.getElementById('search_box'), resultsContainer: document.getElementById('search_results'), json: 'https://slienceme.cn/assets/search_data.json?v=1736474769', searchResultTemplate: '<li><a href="{url}" title="{title}">{title}</a></li>', noResultsText: 'No results found', limit: 10, fuzzy: false, exclude: ['Welcome'] }) </script> <h3 class="post-directory-title mobile-hidden">Table of Contents</h3> <div id="post-directory-module" class="mobile-hidden"> <section class="post-directory"> <dl></dl> </section> </div> <script src="https://slienceme.cn/assets/js/jquery.toc.js"></script> </div> </div> </section> <footer class="container"> <div class="site-footer" role="contentinfo"> <div class="copyright left mobile-block"> Copyright@ 2019-2025 slience_me 版权所有&emsp; <img src="/images/logo/logo.png" class="w-full" style="width: 12px;"> <a href="https://beian.mps.gov.cn/#/query/webSearch?code=13102202000626" rel="noreferrer" target="_blank">冀公网安备13102202000626</a>&emsp; <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank" rel="noreferrer">津ICP备2024026565号-1</a> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a> </div> <ul class="site-footer-links right mobile-hidden"> <li> <a href="javascript:window.scrollTo(0,0)" >TOP</a> </li> </ul> <br/> <script async src="https://slienceme.cn/assets/vendor/busuanzi/2.3/busuanzi.pure.mini.js"></script> <div class="mobile-hidden" style="margin-top:8px"> <span id="busuanzi_container_site_pv" style="display:none"> 本站访问量<span id="busuanzi_value_site_pv"></span>次 </span> <span id="busuanzi_container_site_uv" style="display:none"> / 本站访客数<span id="busuanzi_value_site_uv"></span>人 </span> <span id="busuanzi_container_page_pv" style="display:none"> / 本页访问量<span id="busuanzi_value_page_pv"></span>次 / 统计始于2024-12-01 </span> </div> </div> </footer> <div class="tools-wrapper"> <a class="gotop" href="#" title="回到顶部"><span class="octicon octicon-arrow-up"></span></a> </div> <script src="https://slienceme.cn/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="https://slienceme.cn/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script> </body> </html>
